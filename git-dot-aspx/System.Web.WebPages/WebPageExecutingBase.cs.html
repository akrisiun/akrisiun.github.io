<!DOCTYPE html>
<html><head><title>WebPageExecutingBase.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(365);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Web.WebPages/WebPageExecutingBase.cs" target="_top">WebPageExecutingBase.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Web.WebPages" target="_top">..\Mvc\src\System.Web.WebPages\System.Web.WebPages.csproj</a> (System.Web.WebPages)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>.<span class="i n">CodeAnalysis</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Globalization</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">WebPages</span>.<span class="i n">Instrumentation</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">WebPages</span>.<span class="i n">Resources</span>;
 
<span class="c">/*
WebPage class hierarchy
 
WebPageExecutingBase                        The base class for all Plan9 files (_pagestart, _appstart, and regular pages)
    ApplicationStartPage                    Used for _appstart.cshtml
    WebPageRenderingBase
        StartPage                           Used for _pagestart.cshtml
        WebPageBase
            WebPage                         Plan9Pages
            ViewWebPage?                    MVC Views
HelperPage                                  Base class for Web Pages in App_Code.
*/</span>
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">WebPages</span>
{
    <span class="c">// The base class for all CSHTML files (_pagestart, _appstart, and regular pages)</span>
    <b>public abstract class</b> <a id="a8368eb79a7751ac" href="R/a8368eb79a7751ac.html" target="n" data-glyph="0,0" class="t t"><span id="c648129a67f51f0f">WebPageExecutingBase</span></a>
    {
        <b>private</b> <a href="IVirtualPathFactory.cs.html#014d8a8e8c100ef2" class="t t">IVirtualPathFactory</a> <a id="7dfaf4a984990d58" href="R/7dfaf4a984990d58.html" target="n" data-glyph="46,1" class="i field">_virtualPathFactory</a>;
        <b>private</b> <a href="DynamicHttpApplicationState.cs.html#af9c805ee7a16e64" class="t t">DynamicHttpApplicationState</a> <a id="ead6dafd2f5a8113" href="R/ead6dafd2f5a8113.html" target="n" data-glyph="46,1" class="i field">_dynamicAppState</a>;
        <b>private</b> <a href="Instrumentation/InstrumentationService.cs.html#422bd50b6975f626" class="t t">InstrumentationService</a> <a id="c34918ca82bd50de" href="R/c34918ca82bd50de.html" target="n" data-glyph="46,1" class="i field">_instrumentationService</a> = <b>null</b>;
 
        <b>internal</b> <a href="Instrumentation/InstrumentationService.cs.html#422bd50b6975f626" class="t t">InstrumentationService</a> <a id="fa4b95f4a770f727" href="R/fa4b95f4a770f727.html" target="n" data-glyph="104,1" class="i property">InstrumentationService</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#c34918ca82bd50de" class="i field">_instrumentationService</a> == <b>null</b>)
                {
                    <a href="#c34918ca82bd50de" class="i field">_instrumentationService</a> = <b>new</b> <a href="Instrumentation/InstrumentationService.cs.html#77b749621bdca0d2" class="t constructor">InstrumentationService</a>();
                }
                <b>return</b> <a href="#c34918ca82bd50de" class="i field">_instrumentationService</a>;
            }
            <b>set</b> { <a href="#c34918ca82bd50de" class="i field">_instrumentationService</a> = <b>value</b>; }
        }
 
        <b>public virtual</b> <a href="@0@System.Web/A.html#dac65105a9ea9bc9" class="t t">HttpApplicationStateBase</a> <a id="44566938aad1b079" href="R/44566938aad1b079.html" target="n" data-glyph="102,1" class="i property">AppState</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#c5774156c3b90682" class="i property">Context</a> != <b>null</b>)
                {
                    <b>return</b> <a href="#c5774156c3b90682" class="i property">Context</a>.<a href="@0@System.Web/A.html#ea9f90c58d22004a" class="i property">Application</a>;
                }
                <b>return null</b>;
            }
        }
 
        <b>public virtual dynamic</b> <a id="721229a902f8d6a3" href="R/721229a902f8d6a3.html" target="n" data-glyph="102,1" class="i property">App</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#ead6dafd2f5a8113" class="i field">_dynamicAppState</a> == <b>null</b> &amp;&amp; <a href="#44566938aad1b079" class="i property">AppState</a> != <b>null</b>)
                {
                    <a href="#ead6dafd2f5a8113" class="i field">_dynamicAppState</a> = <b>new</b> <a href="DynamicHttpApplicationState.cs.html#c1def700ab58cc5d" class="t constructor">DynamicHttpApplicationState</a>(<a href="#44566938aad1b079" class="i property">AppState</a>);
                }
                <b>return</b> <a href="#ead6dafd2f5a8113" class="i field">_dynamicAppState</a>;
            }
        }
 
        <b>public virtual</b> <a href="@0@System.Web/A.html#91a04cddc33c5bea" class="t t">HttpContextBase</a> <a id="c5774156c3b90682" href="R/c5774156c3b90682.html" target="n" data-glyph="102,1" class="i property">Context</a> { <b>get</b>; <b>set</b>; }
 
        <b>public virtual string</b> <a id="8ac9f97f3cdb7eb5" href="R/8ac9f97f3cdb7eb5.html" target="n" data-glyph="102,1" class="i property">VirtualPath</a> { <b>get</b>; <b>set</b>; }
 
        [<a href="@0@System/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@0@System/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@0@System/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public virtual</b> <a href="IVirtualPathFactory.cs.html#014d8a8e8c100ef2" class="t t">IVirtualPathFactory</a> <a id="9ba223bacba7d646" href="R/9ba223bacba7d646.html" target="n" data-glyph="102,1" class="i property">VirtualPathFactory</a>
        {
            <b>get</b> { <b>return</b> <a href="#7dfaf4a984990d58" class="i field">_virtualPathFactory</a> ?? <a href="VirtualPathFactoryManager.cs.html#6ed45b64632dabbc" class="t t">VirtualPathFactoryManager</a>.<a href="VirtualPathFactoryManager.cs.html#27ecdb7e0dd6f9ea" class="i property">Instance</a>; }
            <b>set</b> { <a href="#7dfaf4a984990d58" class="i field">_virtualPathFactory</a> = <b>value</b>; }
        }
 
        [<a href="@0@System/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@0@System/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@0@System/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public virtual void</b> <a id="3718fea45de51960" href="R/3718fea45de51960.html" target="n" data-glyph="72,1" class="i method">Execute</a>()
        {
            <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3f64c7634faf1768" class="t constructor">NotImplementedException</a>(<a href="Resources/WebPageResources.Designer.cs.html#3048a2a8244ffbb2" class="t t">WebPageResources</a>.<a href="Resources/WebPageResources.Designer.cs.html#24a70b303fc00eda" class="i property">NoSynchronousWebPageImplementationAvailable</a>);
        }
 
        [<a href="@0@System/A.html#ab67c52c634f618d" class="t constructor">EditorBrowsable</a>(<a href="@0@System/A.html#1a60f7b04af02e88" class="t t">EditorBrowsableState</a>.<a href="@0@System/A.html#043ce0a55050bfc5" class="i field">Never</a>)]
        <b>public virtual</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="c4f247a667301bb5" href="R/c4f247a667301bb5.html" target="n" data-glyph="72,1" class="i method">ExecuteAsync</a>()
        {
            <b>return null</b>;
        }
 
        <b>public virtual string</b> <a id="4238d713db06de82" href="R/4238d713db06de82.html" target="n" data-glyph="72,1" class="i method">Href</a>(<b>string</b> <span id="r0 rd" class="r0 r">path</span>, <b>params object</b>[] <span id="r1 rd" class="r1 r">pathParts</span>)
        {
            <b>return</b> <a href="Utils/UrlUtil.cs.html#9c2d8edcca24a312" class="t t">UrlUtil</a>.<a href="Utils/UrlUtil.cs.html#298ec71a65d9ba6e" class="i method">GenerateClientUrl</a>(<a href="#c5774156c3b90682" class="i property">Context</a>, <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r0 r">path</span>, <span class="r1 r">pathParts</span>);
        }
 
        <b>protected internal void</b> <a id="27cc6895cdef8eb4" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">BeginContext</a>(<b>int</b> <span id="r2 rd" class="r2 r">startPosition</span>, <b>int</b> <span id="r3 rd" class="r3 r">length</span>, <b>bool</b> <span id="r4 rd" class="r4 r">isLiteral</span>)
        {
            <a href="#903bb8d203817628" class="i method">BeginContext</a>(<a href="#3a630c81e365f632" class="i method">GetOutputWriter</a>(), <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r2 r">startPosition</span>, <span class="r3 r">length</span>, <span class="r4 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="8c590b70690d29e2" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">BeginContext</a>(<b>string</b> <span id="r5 rd" class="r5 r">virtualPath</span>, <b>int</b> <span id="r6 rd" class="r6 r">startPosition</span>, <b>int</b> <span id="r7 rd" class="r7 r">length</span>, <b>bool</b> <span id="r8 rd" class="r8 r">isLiteral</span>)
        {
            <a href="#903bb8d203817628" class="i method">BeginContext</a>(<a href="#3a630c81e365f632" class="i method">GetOutputWriter</a>(), <span class="r5 r">virtualPath</span>, <span class="r6 r">startPosition</span>, <span class="r7 r">length</span>, <span class="r8 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="a9a589d803fc1746" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">BeginContext</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r9 rd" class="r9 r">writer</span>, <b>int</b> <span id="r10 rd" class="r10 r">startPosition</span>, <b>int</b> <span id="r11 rd" class="r11 r">length</span>, <b>bool</b> <span id="r12 rd" class="r12 r">isLiteral</span>)
        {
            <a href="#903bb8d203817628" class="i method">BeginContext</a>(<span class="r9 r">writer</span>, <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r10 r">startPosition</span>, <span class="r11 r">length</span>, <span class="r12 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="903bb8d203817628" href="R/903bb8d203817628.html" target="n" data-glyph="75,1" class="i method">BeginContext</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r13 rd" class="r13 r">writer</span>, <b>string</b> <span id="r14 rd" class="r14 r">virtualPath</span>, <b>int</b> <span id="r15 rd" class="r15 r">startPosition</span>, <b>int</b> <span id="r16 rd" class="r16 r">length</span>, <b>bool</b> <span id="r17 rd" class="r17 r">isLiteral</span>)
        {
            <span class="c">// Double check that the instrumentation service is active because WriteAttribute always calls this</span>
            <b>if</b> (<a href="#fa4b95f4a770f727" class="i property">InstrumentationService</a>.<a href="Instrumentation/InstrumentationService.cs.html#d57c1b081b78a6b8" class="i property">IsAvailable</a>)
            {
                <a href="#fa4b95f4a770f727" class="i property">InstrumentationService</a>.<a href="Instrumentation/InstrumentationService.cs.html#9a7687a14bbbb89e" class="i method">BeginContext</a>(<a href="#c5774156c3b90682" class="i property">Context</a>,
                                                    <span class="r14 r">virtualPath</span>,
                                                    <span class="r13 r">writer</span>,
                                                    <span class="r15 r">startPosition</span>,
                                                    <span class="r16 r">length</span>,
                                                    <span class="r17 r">isLiteral</span>);
            }
        }
 
        <b>protected internal void</b> <a id="a7a6a49cc7a3b418" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">EndContext</a>(<b>int</b> <span id="r18 rd" class="r18 r">startPosition</span>, <b>int</b> <span id="r19 rd" class="r19 r">length</span>, <b>bool</b> <span id="r20 rd" class="r20 r">isLiteral</span>)
        {
            <a href="#3ab45f83458e06e4" class="i method">EndContext</a>(<a href="#3a630c81e365f632" class="i method">GetOutputWriter</a>(), <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r18 r">startPosition</span>, <span class="r19 r">length</span>, <span class="r20 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="e73025ddadeb9b5a" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">EndContext</a>(<b>string</b> <span id="r21 rd" class="r21 r">virtualPath</span>, <b>int</b> <span id="r22 rd" class="r22 r">startPosition</span>, <b>int</b> <span id="r23 rd" class="r23 r">length</span>, <b>bool</b> <span id="r24 rd" class="r24 r">isLiteral</span>)
        {
            <a href="#3ab45f83458e06e4" class="i method">EndContext</a>(<a href="#3a630c81e365f632" class="i method">GetOutputWriter</a>(), <span class="r21 r">virtualPath</span>, <span class="r22 r">startPosition</span>, <span class="r23 r">length</span>, <span class="r24 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="2cd381efefecf28d" href="R/../../0000000000.html" target="n" data-glyph="75,1" class="i method">EndContext</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r25 rd" class="r25 r">writer</span>, <b>int</b> <span id="r26 rd" class="r26 r">startPosition</span>, <b>int</b> <span id="r27 rd" class="r27 r">length</span>, <b>bool</b> <span id="r28 rd" class="r28 r">isLiteral</span>)
        {
            <a href="#3ab45f83458e06e4" class="i method">EndContext</a>(<span class="r25 r">writer</span>, <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r26 r">startPosition</span>, <span class="r27 r">length</span>, <span class="r28 r">isLiteral</span>);
        }
 
        <b>protected internal void</b> <a id="3ab45f83458e06e4" href="R/3ab45f83458e06e4.html" target="n" data-glyph="75,1" class="i method">EndContext</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r29 rd" class="r29 r">writer</span>, <b>string</b> <span id="r30 rd" class="r30 r">virtualPath</span>, <b>int</b> <span id="r31 rd" class="r31 r">startPosition</span>, <b>int</b> <span id="r32 rd" class="r32 r">length</span>, <b>bool</b> <span id="r33 rd" class="r33 r">isLiteral</span>)
        {
            <span class="c">// Double check that the instrumentation service is active because WriteAttribute always calls this</span>
            <b>if</b> (<a href="#fa4b95f4a770f727" class="i property">InstrumentationService</a>.<a href="Instrumentation/InstrumentationService.cs.html#d57c1b081b78a6b8" class="i property">IsAvailable</a>)
            {
                <a href="#fa4b95f4a770f727" class="i property">InstrumentationService</a>.<a href="Instrumentation/InstrumentationService.cs.html#ecebdb0848f3311f" class="i method">EndContext</a>(<a href="#c5774156c3b90682" class="i property">Context</a>,
                                                  <span class="r30 r">virtualPath</span>,
                                                  <span class="r29 r">writer</span>,
                                                  <span class="r31 r">startPosition</span>,
                                                  <span class="r32 r">length</span>,
                                                  <span class="r33 r">isLiteral</span>);
            }
        }
 
        <b>internal virtual string</b> <a id="b41ec04c5cc250ea" href="R/b41ec04c5cc250ea.html" target="n" data-glyph="74,1" class="i method">GetDirectory</a>(<b>string</b> <span id="r34 rd" class="r34 r">virtualPath</span>)
        {
            <b>return</b> <a href="@0@System.Web/A.html#2b829f9059f552ca" class="t t">VirtualPathUtility</a>.<a href="@0@System.Web/A.html#bcf782c616abba95" class="i method">GetDirectory</a>(<span class="r34 r">virtualPath</span>);
        }
 
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
        <span class="c">///</span><span class="c"> Normalizes path relative to the current virtual path and throws if a file does not exist at the location.</span>
        <span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
        <b>protected internal virtual string</b> <a id="3c3f1bc3639c2b1f" href="R/3c3f1bc3639c2b1f.html" target="n" data-glyph="75,1" class="i method">NormalizeLayoutPagePath</a>(<b>string</b> <span id="r35 rd" class="r35 r">layoutPagePath</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r36 rd" class="r36 r">virtualPath</span> = <a href="#7bfc0fe98d1aedef" class="i method">NormalizePath</a>(<span class="r35 r">layoutPagePath</span>);
            <span class="c">// Look for it as specified, either absolute, relative or same folder</span>
            <b>if</b> (<a href="#9ba223bacba7d646" class="i property">VirtualPathFactory</a>.<a href="IVirtualPathFactory.cs.html#ef46adde904a9b74" class="i method">Exists</a>(<span class="r36 r">virtualPath</span>))
            {
                <b>return</b> <span class="r36 r">virtualPath</span>;
            }
            <b>throw</b> <b>new</b> <a href="@0@System.Web/A.html#015a2e905338d78b" class="t constructor">HttpException</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#691a34e179b91fdb" class="i method">Format</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <a href="Resources/WebPageResources.Designer.cs.html#3048a2a8244ffbb2" class="t t">WebPageResources</a>.<a href="Resources/WebPageResources.Designer.cs.html#3f16eb73c0ab73c8" class="i property">WebPage_LayoutPageNotFound</a>, <span class="r35 r">layoutPagePath</span>, <span class="r36 r">virtualPath</span>));
        }
 
        <b>public virtual string</b> <a id="7bfc0fe98d1aedef" href="R/7bfc0fe98d1aedef.html" target="n" data-glyph="72,1" class="i method">NormalizePath</a>(<b>string</b> <span id="r37 rd" class="r37 r">path</span>)
        {
            <span class="c">// If it&#39;s relative, resolve it</span>
            <b>return</b> <a href="@0@System.Web/A.html#2b829f9059f552ca" class="t t">VirtualPathUtility</a>.<a href="@0@System.Web/A.html#610677a48757b9d4" class="i method">Combine</a>(<a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r37 r">path</span>);
        }
 
        <b>public abstract void</b> <a id="9fafae38a553f85c" href="R/9fafae38a553f85c.html" target="n" data-glyph="72,1" class="i method">Write</a>(<a href="HelperResult.cs.html#d4ee8fd9fd7b4c24" class="t t">HelperResult</a> <span id="r38 rd" class="r38 r">result</span>);
 
        <b>public abstract void</b> <a id="093ec25b00df6fd8" href="R/093ec25b00df6fd8.html" target="n" data-glyph="72,1" class="i method">Write</a>(<b>object</b> <span id="r39 rd" class="r39 r">value</span>);
 
        <b>public abstract void</b> <a id="1b761dc0fdf75920" href="R/1b761dc0fdf75920.html" target="n" data-glyph="72,1" class="i method">WriteLiteral</a>(<b>object</b> <span id="r40 rd" class="r40 r">value</span>);
 
        <b>public virtual void</b> <a id="686c3f61a373cc76" href="R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">WriteAttribute</a>(<b>string</b> <span id="r41 rd" class="r41 r">name</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r42 rd" class="r42 r">prefix</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r43 rd" class="r43 r">suffix</span>, <b>params</b> <a href="AttributeValue.cs.html#50d99d84bd8cbff2" class="t t">AttributeValue</a>[] <span id="r44 rd" class="r44 r">values</span>)
        {
            <a href="#1dd36683e86a5946" class="i method">WriteAttributeTo</a>(<a href="#3a630c81e365f632" class="i method">GetOutputWriter</a>(), <span class="r41 r">name</span>, <span class="r42 r">prefix</span>, <span class="r43 r">suffix</span>, <span class="r44 r">values</span>);
        }
 
        <b>public virtual void</b> <a id="1dd36683e86a5946" href="R/1dd36683e86a5946.html" target="n" data-glyph="72,1" class="i method">WriteAttributeTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r45 rd" class="r45 r">writer</span>, <b>string</b> <span id="r46 rd" class="r46 r">name</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r47 rd" class="r47 r">prefix</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r48 rd" class="r48 r">suffix</span>, <b>params</b> <a href="AttributeValue.cs.html#50d99d84bd8cbff2" class="t t">AttributeValue</a>[] <span id="r49 rd" class="r49 r">values</span>)
        {
            <a href="#56b7909eda70bea2" class="i method">WriteAttributeTo</a>(<a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>, <span class="r45 r">writer</span>, <span class="r46 r">name</span>, <span class="r47 r">prefix</span>, <span class="r48 r">suffix</span>, <span class="r49 r">values</span>);
        }
 
        <b>protected internal virtual void</b> <a id="56b7909eda70bea2" href="R/56b7909eda70bea2.html" target="n" data-glyph="75,1" class="i method">WriteAttributeTo</a>(<b>string</b> <span id="r50 rd" class="r50 r">pageVirtualPath</span>, <a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r51 rd" class="r51 r">writer</span>, <b>string</b> <span id="r52 rd" class="r52 r">name</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r53 rd" class="r53 r">prefix</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r54 rd" class="r54 r">suffix</span>, <b>params</b> <a href="AttributeValue.cs.html#50d99d84bd8cbff2" class="t t">AttributeValue</a>[] <span id="r55 rd" class="r55 r">values</span>)
        {
            <b>bool</b> <span id="r56 rd" class="r56 r">first</span> = <b>true</b>;
            <b>bool</b> <span id="r57 rd" class="r57 r">wroteSomething</span> = <b>false</b>;
            <b>if</b> (<span class="r55 r">values</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> == 0)
            {
                <span class="c">// Explicitly empty attribute, so write the prefix and suffix</span>
                <a href="#47a27e071638d988" class="i method">WritePositionTaggedLiteral</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r53 r">prefix</span>);
                <a href="#47a27e071638d988" class="i method">WritePositionTaggedLiteral</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r54 r">suffix</span>);
            }
            <b>else</b>
            {
                <b>for</b> (<b>int</b> <span id="r58 rd" class="r58 r">i</span> = 0; <span class="r58 r">i</span> &lt; <span class="r55 r">values</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r58 r">i</span>++)
                {
                    <a href="AttributeValue.cs.html#50d99d84bd8cbff2" class="t t">AttributeValue</a> <span id="r59 rd" class="r59 r">attrVal</span> = <span class="r55 r">values</span>[<span class="r58 r">i</span>];
                    <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>object</b>&gt; <span id="r60 rd" class="r60 r">val</span> = <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#8b01b5750283cf15" class="i property">Value</a>;
                    <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r61 rd" class="r61 r">next</span> = <span class="r58 r">i</span> == <span class="r55 r">values</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - 1 ?
                        <span class="r54 r">suffix</span> : <span class="c">// End of the list, grab the suffix</span>
                        <span class="r55 r">values</span>[<span class="r58 r">i</span> + 1].<a href="AttributeValue.cs.html#e1002e9d5ec9c0d4" class="i property">Prefix</a>; <span class="c">// Still in the list, grab the next prefix</span>
 
                    <b>if</b> (<span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a> == <b>null</b>)
                    {
                        <span class="c">// Nothing to write</span>
                        <b>continue</b>;
                    }
 
                    <span class="c">// The special cases here are that the value we&#39;re writing might already be a string, or that the </span>
                    <span class="c">// value might be a bool. If the value is the bool &#39;true&#39; we want to write the attribute name instead</span>
                    <span class="c">// of the string &#39;true&#39;. If the value is the bool &#39;false&#39; we don&#39;t want to write anything.</span>
                    <span class="c">//</span>
                    <span class="c">// Otherwise the value is another object (perhaps an IHtmlString), and we&#39;ll ask it to format itself.</span>
                    <b>string</b> <span id="r62 rd" class="r62 r">stringValue</span>;
 
                    <span class="c">// Intentionally using is+cast here for performance reasons. This is more performant than as+bool? </span>
                    <span class="c">// because of boxing.</span>
                    <b>if</b> (<span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a> <b>is bool</b>)
                    {
                        <b>if</b> ((<b>bool</b>)<span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a>)
                        {
                            <span class="r62 r">stringValue</span> = <span class="r52 r">name</span>;
                        }
                        <b>else</b>
                        {
                            <b>continue</b>;
                        }
                    }
                    <b>else</b>
                    {
                        <span class="r62 r">stringValue</span> = <span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a> <b>as string</b>;
                    }
 
                    <b>if</b> (<span class="r56 r">first</span>)
                    {
                        <a href="#47a27e071638d988" class="i method">WritePositionTaggedLiteral</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r53 r">prefix</span>);
                        <span class="r56 r">first</span> = <b>false</b>;
                    }
                    <b>else</b>
                    {
                        <a href="#47a27e071638d988" class="i method">WritePositionTaggedLiteral</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#e1002e9d5ec9c0d4" class="i property">Prefix</a>);
                    }
 
                    <span class="c">// Calculate length of the source span by the position of the next value (or suffix)</span>
                    <b>int</b> <span id="r63 rd" class="r63 r">sourceLength</span> = <span class="r61 r">next</span>.<a href="Instrumentation/PositionTagged.cs.html#52ff48501dab000b" class="i property">Position</a> - <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#8b01b5750283cf15" class="i property">Value</a>.<a href="Instrumentation/PositionTagged.cs.html#52ff48501dab000b" class="i property">Position</a>;
 
                    <a href="#903bb8d203817628" class="i method">BeginContext</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#8b01b5750283cf15" class="i property">Value</a>.<a href="Instrumentation/PositionTagged.cs.html#52ff48501dab000b" class="i property">Position</a>, <span class="r63 r">sourceLength</span>, <span class="r17 r">isLiteral</span>: <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#d90f6ca4930294c2" class="i property">Literal</a>);
 
                    <span class="c">// The extra branching here is to ensure that we call the Write*To(string) overload when</span>
                    <span class="c">// possible.</span>
                    <b>if</b> (<span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#d90f6ca4930294c2" class="i property">Literal</a> &amp;&amp; <span class="r62 r">stringValue</span> != <b>null</b>)
                    {
                        <a href="#cb94f3f8043fa73c" class="i method">WriteLiteralTo</a>(<span class="r51 r">writer</span>, <span class="r62 r">stringValue</span>);
                    }
                    <b>else if</b> (<span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#d90f6ca4930294c2" class="i property">Literal</a>)
                    {
                        <a href="#8a83951f7f45c442" class="i method">WriteLiteralTo</a>(<span class="r51 r">writer</span>, <span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a>);
                    }
                    <b>else if</b> (<span class="r62 r">stringValue</span> != <b>null</b>)
                    {
                        <a href="#88f44c3b70ea701d" class="i method">WriteTo</a>(<span class="r51 r">writer</span>, <span class="r62 r">stringValue</span>);
                    }
                    <b>else</b>
                    {
                        <a href="#656b4d605e111924" class="i method">WriteTo</a>(<span class="r51 r">writer</span>, <span class="r60 r">val</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a>);
                    }
 
                    <a href="#3ab45f83458e06e4" class="i method">EndContext</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#8b01b5750283cf15" class="i property">Value</a>.<a href="Instrumentation/PositionTagged.cs.html#52ff48501dab000b" class="i property">Position</a>, <span class="r63 r">sourceLength</span>, <span class="r33 r">isLiteral</span>: <span class="r59 r">attrVal</span>.<a href="AttributeValue.cs.html#d90f6ca4930294c2" class="i property">Literal</a>);
                    <span class="r57 r">wroteSomething</span> = <b>true</b>;
                }
                <b>if</b> (<span class="r57 r">wroteSomething</span>)
                {
                    <a href="#47a27e071638d988" class="i method">WritePositionTaggedLiteral</a>(<span class="r51 r">writer</span>, <span class="r50 r">pageVirtualPath</span>, <span class="r54 r">suffix</span>);
                }
            }
        }
 
        <b>private void</b> <a id="3d801d292e35b96f" href="R/3d801d292e35b96f.html" target="n" data-glyph="76,1" class="i method">WritePositionTaggedLiteral</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r64 rd" class="r64 r">writer</span>, <b>string</b> <span id="r65 rd" class="r65 r">pageVirtualPath</span>, <b>string</b> <span id="r66 rd" class="r66 r">value</span>, <b>int</b> <span id="r67 rd" class="r67 r">position</span>)
        {
            <a href="#903bb8d203817628" class="i method">BeginContext</a>(<span class="r64 r">writer</span>, <span class="r65 r">pageVirtualPath</span>, <span class="r67 r">position</span>, <span class="r66 r">value</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>, <span class="r17 r">isLiteral</span>: <b>true</b>);
            <a href="#cb94f3f8043fa73c" class="i method">WriteLiteralTo</a>(<span class="r64 r">writer</span>, <span class="r66 r">value</span>);
            <a href="#3ab45f83458e06e4" class="i method">EndContext</a>(<span class="r64 r">writer</span>, <span class="r65 r">pageVirtualPath</span>, <span class="r67 r">position</span>, <span class="r66 r">value</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>, <span class="r33 r">isLiteral</span>: <b>true</b>);
        }
 
        <b>private void</b> <a id="47a27e071638d988" href="R/47a27e071638d988.html" target="n" data-glyph="76,1" class="i method">WritePositionTaggedLiteral</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r68 rd" class="r68 r">writer</span>, <b>string</b> <span id="r69 rd" class="r69 r">pageVirtualPath</span>, <a href="Instrumentation/PositionTagged.cs.html#bbab1f4ac4a2c4fe" class="t t">PositionTagged</a>&lt;<b>string</b>&gt; <span id="r70 rd" class="r70 r">value</span>)
        {
            <a href="#3d801d292e35b96f" class="i method">WritePositionTaggedLiteral</a>(<span class="r68 r">writer</span>, <span class="r69 r">pageVirtualPath</span>, <span class="r70 r">value</span>.<a href="Instrumentation/PositionTagged.cs.html#2c02a9c5b57f8904" class="i property">Value</a>, <span class="r70 r">value</span>.<a href="Instrumentation/PositionTagged.cs.html#52ff48501dab000b" class="i property">Position</a>);
        }
 
        <span class="c">// This method is called by generated code and needs to stay in sync with the parser</span>
        <b>public static void</b> <a id="b37639b152b08899" href="R/b37639b152b08899.html" target="n" data-glyph="72,1" class="i method">WriteTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r71 rd" class="r71 r">writer</span>, <a href="HelperResult.cs.html#d4ee8fd9fd7b4c24" class="t t">HelperResult</a> <span id="r72 rd" class="r72 r">content</span>)
        {
            <b>if</b> (<span class="r72 r">content</span> != <b>null</b>)
            {
                <span class="r72 r">content</span>.<a href="HelperResult.cs.html#5a32c7ea0e835ff8" class="i method">WriteTo</a>(<span class="r71 r">writer</span>);
            }
        }
 
        <span class="c">// This method is called by generated code and needs to stay in sync with the parser</span>
        <b>public static void</b> <a id="656b4d605e111924" href="R/656b4d605e111924.html" target="n" data-glyph="72,1" class="i method">WriteTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r73 rd" class="r73 r">writer</span>, <b>object</b> <span id="r74 rd" class="r74 r">content</span>)
        {
            <span class="r73 r">writer</span>.<a href="@0@mscorlib/A.html#d3fb8ea93246e9a9" class="i method">Write</a>(<a href="@0@System.Web/A.html#830b8c414c23ea63" class="t t">HttpUtility</a>.<a href="@0@System.Web/A.html#754712e012a76566" class="i method">HtmlEncode</a>(<span class="r74 r">content</span>));
        }
 
        <span class="c">// Perf optimization to avoid calling string.ToString when we already know the type is a string.</span>
        <b>private static void</b> <a id="88f44c3b70ea701d" href="R/88f44c3b70ea701d.html" target="n" data-glyph="76,1" class="i method">WriteTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r75 rd" class="r75 r">writer</span>, <b>string</b> <span id="r76 rd" class="r76 r">content</span>)
        {
            <span class="r75 r">writer</span>.<a href="@0@mscorlib/A.html#d3fb8ea93246e9a9" class="i method">Write</a>(<a href="@0@System.Web/A.html#830b8c414c23ea63" class="t t">HttpUtility</a>.<a href="@0@System.Web/A.html#8fc355b1e6c7e374" class="i method">HtmlEncode</a>(<span class="r76 r">content</span>));
        }
 
        <span class="c">// This method is called by generated code and needs to stay in sync with the parser</span>
        <b>public static void</b> <a id="8a83951f7f45c442" href="R/8a83951f7f45c442.html" target="n" data-glyph="72,1" class="i method">WriteLiteralTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r77 rd" class="r77 r">writer</span>, <b>object</b> <span id="r78 rd" class="r78 r">content</span>)
        {
            <span class="r77 r">writer</span>.<a href="@0@mscorlib/A.html#20e18fa41ebefe91" class="i method">Write</a>(<span class="r78 r">content</span>);
        }
 
        <span class="c">// Perf optimization to avoid calling string.ToString when we already know the type is a string.</span>
        <b>private static void</b> <a id="cb94f3f8043fa73c" href="R/cb94f3f8043fa73c.html" target="n" data-glyph="76,1" class="i method">WriteLiteralTo</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r79 rd" class="r79 r">writer</span>, <b>string</b> <span id="r80 rd" class="r80 r">content</span>)
        {
            <span class="r79 r">writer</span>.<a href="@0@mscorlib/A.html#d3fb8ea93246e9a9" class="i method">Write</a>(<span class="r80 r">content</span>);
        }
 
        [<a href="@0@mscorlib/A.html#5e00de6576fb9ce7" class="t constructor">SuppressMessage</a>(<span class="s">&quot;Microsoft.Design&quot;</span>, <span class="s">&quot;CA1024:UsePropertiesWhereAppropriate&quot;</span>, <a href="@0@mscorlib/A.html#ce02a652a479502a" class="i property">Justification</a> = <span class="s">&quot;A method is more appropriate in this case since a property likely already exists to hold this value&quot;</span>)]
        <b>protected internal virtual</b> <a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <a id="3a630c81e365f632" href="R/3a630c81e365f632.html" target="n" data-glyph="75,1" class="i method">GetOutputWriter</a>()
        {
            <b>return</b> <a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a>.<a href="@0@mscorlib/A.html#416d61e61f460ce0" class="i field">Null</a>;
        }
 
        <b>protected internal void</b> <a id="629a6a5a0178ac7f" href="R/629a6a5a0178ac7f.html" target="n" data-glyph="75,1" class="i method">ExecutePage</a>()
        {
            <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="k">var</a> <span id="r81 rd" class="r81 r">task</span> = <a href="#c4f247a667301bb5" class="i method">ExecuteAsync</a>();
            <b>if</b> (<span class="r81 r">task</span> == <b>null</b>)
            {
                <a href="#3718fea45de51960" class="i method">Execute</a>();
            }
            <b>else</b>
            {
                <b>if</b> (!<span class="r81 r">task</span>.<a href="Common/TaskHelpersExtensionsEx.cs.html#aae73fe8facb24f5" class="i method">IsCompletedSynchronously</a>())
                {
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3d3c2c03118be4f8" class="t constructor">NotSupportedException</a>(
                        <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#691a34e179b91fdb" class="i method">Format</a>(<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#26ef1c020f0dbb7a" class="i property">InvariantCulture</a>,
                            <a href="Resources/WebPageResources.Designer.cs.html#3048a2a8244ffbb2" class="t t">WebPageResources</a>.<a href="Resources/WebPageResources.Designer.cs.html#24db7acb5867a999" class="i property">WebPage_SyncAsyncConflict</a>,
                            <a href="#8ac9f97f3cdb7eb5" class="i property">VirtualPath</a>));
                }
                <span class="r81 r">task</span>.<a href="@0@mscorlib/A.html#9865ec4fb8abca74" class="i method">GetAwaiter</a>().<a href="@0@mscorlib/A.html#fac5be2731353aa8" class="i method">GetResult</a>();
            }
        }
    }
}
</pre></td></tr></table></div></body></html>
