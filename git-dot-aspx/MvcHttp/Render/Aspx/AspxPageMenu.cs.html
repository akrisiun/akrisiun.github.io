<!DOCTYPE html>
<html><head><title>AspxPageMenu.cs</title><link rel="stylesheet" href="../../../styles.css"><script src="../../../scripts.js"></script></head>
<body class="cB" onload="i(48);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#MvcHttp/Render/Aspx/AspxPageMenu.cs" target="_top">Render\Aspx\AspxPageMenu.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#MvcHttp" target="_top">MvcHttp\MvcHttp.csproj</a> (MvcHttp)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Data</span>.<span class="i n">SqlClient</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>.<span class="i n">XPath</span>;

<b>namespace</b> <span class="i n">AiLib</span>.<span class="i n">Render</span>
{

    <span class="c">// &lt;snx:AspxPageMenu ID = &quot;pagetopx&quot; runat=&quot;server&quot; PrmAdd=&quot;link=asortx&quot; /&gt;</span>

    <span class="c">// &lt;snx:AspxProcRender ID = &quot;pagetopx&quot; runat=&quot;server&quot; IsDebug=&quot;0&quot;</span>
    <span class="c">//    SqlProc=&#39;dbo.jmenu_top&#39; PrmAdd=&quot;link=asortx&quot;</span>
    <span class="c">//    PrmListNum=&quot;userid&quot; Xslt=&quot;../pagemenux.xslt&quot; Timeout=&quot;2000&quot; /&gt;</span>

    <b>public class</b> <a id="37d95cfc6e8784e5" href="../../R/../../0000000000.html" target="n" data-glyph="0,0" class="t t">AspxPageMenu</a> : <a href="AspxProcRender.cs.html#3dda630eb4a57529" class="t t">AspxProcRender</a>
    {
        <b>public</b> <a id="fef5485659b9bb07" href="../../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">AspxPageMenu</a>()
        {
            <a href="AspxProcRender.cs.html#53478e87c28298b4" class="i property">SqlProc</a> = <span class="s">&quot;dbo.jmenu_top&quot;</span>;
            <a href="../RenderXslt.cs.html#c4d183a0c6cefee0" class="i property">PrmListNum</a> = <span class="s">&quot;userid&quot;</span>;
            <a href="AspxProcRender.cs.html#0a38e30f20b7517c" class="i property">SqlParam</a> = <span class="s">&quot;@site = &#39;PRK&#39;, @userid = @userid, @link = @link, @FIRMID = @FirmID&quot;</span>;
            <a href="../RenderXslt.cs.html#89b2dbfed38b128a" class="i property">Xslt</a> = <span class="s">&quot;../pagemenux.xslt&quot;</span>;
            <a href="../RenderXslt.cs.html#10f8906df3e131f0" class="i property">Timeout</a> = 2000;
            <a href="../RenderXslt.cs.html#7b98fcec60259db2" class="i property">VarcharAdd</a> = <span class="s">&quot;15&quot;</span>;
        }

        <b>public string</b> <a id="90c9919f9a9fea91" href="../../R/90c9919f9a9fea91.html" target="n" data-glyph="102,1" class="i property">link</a> { <b>get</b>; <b>set</b>; }

        <b>public override void</b> <a id="2e39c742c64cfbdf" href="../../R/2e39c742c64cfbdf.html" target="n" data-glyph="72,1" class="i method">RenderHtml</a>(<a href="@0@mscorlib/A.html#6e84a88dc2be46e3" class="t t">TextWriter</a> <span id="r0 rd" class="r0 r">writer</span>, <a href="@0@System.Xml/A.html#c95222d6a80fe203" class="t t">XPathDocument</a> <span id="r1 rd" class="r1 r">xmlDoc</span>)
        {
            <b>if</b> (<a href="../RenderXslt.cs.html#b7e3f5e73ef547a2" class="i field">isDebug</a> &gt; 0)
                <span class="r0 r">writer</span>.<a href="@0@mscorlib/A.html#5238cceaebfeaa74" class="i method">WriteLine</a>(<span class="s">&quot;[PageMenu=&quot;</span> + <a href="#37d95cfc6e8784e5" class="k">this</a>.<a href="../RenderXslt.cs.html#27d5ff513b533413" class="i property">PrmAdd</a> ?? <span class="s">&quot;&quot;</span> + <span class="s">&quot;]&quot;</span>);
            <b>if</b> (<a href="#37d95cfc6e8784e5" class="k">this</a>.<a href="../RenderXslt.cs.html#27d5ff513b533413" class="i property">PrmAdd</a> != <b>null</b> &amp;&amp; <a href="../RenderXslt.cs.html#27d5ff513b533413" class="i property">PrmAdd</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;link=&quot;</span>))
                <a href="#90c9919f9a9fea91" class="i property">link</a> = <a href="../RenderXslt.cs.html#27d5ff513b533413" class="i property">PrmAdd</a>.<a href="@0@mscorlib/A.html#882fa7998d6ca35a" class="i method">Substring</a>(5);

            <a href="AspxProcRender.cs.html#3dda630eb4a57529" class="k">base</a>.<a href="AspxProcRender.cs.html#55cb7123df17d076" class="i method">RenderHtml</a>(<span class="r0 r">writer</span>, <span class="r1 r">xmlDoc</span>);
        }

        <b>public override void</b> <a id="ceed34ff75b3200b" href="../../R/ceed34ff75b3200b.html" target="n" data-glyph="72,1" class="i method">ParseSqlParam</a>(<a href="@0@System.Data/A.html#f00e50d65755ab48" class="t t">SqlParameter</a> <span id="r2 rd" class="r2 r">prm</span>)
        {
            <a href="AspxProcRender.cs.html#3dda630eb4a57529" class="k">base</a>.<a href="AspxProcRender.cs.html#36f3488e522f1204" class="i method">ParseSqlParam</a>(<span class="r2 r">prm</span>);

            <b>if</b> (<span class="r2 r">prm</span>.<a href="@0@System.Data/A.html#5d9f7c4d890fcaf5" class="i property">ParameterName</a>.<a href="@0@mscorlib/A.html#b98069ccbe2d3960" class="i method">Equals</a>(<span class="s">&quot;@link&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#eabf4db5f5c52b6a" class="i field">InvariantCultureIgnoreCase</a>) &amp;&amp; <a href="#90c9919f9a9fea91" class="i property">link</a> != <b>null</b>)
                <span class="r2 r">prm</span>.<a href="@0@System.Data/A.html#a34912fb58c46757" class="i property">Value</a> = <a href="#90c9919f9a9fea91" class="i property">link</a>;
        }
    }
}
</pre></td></tr></table></div></body></html>
