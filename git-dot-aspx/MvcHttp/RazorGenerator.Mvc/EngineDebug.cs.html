<!DOCTYPE html>
<html><head><title>EngineDebug.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(108);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#MvcHttp/RazorGenerator.Mvc/EngineDebug.cs" target="_top">RazorGenerator.Mvc\EngineDebug.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#MvcHttp" target="_top">MvcHttp\MvcHttp.csproj</a> (MvcHttp)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">RazorGenerator</span>.<span class="i n">Mvc</span>;
<b>using</b> <span class="i n">AiLib</span>.<span class="i n">Web</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">ObjectModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Reflection</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Web</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Routing</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">WebPages</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Xml</span>.<span class="i n">Linq</span>;

<b>namespace</b> <span class="i n">AiLib</span>.<span class="i n">RazorGenerator</span>.<span class="i n">Mvc</span>
{
    <b>public static class</b> <a id="50279afabfb7e460" href="../R/50279afabfb7e460.html" target="n" data-glyph="0,0" class="t t">EngineDebug</a>
    {
        <b>public static void</b> <a id="f72e6d61ab633981" href="../R/f72e6d61ab633981.html" target="n" data-glyph="72,1" class="i method">Output</a>(<a href="@0@System.Web/A.html#e0024ceb56a35b12" class="t t">HttpResponse</a> <span id="r0 rd" class="r0 r">Response</span>)
        {
            <span class="r0 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;&lt;br/&gt;HostingEnvironment.ApplicationPhysicalPath=&quot;</span> + <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Hosting</span>.<a href="@0@System.Web/A.html#f12b2fb72be7982c" class="t t">HostingEnvironment</a>.<a href="@0@System.Web/A.html#5c349191566e3f2c" class="i property">ApplicationPhysicalPath</a>);
            <span class="r0 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;&lt;br/&gt;HostingEnvironment.ApplicationVirtualPath=&quot;</span> + <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Hosting</span>.<a href="@0@System.Web/A.html#f12b2fb72be7982c" class="t t">HostingEnvironment</a>.<a href="@0@System.Web/A.html#403ee1a4de2b9a62" class="i property">ApplicationVirtualPath</a>);
            <span class="r0 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;&lt;br/&gt;HostingEnvironment.SiteName=&quot;</span> + <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Hosting</span>.<a href="@0@System.Web/A.html#f12b2fb72be7982c" class="t t">HostingEnvironment</a>.<a href="@0@System.Web/A.html#1cb1426b6b4db0e4" class="i property">SiteName</a>);

            <span class="i n">AiLib</span>.<span class="i n">RazorGenerator</span>.<span class="i n">Mvc</span>.<a href="#50279afabfb7e460" class="t t">EngineDebug</a>.<a href="#3971d6dc02fd2c75" class="i method">ListRoutes</a>(<span class="r0 r">Response</span>);
            <span class="i n">AiLib</span>.<span class="i n">RazorGenerator</span>.<span class="i n">Mvc</span>.<a href="#50279afabfb7e460" class="t t">EngineDebug</a>.<a href="#632750e01d00f1ae" class="i method">ListMap</a>(<span class="r0 r">Response</span>, <span class="i n">System</span>.<span class="i n">Reflection</span>.<a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a>.<a href="@0@mscorlib/A.html#0b58cbf47b813b13" class="i method">GetEntryAssembly</a>());

            <b>try</b>
            {
                <b>string</b> <span id="r1 rd" class="r1 r">url</span> = <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Hosting</span>.<a href="@0@System.Web/A.html#f12b2fb72be7982c" class="t t">HostingEnvironment</a>.<a href="@0@System.Web/A.html#403ee1a4de2b9a62" class="i property">ApplicationVirtualPath</a>;
                <span class="i n">AiLib</span>.<span class="i n">MvcHttp</span>.<a href="../MvcHttp/RoutingModule.cs.html#10d2b204ba67c38f" class="t t">RoutingModule</a>.<a href="../MvcHttp/RoutingModule.cs.html#6408b168e8c1174c" class="i method">EnumerateHttpModules</a>(<span class="r1 r">url</span>, <span class="r0 r">Response</span>);
            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r2 rd" class="r2 r">ex</span>) { <span class="r0 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<span class="s">&quot;Route modules error {0}&quot;</span>, <span class="r2 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>)); }
        }

        <b>public static void</b> <a id="632750e01d00f1ae" href="../R/632750e01d00f1ae.html" target="n" data-glyph="72,1" class="i method">ListMap</a>(<a href="@0@System.Web/A.html#e0024ceb56a35b12" class="t t">HttpResponse</a> <span id="r3 rd" class="r3 r">Response</span>, <a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="t t">Assembly</a> <span id="r4 rd" class="r4 r">asm</span>)
        {
            <b>try</b>
            {
                <a href="@0@mscorlib/A.html#73b5be5e9c2474b2" class="k">var</a> <span id="r5 rd" class="r5 r">assembly</span> = <span class="r4 r">asm</span> ?? <a href="PrecompiledMvcEngine.cs.html#ec2f5eff395ac82d" class="t t">PrecompiledMvcEngine</a>.<a href="PrecompiledMvcEngine.cs.html#04fc74a02bb00747" class="i property">Assemblies</a>.<a href="@0@System.Core/A.html#bc8ae402a61dd9d6" class="i method">First</a>();

                <a href="@0@mscorlib/A.html#3acf01620172c7f0" class="k">var</a> <span id="r6 rd" class="r6 r">map</span> = (<b>from</b> <span class="i">type</span> <b>in</b> <span class="r5 r">assembly</span>.<a href="@0@mscorlib/A.html#5ef0afb56c4252c4" class="i method">GetTypes</a>()
                           <b>where typeof</b>(<a href="/System.Web.WebPages/A.html#9e5796cf6032508c" class="t t">WebPageRenderingBase</a>).<a href="@0@mscorlib/A.html#ba0cffea035fe210" class="i method">IsAssignableFrom</a>(<span class="i">type</span>)
                           <b>let</b> <span class="i">pageVirtualPath</span> =
                               <span class="i">type</span>.<a href="@0@mscorlib/A.html#b25e40856426d3fd" class="i method">GetCustomAttributes</a>(<span class="r7 r">inherit</span>: <b>false</b>).<a href="@0@System.Core/A.html#4ba4a3f8a5530e33" class="i method">OfType</a>&lt;<a href="/System.Web.WebPages/A.html#e610a9354f849b58" class="t t">PageVirtualPathAttribute</a>&gt;().<a href="@0@System.Core/A.html#8087366974af11d2" class="i method">FirstOrDefault</a>()
                           <b>where</b> <span class="i">pageVirtualPath</span> != <b>null
                           select</b> <b>new</b>
                           {
                               <a href="#42c35083cd756f40" class="i property">VirtualPath</a> = <span class="i">pageVirtualPath</span>.<a href="/System.Web.WebPages/A.html#ef0dd47c3cc01d3e" class="i property">VirtualPath</a>,
                               <a href="#32b3e9d53a6e4af0" class="i property">Type</a> = <span class="i">type</span>.<a href="@0@mscorlib/A.html#3b264aebc8d4c084" class="i method">ToString</a>()
                           }
                           );

                <span class="r3 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;&lt;br&gt;&quot;</span>);
                <span class="r3 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;Assembly= &quot;</span> + <span class="r5 r">assembly</span>.<a href="@0@mscorlib/A.html#b9c8ae94c4abcd19" class="i method">ToString</a>() + <span class="s">&quot;&lt;br&gt;&quot;</span>);
                <b>if</b> (!<span class="r6 r">map</span>.<a href="@0@System.Core/A.html#8788153112b7ffd0" class="i method">Any</a>())
                    <span class="r3 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="s">&quot;No WebPageRenderingBase atributes [PageVirtualPathAttribute]&lt;br&gt;&quot;</span>);
                <b>else</b>
                {
                    <a href="@0@System.Xml.Linq/A.html#3367036406d1344a" class="k">var</a> <span id="r8 rd" class="r8 r">table</span> = <b>new</b> <a href="@0@System.Xml.Linq/A.html#003021639e94d77e" class="t constructor">XElement</a>(<span class="s">&quot;table&quot;</span>,
                            <b>new</b> <a href="@0@System.Xml.Linq/A.html#003021639e94d77e" class="t constructor">XElement</a>(<span class="s">&quot;tr&quot;</span>, <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;th&quot;</span>, <span class="s">&quot;VirtualPath&quot;</span>), <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;th&quot;</span>, <span class="s">&quot;Type&quot;</span>)),
                            <span class="r6 r">map</span>.<a href="@0@System.Core/A.html#5c652c53e80df013" class="i method">Select</a>(<span id="r9 rd" class="r9 r">item</span> =&gt; <b>new</b> <a href="@0@System.Xml.Linq/A.html#003021639e94d77e" class="t constructor">XElement</a>(<span class="s">&quot;tr&quot;</span>,
                                    <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;td&quot;</span>, <span class="r9 r">item</span>.<a href="#42c35083cd756f40" class="i property">VirtualPath</a>),
                                    <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;td&quot;</span>, <span class="r9 r">item</span>.<a href="#32b3e9d53a6e4af0" class="i property">Type</a>)
                                ))
                            );
                    <span class="r8 r">table</span>.<a href="@0@System.Xml.Linq/A.html#a1e26e9813dcb079" class="i method">Save</a>(<span class="r3 r">Response</span>.<a href="@0@System.Web/A.html#3c29f5fdeb0c3274" class="i property">OutputStream</a>);
                }

            }
            <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r10 rd" class="r10 r">ex</span>) { <span class="r3 r">Response</span>.<a href="@0@System.Web/A.html#355af38c52cf2f71" class="i method">Write</a>(<span class="r10 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>); }
        }

        <b>public static void</b> <a id="3971d6dc02fd2c75" href="../R/3971d6dc02fd2c75.html" target="n" data-glyph="72,1" class="i method">ListRoutes</a>(<a href="@0@System.Web/A.html#e0024ceb56a35b12" class="t t">HttpResponse</a> <span id="r11 rd" class="r11 r">Response</span>)
        {
            <a href="@0@System.Web/A.html#8cac309f1a0b0c93" class="t t">RouteCollection</a> <span id="r12 rd" class="r12 r">routes</span> = <a href="@0@System.Web/A.html#8fea77bf3f48b5d5" class="t t">RouteTable</a>.<a href="@0@System.Web/A.html#eeccff00bafcef91" class="i property">Routes</a>;
            <a href="@0@mscorlib/A.html#281923b8611114ec" class="t t">Collection</a>&lt;<a href="@0@System.Web/A.html#090919121320fbd1" class="t t">RouteBase</a>&gt; <span id="r13 rd" class="r13 r">List</span> = <span class="r12 r">routes</span>;

            <a href="@0@System.Xml.Linq/A.html#3367036406d1344a" class="k">var</a> <span id="r14 rd" class="r14 r">table</span> = <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;table&quot;</span>, <b>new</b> <a href="@0@System.Xml.Linq/A.html#003021639e94d77e" class="t constructor">XElement</a>(<span class="s">&quot;tr&quot;</span>
                    , <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;th&quot;</span>, <span class="s">&quot;Route.Defaults&quot;</span>)
                    , <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;th&quot;</span>, <span class="s">&quot;Route.Url&quot;</span>)
                    ));
            <span class="r14 r">table</span>.<a href="@0@System.Xml.Linq/A.html#ec7a3166ef790ab0" class="i method">Add</a>(<span class="r13 r">List</span>.<a href="@0@System.Core/A.html#5c652c53e80df013" class="i method">Select</a>(<span id="r15 rd" class="r15 r">item</span> =&gt; <b>new</b> <a href="@0@System.Xml.Linq/A.html#003021639e94d77e" class="t constructor">XElement</a>(<span class="s">&quot;tr&quot;</span>
                    , <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;td&quot;</span>, <span class="r15 r">item</span> <b>is</b> <a href="@0@System.Web/A.html#7709a57a53b95f39" class="t t">Route</a> ? <a href="#47ac5ed9323bcd34" class="i method">ParseDefaults</a>((<span class="r15 r">item</span> <b>as</b> <a href="@0@System.Web/A.html#7709a57a53b95f39" class="t t">Route</a>).<a href="@0@System.Web/A.html#62ac668e1be829c1" class="i property">Defaults</a>) : <span class="s">&quot;-&quot;</span>)
                    , <b>new</b> <a href="@0@System.Xml.Linq/A.html#7f699221c89b323a" class="t constructor">XElement</a>(<span class="s">&quot;td&quot;</span>, <a href="../Web/Reflection/ObjectConvert.cs.html#0b8ca5551ad56f1d" class="t t">ObjectConvert</a>.<a href="../Web/Reflection/ObjectConvert.cs.html#e93353bdb711b808" class="i method">GetValue</a>&lt;<b>string</b>&gt;(<span class="r15 r">item</span>, <span class="s">&quot;Url&quot;</span>))
                    )));
            <span class="r11 r">Response</span>.<a href="@0@System.Web/A.html#c01ce44e8e13be9b" class="i method">Write</a>(<b>new</b> <a href="@0@System.Xml.Linq/A.html#6be3dee6c68afac7" class="t constructor">XElement</a>(<span class="s">&quot;br&quot;</span>));
            <span class="r14 r">table</span>.<a href="@0@System.Xml.Linq/A.html#a1e26e9813dcb079" class="i method">Save</a>(<span class="r11 r">Response</span>.<a href="@0@System.Web/A.html#3c29f5fdeb0c3274" class="i property">OutputStream</a>);
        }

        <b>static string</b> <a id="47ac5ed9323bcd34" href="../R/47ac5ed9323bcd34.html" target="n" data-glyph="76,1" class="i method">ParseDefaults</a>(<a href="@0@System.Web/A.html#551a423c96bb6648" class="t t">RouteValueDictionary</a> <span id="r16 rd" class="r16 r">defaults</span>)
        {
            <b>string</b> <span id="r17 rd" class="r17 r">str</span> = <span class="s">&quot;&quot;</span>;
            <b>if</b> (<span class="r16 r">defaults</span> == <b>null</b>)
                <b>return</b> <span class="r17 r">str</span>;
            <a href="@0@mscorlib/A.html#582570d1db5b1584" class="k">var</a> <span id="r18 rd" class="r18 r">numer</span> = <span class="r16 r">defaults</span>.<a href="@0@System.Web/A.html#b03e7af96016104d" class="i method">GetEnumerator</a>();
            <b>while</b> (<span class="r18 r">numer</span>.<a href="@0@mscorlib/A.html#d864a2277aad4ece" class="i method">MoveNext</a>())
            {
                <a href="@0@mscorlib/A.html#8585965bb176a426" class="t t">KeyValuePair</a>&lt;<b>string</b>,<b>object</b>&gt; <span id="r19 rd" class="r19 r">obj</span> = <span class="r18 r">numer</span>.<a href="@0@mscorlib/A.html#b2a4421c980d1c85" class="i property">Current</a>;
                <span class="r17 r">str</span> = <span class="r19 r">obj</span>.<a href="@0@mscorlib/A.html#f9d1c04feb1af032" class="i property">Key</a> + <span class="s">&quot;=\&quot;&quot;</span> + <span class="r19 r">obj</span>.<a href="@0@mscorlib/A.html#38c0e86cc4b30170" class="i property">Value</a>.<a href="@0@mscorlib/A.html#ff31a6bf27c58f89" class="i method">ToString</a>() + <span class="s">&quot;\&quot; &quot;</span>
                    + (<span class="r17 r">str</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> == 0 ? <span class="s">&quot;&quot;</span> : <span class="s">&quot;, &quot;</span> + <span class="r17 r">str</span>);
            }
            <b>return</b> <span class="s">&quot;{ &quot;</span> + <span class="r17 r">str</span> + <span class="s">&quot;}&quot;</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
