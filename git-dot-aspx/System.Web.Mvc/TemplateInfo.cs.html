<!DOCTYPE html>
<html><head><title>TemplateInfo.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(70);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Web.Mvc/TemplateInfo.cs" target="_top">TemplateInfo.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Web.Mvc" target="_top">..\Mvc\src\System.Web.Mvc\System.Web.Mvc.csproj</a> (System.Web.Mvc)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Mvc</span>
{
    <b>public class</b> <a id="9d26d6ceeeda48b8" href="R/9d26d6ceeeda48b8.html" target="n" data-glyph="0,0" class="t t"><span id="76121e78f7f95918">TemplateInfo</span></a>
    {
        <b>private string</b> <a id="01b37a8db359f36b" href="R/01b37a8db359f36b.html" target="n" data-glyph="46,1" class="i field">_htmlFieldPrefix</a>;
        <b>private object</b> <a id="0888cdab84d67e41" href="R/0888cdab84d67e41.html" target="n" data-glyph="46,1" class="i field">_formattedModelValue</a>;
        <b>private</b> <a href="@0@System.Core/A.html#2d265edc718b158b" class="t t">HashSet</a>&lt;<b>object</b>&gt; <a id="d126fccf060b3485" href="R/d126fccf060b3485.html" target="n" data-glyph="46,1" class="i field">_visitedObjects</a>;
 
        <b>public object</b> <a id="4e8f9dbade5a721d" href="R/4e8f9dbade5a721d.html" target="n" data-glyph="102,1" class="i property">FormattedModelValue</a>
        {
            <b>get</b> { <b>return</b> <a href="#0888cdab84d67e41" class="i field">_formattedModelValue</a> ?? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>; }
            <b>set</b> { <a href="#0888cdab84d67e41" class="i field">_formattedModelValue</a> = <b>value</b>; }
        }
 
        <b>public string</b> <a id="dcaceee13991ebba" href="R/dcaceee13991ebba.html" target="n" data-glyph="102,1" class="i property">HtmlFieldPrefix</a>
        {
            <b>get</b> { <b>return</b> <a href="#01b37a8db359f36b" class="i field">_htmlFieldPrefix</a> ?? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>; }
            <b>set</b> { <a href="#01b37a8db359f36b" class="i field">_htmlFieldPrefix</a> = <b>value</b>; }
        }
 
        <b>public int</b> <a id="92f4df1cee159041" href="R/92f4df1cee159041.html" target="n" data-glyph="102,1" class="i property">TemplateDepth</a>
        {
            <b>get</b> { <b>return</b> <a href="#47210e2cb98e5f95" class="i property">VisitedObjects</a>.<a href="@0@System.Core/A.html#905bec8c22644c82" class="i property">Count</a>; }
        }
 
        <span class="c">// DDB #224750 - Keep a collection of visited objects to prevent infinite recursion</span>
        <b>internal</b> <a href="@0@System.Core/A.html#2d265edc718b158b" class="t t">HashSet</a>&lt;<b>object</b>&gt; <a id="47210e2cb98e5f95" href="R/47210e2cb98e5f95.html" target="n" data-glyph="104,1" class="i property">VisitedObjects</a>
        {
            <b>get</b>
            {
                <b>if</b> (<a href="#d126fccf060b3485" class="i field">_visitedObjects</a> == <b>null</b>)
                {
                    <a href="#d126fccf060b3485" class="i field">_visitedObjects</a> = <b>new</b> <a href="@0@System.Core/A.html#eca9ea30fa3b2c28" class="t constructor">HashSet</a>&lt;<b>object</b>&gt;();
                }
                <b>return</b> <a href="#d126fccf060b3485" class="i field">_visitedObjects</a>;
            }
            <b>set</b> { <a href="#d126fccf060b3485" class="i field">_visitedObjects</a> = <b>value</b>; }
        }
 
        <b>public string</b> <a id="21f1c592547e0b69" href="R/21f1c592547e0b69.html" target="n" data-glyph="72,1" class="i method">GetFullHtmlFieldId</a>(<b>string</b> <span id="r0 rd" class="r0 r">partialFieldName</span>)
        {
            <b>return</b> <a href="HtmlHelper.cs.html#ebd284f3fdf9102f" class="t t">HtmlHelper</a>.<a href="HtmlHelper.cs.html#a340ebf3b5f03729" class="i method">GenerateIdFromName</a>(<a href="#5a2701df2153731d" class="i method">GetFullHtmlFieldName</a>(<span class="r0 r">partialFieldName</span>));
        }
 
        <b>public string</b> <a id="5a2701df2153731d" href="R/5a2701df2153731d.html" target="n" data-glyph="72,1" class="i method">GetFullHtmlFieldName</a>(<b>string</b> <span id="r1 rd" class="r1 r">partialFieldName</span>)
        {
            <b>if</b> (<span class="r1 r">partialFieldName</span> != <b>null</b> &amp;&amp; <span class="r1 r">partialFieldName</span>.<a href="@0@mscorlib/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;[&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#87891a6d28c64c9b" class="i field">Ordinal</a>))
            {
                <span class="c">// See Codeplex #544 - the partialFieldName might represent an indexer access, in which case combining</span>
                <span class="c">// with a &#39;dot&#39; would be invalid.</span>
                <b>return</b> <a href="#dcaceee13991ebba" class="i property">HtmlFieldPrefix</a> + <span class="r1 r">partialFieldName</span>;
            }
            <b>else</b>
            {
                <span class="c">// This uses &quot;combine and trim&quot; because either or both of these values might be empty</span>
                <b>return</b> (<a href="#dcaceee13991ebba" class="i property">HtmlFieldPrefix</a> + <span class="s">&quot;.&quot;</span> + (<span class="r1 r">partialFieldName</span> ?? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>)).<a href="@0@mscorlib/A.html#628f74f98ae9d848" class="i method">Trim</a>(<span class="s">&#39;.&#39;</span>);
            }
        }
 
        <b>public bool</b> <a id="e038aa110ff3acdc" href="R/e038aa110ff3acdc.html" target="n" data-glyph="72,1" class="i method">Visited</a>(<a href="ModelMetadata.cs.html#9f822c3699e92a04" class="t t">ModelMetadata</a> <span id="r2 rd" class="r2 r">metadata</span>)
        {
            <b>return</b> <a href="#47210e2cb98e5f95" class="i property">VisitedObjects</a>.<a href="@0@System.Core/A.html#06d905a0ac76e4f5" class="i method">Contains</a>(<span class="r2 r">metadata</span>.<a href="ModelMetadata.cs.html#702e9529d4cd753c" class="i property">Model</a> ?? <span class="r2 r">metadata</span>.<a href="ModelMetadata.cs.html#85ec391405d56c1f" class="i property">ModelType</a>);
        }
    }
}
</pre></td></tr></table></div></body></html>
