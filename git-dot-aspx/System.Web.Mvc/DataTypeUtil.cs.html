<!DOCTYPE html>
<html><head><title>DataTypeUtil.cs</title><link rel="stylesheet" href="../styles.css"><script src="../scripts.js"></script></head>
<body class="cB" onload="i(121);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#System.Web.Mvc/DataTypeUtil.cs" target="_top">DataTypeUtil.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#System.Web.Mvc" target="_top">..\Mvc\src\System.Web.Mvc\System.Web.Mvc.csproj</a> (System.Web.Mvc)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// Copyright (c) Microsoft Open Technologies, Inc. All rights reserved. See License.txt in the project root for license information.</span>
 
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>.<span class="i n">DataAnnotations</span>;
 
<b>namespace</b> <span class="i n">System</span>.<span class="i n">Web</span>.<span class="i n">Mvc</span>
{
    <b>internal static class</b> <a id="aa6a5d5d2b5c6494" href="R/aa6a5d5d2b5c6494.html" target="n" data-glyph="2,0" class="t t">DataTypeUtil</a>
    {
        <b>private static readonly string</b> <a id="e024263237119ba1" href="R/e024263237119ba1.html" target="n" data-glyph="46,1" class="i field">CreditCardTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#4ba06122f4b88692" class="i field">CreditCard</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="0e6b83cbe9623018" href="R/0e6b83cbe9623018.html" target="n" data-glyph="46,1" class="i field">CurrencyTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#24a2450d8b5086de" class="i field">Currency</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="ad8d6cc1b4970732" href="R/ad8d6cc1b4970732.html" target="n" data-glyph="46,1" class="i field">DateTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#fd9d12dd217da419" class="i field">Date</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="6bd9f91d229cdb54" href="R/6bd9f91d229cdb54.html" target="n" data-glyph="46,1" class="i field">DateTimeTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#8f46f71df3fdd95d" class="i field">DateTime</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="8b8565d2e0dc2483" href="R/8b8565d2e0dc2483.html" target="n" data-glyph="46,1" class="i field">DurationTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#e418db2a443cb514" class="i field">Duration</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="6e153da4836c2bcd" href="R/6e153da4836c2bcd.html" target="n" data-glyph="46,1" class="i field">EmailAddressTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#6b612cca43801415" class="i field">EmailAddress</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>internal static readonly string</b> <a id="3306a42117d4720e" href="R/3306a42117d4720e.html" target="n" data-glyph="44,1" class="i field">HtmlTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#559c86947539ce24" class="i field">Html</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="77d69afb33b5f0a1" href="R/77d69afb33b5f0a1.html" target="n" data-glyph="46,1" class="i field">ImageUrlTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#f803fca129dfab10" class="i field">ImageUrl</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="cf73460d7bc2e4f7" href="R/cf73460d7bc2e4f7.html" target="n" data-glyph="46,1" class="i field">MultiLineTextTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#eb2d12397cc0bc3b" class="i field">MultilineText</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="d06c88b739f217bf" href="R/d06c88b739f217bf.html" target="n" data-glyph="46,1" class="i field">PasswordTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#ef077846aa93a8a0" class="i field">Password</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="696f14254930a79f" href="R/696f14254930a79f.html" target="n" data-glyph="46,1" class="i field">PhoneNumberTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#67d39a90f0b1497c" class="i field">PhoneNumber</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="d85c46a5b784e527" href="R/d85c46a5b784e527.html" target="n" data-glyph="46,1" class="i field">PostalCodeTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#d37cd7fd6e41f079" class="i field">PostalCode</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="38e876ae1e760737" href="R/38e876ae1e760737.html" target="n" data-glyph="46,1" class="i field">TextTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#cf46f40bcf3f5a97" class="i field">Text</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="545ef41a2f3fef82" href="R/545ef41a2f3fef82.html" target="n" data-glyph="46,1" class="i field">TimeTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#e55336cb6e484d1c" class="i field">Time</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="1db5420831166efd" href="R/1db5420831166efd.html" target="n" data-glyph="46,1" class="i field">UploadTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#76a24977b8cd3cb9" class="i field">Upload</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
        <b>private static readonly string</b> <a id="1dd1eea3618587e9" href="R/1dd1eea3618587e9.html" target="n" data-glyph="46,1" class="i field">UrlTypeName</a> = <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#387da2c06bdd2661" class="i field">Url</a>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>();
 
        <b>private static readonly</b> <a href="@0@mscorlib/A.html#8b99c1f377873554" class="t t">Lazy</a>&lt;<a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<b>object</b>, <b>string</b>&gt;&gt; <a id="d27be26775257c54" href="R/d27be26775257c54.html" target="n" data-glyph="46,1" class="i field">_dataTypeToName</a> = <b>new</b> <a href="@0@mscorlib/A.html#a7924544277182a9" class="t constructor">Lazy</a>&lt;<a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<b>object</b>, <b>string</b>&gt;&gt;(<a href="#65e623f2f95049cd" class="i method">CreateDataTypeToName</a>, <span class="r0 r">isThreadSafe</span>: <b>true</b>);
 
        <span class="c">// This is a faster version of GetDataTypeName(). It internally calls ToString() on the enum</span>
        <span class="c">// value, which can be quite slow because of value verification.</span>
        <b>internal static string</b> <a id="3d6554303415a3de" href="R/3d6554303415a3de.html" target="n" data-glyph="221,1" class="i method">ToDataTypeName</a>(<b>this</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#c3a0957894bdc158" class="t t">DataTypeAttribute</a> <span id="r1 rd" class="r1 r">attribute</span>, <a href="@0@mscorlib/A.html#7a86aba051da82dd" class="t t">Func</a>&lt;<a href="@0@System.ComponentModel.DataAnnotations/A.html#c3a0957894bdc158" class="t t">DataTypeAttribute</a>, <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="t t">Boolean</a>&gt; <span id="r2 rd" class="r2 r">isDataType</span> = <b>null</b>)
        {
            <b>if</b> (<span class="r2 r">isDataType</span> == <b>null</b>)
            {
                <span class="r2 r">isDataType</span> = <span id="r3 rd" class="r3 r">t</span> =&gt; <span class="r3 r">t</span>.<a href="@0@mscorlib/A.html#4d73eb225aef8a61" class="i method">GetType</a>().<a href="@0@mscorlib/A.html#6ad282f6c8736636" class="i method">Equals</a>(<b>typeof</b>(<a href="@0@System.ComponentModel.DataAnnotations/A.html#c3a0957894bdc158" class="t t">DataTypeAttribute</a>));
            }
 
            <span class="c">// GetDataTypeName is virtual, so this is only safe if they haven&#39;t derived from DataTypeAttribute.</span>
            <span class="c">// However, if they derive from DataTypeAttribute, they can help their own perf by overriding GetDataTypeName</span>
            <span class="c">// and returning an appropriate string without invoking the ToString() on the enum.</span>
            <b>if</b> (<span class="r2 r">isDataType</span>(<span class="r1 r">attribute</span>))
            {
                <span class="c">// Statically known dataTypes are handled separately for performance</span>
                <b>string</b> <span id="r4 rd" class="r4 r">name</span> = <a href="#75bbd80bca4e25ed" class="i method">KnownDataTypeToString</a>(<span class="r1 r">attribute</span>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#aa4a8df84cd249b1" class="i property">DataType</a>);
                <b>if</b> (<span class="r4 r">name</span> == <b>null</b>)
                {
                    <span class="c">// Unknown types fallback to a dictionary lookup.</span>
                    <span class="c">// Code running on .NET 4.5 will not enter this code for statically known data types.</span>
                    <span class="c">// Versions of .NET greater than 4.5 will enter this code for any new data types added to those frameworks</span>
                    <a href="#d27be26775257c54" class="i field">_dataTypeToName</a>.<a href="@0@mscorlib/A.html#606a17645b0dc0ff" class="i property">Value</a>.<a href="@0@mscorlib/A.html#2e5bc6d8c0f21e67" class="i method">TryGetValue</a>(<span class="r1 r">attribute</span>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#aa4a8df84cd249b1" class="i property">DataType</a>, <b>out</b> <span class="r4 r">name</span>);
                }
 
                <b>if</b> (<span class="r4 r">name</span> != <b>null</b>)
                {
                    <b>return</b> <span class="r4 r">name</span>;
                }
            }
 
            <b>return</b> <span class="r1 r">attribute</span>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#4536a85ab662c27a" class="i method">GetDataTypeName</a>();
        }
 
        <b>private static string</b> <a id="75bbd80bca4e25ed" href="R/75bbd80bca4e25ed.html" target="n" data-glyph="76,1" class="i method">KnownDataTypeToString</a>(<a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a> <span id="r5 rd" class="r5 r">dataType</span>)
        {
            <b>switch</b> (<span class="r5 r">dataType</span>)
            {
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#4ba06122f4b88692" class="i field">CreditCard</a>:
                    <b>return</b> <a href="#e024263237119ba1" class="i field">CreditCardTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#24a2450d8b5086de" class="i field">Currency</a>:
                    <b>return</b> <a href="#0e6b83cbe9623018" class="i field">CurrencyTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#fd9d12dd217da419" class="i field">Date</a>:
                    <b>return</b> <a href="#ad8d6cc1b4970732" class="i field">DateTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#8f46f71df3fdd95d" class="i field">DateTime</a>:
                    <b>return</b> <a href="#6bd9f91d229cdb54" class="i field">DateTimeTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#e418db2a443cb514" class="i field">Duration</a>:
                    <b>return</b> <a href="#8b8565d2e0dc2483" class="i field">DurationTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#6b612cca43801415" class="i field">EmailAddress</a>:
                    <b>return</b> <a href="#6e153da4836c2bcd" class="i field">EmailAddressTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#559c86947539ce24" class="i field">Html</a>:
                    <b>return</b> <a href="#3306a42117d4720e" class="i field">HtmlTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#f803fca129dfab10" class="i field">ImageUrl</a>:
                    <b>return</b> <a href="#77d69afb33b5f0a1" class="i field">ImageUrlTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#eb2d12397cc0bc3b" class="i field">MultilineText</a>:
                    <b>return</b> <a href="#cf73460d7bc2e4f7" class="i field">MultiLineTextTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#ef077846aa93a8a0" class="i field">Password</a>:
                    <b>return</b> <a href="#d06c88b739f217bf" class="i field">PasswordTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#67d39a90f0b1497c" class="i field">PhoneNumber</a>:
                    <b>return</b> <a href="#696f14254930a79f" class="i field">PhoneNumberTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#d37cd7fd6e41f079" class="i field">PostalCode</a>:
                    <b>return</b> <a href="#d85c46a5b784e527" class="i field">PostalCodeTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#cf46f40bcf3f5a97" class="i field">Text</a>:
                    <b>return</b> <a href="#38e876ae1e760737" class="i field">TextTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#e55336cb6e484d1c" class="i field">Time</a>:
                    <b>return</b> <a href="#545ef41a2f3fef82" class="i field">TimeTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#76a24977b8cd3cb9" class="i field">Upload</a>:
                    <b>return</b> <a href="#1db5420831166efd" class="i field">UploadTypeName</a>;
                <b>case</b> <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#387da2c06bdd2661" class="i field">Url</a>:
                    <b>return</b> <a href="#1dd1eea3618587e9" class="i field">UrlTypeName</a>;
            }
 
            <b>return null</b>;
        }
 
        <b>private static</b> <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<b>object</b>, <b>string</b>&gt; <a id="65e623f2f95049cd" href="R/65e623f2f95049cd.html" target="n" data-glyph="76,1" class="i method">CreateDataTypeToName</a>()
        {
            <a href="@0@mscorlib/A.html#d3599058f8d79be0" class="t t">Dictionary</a>&lt;<b>object</b>, <b>string</b>&gt; <span id="r6 rd" class="r6 r">dataTypeToName</span> = <b>new</b> <a href="@0@mscorlib/A.html#bf6849e410b43c4c" class="t constructor">Dictionary</a>&lt;<b>object</b>, <b>string</b>&gt;();
            <b>foreach</b> (<a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a> <span id="r7 rd" class="r7 r">dataTypeValue</span> <b>in</b> <a href="@0@mscorlib/A.html#36729210e317a805" class="t t">Enum</a>.<a href="@0@mscorlib/A.html#20fa909ef3233d20" class="i method">GetValues</a>(<b>typeof</b>(<a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>)))
            {
                <span class="c">// Don&#39;t add to the dictionary any of the statically known types.</span>
                <span class="c">// This is a workingset size optimization.</span>
                <b>if</b> (<span class="r7 r">dataTypeValue</span> != <a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>.<a href="@0@System.ComponentModel.DataAnnotations/A.html#7f7c74f266e16f99" class="i field">Custom</a> &amp;&amp; <a href="#75bbd80bca4e25ed" class="i method">KnownDataTypeToString</a>(<span class="r7 r">dataTypeValue</span>) == <b>null</b>)
                {
                    <b>string</b> <span id="r8 rd" class="r8 r">name</span> = <a href="@0@mscorlib/A.html#36729210e317a805" class="t t">Enum</a>.<a href="@0@mscorlib/A.html#786e8dea19d39347" class="i method">GetName</a>(<b>typeof</b>(<a href="@0@System.ComponentModel.DataAnnotations/A.html#59d004f6e5fe3a75" class="t t">DataType</a>), <span class="r7 r">dataTypeValue</span>);
                    <span class="r6 r">dataTypeToName</span><a href="@0@mscorlib/A.html#49962975508e2d83">[</a><span class="r7 r">dataTypeValue</span>] = <span class="r8 r">name</span>;
                }
            }
 
            <b>return</b> <span class="r6 r">dataTypeToName</span>;
        }
    }
}
</pre></td></tr></table></div></body></html>
