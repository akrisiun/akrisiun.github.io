<!DOCTYPE html>
<html><head><title>RawText.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(348);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#NGit/NGit.Diff/RawText.cs" target="_top">NGit.Diff\RawText.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#NGit" target="_top">lib\NGit\NGit\NGit.csproj</a> (NGit)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">/*
This code is derived from jgit (http://eclipse.org/jgit).
Copyright owners are documented in jgit&#39;s IP log.

This program and the accompanying materials are made available
under the terms of the Eclipse Distribution License v1.0 which
accompanies this distribution, is reproduced below, and is
available at http://www.eclipse.org/org/documents/edl-v10.php

All rights reserved.

Redistribution and use in source and binary forms, with or
without modification, are permitted provided that the following
conditions are met:

- Redistributions of source code must retain the above copyright
  notice, this list of conditions and the following disclaimer.

- Redistributions in binary form must reproduce the above
  copyright notice, this list of conditions and the following
  disclaimer in the documentation and/or other materials provided
  with the distribution.

- Neither the name of the Eclipse Foundation, Inc. nor the
  names of its contributors may be used to endorse or promote
  products derived from this software without specific prior
  written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND
CONTRIBUTORS &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR
CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/</span>

<b>using</b> <span class="i n">NGit</span>.<span class="i n">Diff</span>;
<b>using</b> <span class="i n">NGit</span>.<span class="i n">Util</span>;
<b>using</b> <span class="i n">Sharpen</span>;

<b>namespace</b> <span class="i n">NGit</span>.<span class="i n">Diff</span>
{
	<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">A Sequence supporting UNIX formatted text in byte[] format.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
	<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
	<span class="c">///</span><span class="c"> A Sequence supporting UNIX formatted text in byte[] format.</span>
	<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
	<span class="c">///</span><span class="c"> Elements of the sequence are the lines of the file, as delimited by the UNIX</span>
	<span class="c">///</span><span class="c"> newline character (&#39;\n&#39;). The file content is treated as 8 bit binary text,</span>
	<span class="c">///</span><span class="c"> with no assumptions or requirements on character encoding.</span>
	<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
	<span class="c">///</span><span class="c"> Note that the first line of the file is element 0, as defined by the Sequence</span>
	<span class="c">///</span><span class="c"> interface API. Traditionally in a text editor a patch file the first line is</span>
	<span class="c">///</span><span class="c"> line number 1. Callers may need to subtract 1 prior to invoking methods if</span>
	<span class="c">///</span><span class="c"> they are converting from &quot;line number&quot; to &quot;element index&quot;.</span>
	<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
	<b>public class</b> <a id="beb2363b4b9c8c5f" href="../R/beb2363b4b9c8c5f.html" target="n" data-glyph="0,0" class="t t">RawText</a> : <a href="Sequence.cs.html#00c47a4b39d65421" class="t t">Sequence</a>
	{
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">A Rawtext of length 0</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>public static readonly</b> <span class="i n">NGit</span>.<span class="i n">Diff</span>.<a href="#beb2363b4b9c8c5f" class="t t">RawText</a> <a id="a27e7f32e303a1b5" href="../R/a27e7f32e303a1b5.html" target="n" data-glyph="42,1" class="i field">EMPTY_TEXT</a> = <b>new</b> <span class="i n">NGit</span>.<span class="i n">Diff</span>.<a href="#5e490027f5de8fe5" class="t constructor">RawText</a>(<b>new</b> <b>byte</b>
			[0]);

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Number of bytes to check for heuristics in</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#81acca20727f9b1e" class="i method">IsBinary</a>(<b>byte</b>[])<span class="c">&quot;</span><span class="c">&gt;</span><span class="c">IsBinary(byte[])</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>private const int</b> <a id="8a92b14335cbcc50" href="../R/8a92b14335cbcc50.html" target="n" data-glyph="10,1" class="i field">FIRST_FEW_BYTES</a> = 8000;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">The file content for this sequence.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">The file content for this sequence.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<b>protected internal readonly byte</b>[] <a id="71f3680bcc91eeed" href="../R/71f3680bcc91eeed.html" target="n" data-glyph="45,1" class="i field">content</a>;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Map of line number to starting position within</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">see</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><a href="#71f3680bcc91eeed" class="i field">content</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">content</span><span class="c">&lt;/</span><span class="c">see</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> .</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<b>protected internal readonly</b> <a href="../NGit.Util/IntList.cs.html#290b0080ed2bb69b" class="t t">IntList</a> <a id="ffd81610b8121f32" href="../R/ffd81610b8121f32.html" target="n" data-glyph="45,1" class="i field">lines</a>;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Create a new sequence from an existing content byte array.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Create a new sequence from an existing content byte array.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> The entire array (indexes 0 through length-1) is used as the content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r0 r">input</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> the content array. The array is never modified, so passing</span>
		<span class="c">///</span><span class="c"> through cached arrays is safe.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<b>public</b> <a id="5e490027f5de8fe5" href="../R/5e490027f5de8fe5.html" target="n" data-glyph="72,1" class="i constructor">RawText</a>(<b>byte</b>[] <span id="r0 rd" class="r0 r">input</span>)
		{
			<a href="#71f3680bcc91eeed" class="i field">content</a> = <span class="r0 r">input</span>;
			<a href="#ffd81610b8121f32" class="i field">lines</a> = <a href="../NGit.Util/RawParseUtils.cs.html#f87abe4d24b03b12" class="t t">RawParseUtils</a>.<a href="../NGit.Util/RawParseUtils.cs.html#263d22cca6fbeacc" class="i method">LineMap</a>(<a href="#71f3680bcc91eeed" class="i field">content</a>, 0, <a href="#71f3680bcc91eeed" class="i field">content</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Create a new sequence from a file.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Create a new sequence from a file.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> The entire file contents are used.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r1 r">file</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the text file.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#bf546e435199e83c" class="t t">IOException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if Exceptions occur while reading the file</span>
		<span class="c">///</span><span class="c"> 	</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public</b> <a id="5d95415dae748675" href="../R/5d95415dae748675.html" target="n" data-glyph="72,1" class="i constructor">RawText</a>(<a href="/Sharpen/A.html#576a1e6f183e15dd" class="t t">FilePath</a> <span id="r1 rd" class="r1 r">file</span>) : <a href="#5e490027f5de8fe5" class="k">this</a>(<a href="../NGit.Util/IOUtil.cs.html#d5aa4ac4db64211b" class="t t">IOUtil</a>.<a href="../NGit.Util/IOUtil.cs.html#cc1b739e85e7e2a4" class="i method">ReadFully</a>(<span class="r1 r">file</span>))
		{
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">total number of items in the sequence.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public override int</b> <a id="2a97005ebe12610e" href="../R/2a97005ebe12610e.html" target="n" data-glyph="72,1" class="i method">Size</a>()
		{
			<span class="c">// The line map is always 2 entries larger than the number of lines in</span>
			<span class="c">// the file. Index 0 is padded out/unused. The last index is the total</span>
			<span class="c">// length of the buffer, and acts as a sentinel.</span>
			<span class="c">//</span>
			<b>return</b> <a href="#ffd81610b8121f32" class="i field">lines</a>.<a href="../NGit.Util/IntList.cs.html#03a05a0c1777ac61" class="i method">Size</a>() - 2;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Write a specific line to the output stream, without its trailing LF.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Write a specific line to the output stream, without its trailing LF.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> The specified line is copied as-is, with no character encoding</span>
		<span class="c">///</span><span class="c"> translation performed.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">p</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> If the specified line ends with an LF (&#39;\n&#39;), the LF is </span><span class="c">&lt;</span><span class="c">b</span><span class="c">&gt;</span><span class="c">not</span><span class="c">&lt;/</span><span class="c">b</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> copied. It is up to the caller to write the LF, if desired, between</span>
		<span class="c">///</span><span class="c"> output lines.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r2 r">out</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">stream to copy the line data onto.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r3 r">i</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> index of the line to extract. Note this is 0-based, so line</span>
		<span class="c">///</span><span class="c"> number 1 is actually index 0.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#bf546e435199e83c" class="t t">IOException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the stream write operation failed.</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="4573cd8915a70379" href="../R/4573cd8915a70379.html" target="n" data-glyph="72,1" class="i method">WriteLine</a>(<a href="/Sharpen/A.html#f960ef5651b4ede1" class="t t">OutputStream</a> <span id="r2 rd" class="r2 r">@out</span>, <b>int</b> <span id="r3 rd" class="r3 r">i</span>)
		{
			<b>int</b> <span id="r4 rd" class="r4 r">start</span> = <a href="#153a304deace470b" class="i method">GetStart</a>(<span class="r3 r">i</span>);
			<b>int</b> <span id="r5 rd" class="r5 r">end</span> = <a href="#60808c809ec84cc3" class="i method">GetEnd</a>(<span class="r3 r">i</span>);
			<b>if</b> (<a href="#71f3680bcc91eeed" class="i field">content</a>[<span class="r5 r">end</span> - 1] == <span class="s">&#39;\n&#39;</span>)
			{
				<span class="r5 r">end</span>--;
			}
			<span class="r2 r">@out</span>.<a href="/Sharpen/A.html#54b79431ffc12110" class="i method">Write</a>(<a href="#71f3680bcc91eeed" class="i field">content</a>, <span class="r4 r">start</span>, <span class="r5 r">end</span> - <span class="r4 r">start</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Determine if the file ends with a LF (&#39;\n&#39;).</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Determine if the file ends with a LF (&#39;\n&#39;).</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">true if the last line has an LF; false otherwise.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public virtual bool</b> <a id="48106a0f99ce3adc" href="../R/48106a0f99ce3adc.html" target="n" data-glyph="72,1" class="i method">IsMissingNewlineAtEnd</a>()
		{
			<b>int</b> <span id="r6 rd" class="r6 r">end</span> = <a href="#ffd81610b8121f32" class="i field">lines</a>.<a href="../NGit.Util/IntList.cs.html#e468ae0d52264541" class="i method">Get</a>(<a href="#ffd81610b8121f32" class="i field">lines</a>.<a href="../NGit.Util/IntList.cs.html#03a05a0c1777ac61" class="i method">Size</a>() - 1);
			<b>if</b> (<span class="r6 r">end</span> == 0)
			{
				<b>return true</b>;
			}
			<b>return</b> <a href="#71f3680bcc91eeed" class="i field">content</a>[<span class="r6 r">end</span> - 1] != <span class="s">&#39;\n&#39;</span>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Get the text for a single line.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Get the text for a single line.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r7 r">i</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> index of the line to extract. Note this is 0-based, so line</span>
		<span class="c">///</span><span class="c"> number 1 is actually index 0.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">the text for the line, without a trailing LF.</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public virtual string</b> <a id="5bae9d6d0cb738f8" href="../R/5bae9d6d0cb738f8.html" target="n" data-glyph="72,1" class="i method">GetString</a>(<b>int</b> <span id="r7 rd" class="r7 r">i</span>)
		{
			<b>return</b> <a href="#cf831306aa6c2407" class="i method">GetString</a>(<span class="r7 r">i</span>, <span class="r7 r">i</span> + 1, <b>true</b>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Get the text for a region of lines.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Get the text for a region of lines.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r8 r">begin</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> index of the first line to extract. Note this is 0-based, so</span>
		<span class="c">///</span><span class="c"> line number 1 is actually index 0.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r9 r">end</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">index of one past the last line to extract.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r10 r">dropLF</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> if true the trailing LF (&#39;\n&#39;) of the last returned line is</span>
		<span class="c">///</span><span class="c"> dropped, if present.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> the text for lines</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">[begin, end)</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> .</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public virtual string</b> <a id="cf831306aa6c2407" href="../R/cf831306aa6c2407.html" target="n" data-glyph="72,1" class="i method">GetString</a>(<b>int</b> <span id="r8 rd" class="r8 r">begin</span>, <b>int</b> <span id="r9 rd" class="r9 r">end</span>, <b>bool</b> <span id="r10 rd" class="r10 r">dropLF</span>)
		{
			<b>if</b> (<span class="r8 r">begin</span> == <span class="r9 r">end</span>)
			{
				<b>return string</b>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
			}
			<b>int</b> <span id="r11 rd" class="r11 r">s</span> = <a href="#153a304deace470b" class="i method">GetStart</a>(<span class="r8 r">begin</span>);
			<b>int</b> <span id="r12 rd" class="r12 r">e</span> = <a href="#60808c809ec84cc3" class="i method">GetEnd</a>(<span class="r9 r">end</span> - 1);
			<b>if</b> (<span class="r10 r">dropLF</span> &amp;&amp; <a href="#71f3680bcc91eeed" class="i field">content</a>[<span class="r12 r">e</span> - 1] == <span class="s">&#39;\n&#39;</span>)
			{
				<span class="r12 r">e</span>--;
			}
			<b>return</b> <a href="#e98f78d4c4c1c68e" class="i method">Decode</a>(<span class="r11 r">s</span>, <span class="r12 r">e</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Decode a region of the text into a String.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Decode a region of the text into a String.</span>
		<span class="c">///</span><span class="c"> The default implementation of this method tries to guess the character</span>
		<span class="c">///</span><span class="c"> set by considering UTF-8, the platform default, and falling back on</span>
		<span class="c">///</span><span class="c"> ISO-8859-1 if neither of those can correctly decode the region given.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r13 r">start</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">first byte of the content to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r14 r">end</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">one past the last byte of the content to decode.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> the region</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">[start, end)</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> decoded as a String.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>protected internal virtual string</b> <a id="e98f78d4c4c1c68e" href="../R/e98f78d4c4c1c68e.html" target="n" data-glyph="75,1" class="i method">Decode</a>(<b>int</b> <span id="r13 rd" class="r13 r">start</span>, <b>int</b> <span id="r14 rd" class="r14 r">end</span>)
		{
			<b>return</b> <a href="../NGit.Util/RawParseUtils.cs.html#f87abe4d24b03b12" class="t t">RawParseUtils</a>.<a href="../NGit.Util/RawParseUtils.cs.html#c23f18f826e9513e" class="i method">Decode</a>(<a href="#71f3680bcc91eeed" class="i field">content</a>, <span class="r13 r">start</span>, <span class="r14 r">end</span>);
		}

		<b>private int</b> <a id="153a304deace470b" href="../R/153a304deace470b.html" target="n" data-glyph="76,1" class="i method">GetStart</a>(<b>int</b> <span id="r15 rd" class="r15 r">i</span>)
		{
			<b>return</b> <a href="#ffd81610b8121f32" class="i field">lines</a>.<a href="../NGit.Util/IntList.cs.html#e468ae0d52264541" class="i method">Get</a>(<span class="r15 r">i</span> + 1);
		}

		<b>private int</b> <a id="60808c809ec84cc3" href="../R/60808c809ec84cc3.html" target="n" data-glyph="76,1" class="i method">GetEnd</a>(<b>int</b> <span id="r16 rd" class="r16 r">i</span>)
		{
			<b>return</b> <a href="#ffd81610b8121f32" class="i field">lines</a>.<a href="../NGit.Util/IntList.cs.html#e468ae0d52264541" class="i method">Get</a>(<span class="r16 r">i</span> + 2);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether a byte array represents binary (as</span>
		<span class="c">///</span><span class="c"> opposed to text) content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether a byte array represents binary (as</span>
		<span class="c">///</span><span class="c"> opposed to text) content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r17 r">raw</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the raw file content.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">true if raw is likely to be a binary file, false otherwise</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public static bool</b> <a id="81acca20727f9b1e" href="../R/81acca20727f9b1e.html" target="n" data-glyph="72,1" class="i method">IsBinary</a>(<b>byte</b>[] <span id="r17 rd" class="r17 r">raw</span>)
		{
			<b>return</b> <a href="#b4a618b879af223b" class="i method">IsBinary</a>(<span class="r17 r">raw</span>, <span class="r17 r">raw</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether the bytes contained in a stream</span>
		<span class="c">///</span><span class="c"> represents binary (as opposed to text) content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether the bytes contained in a stream</span>
		<span class="c">///</span><span class="c"> represents binary (as opposed to text) content.</span>
		<span class="c">///</span><span class="c"> Note: Do not further use this stream after having called this method! The</span>
		<span class="c">///</span><span class="c"> stream may not be fully read and will be left at an unknown position</span>
		<span class="c">///</span><span class="c"> after consuming an unknown number of bytes. The caller is responsible for</span>
		<span class="c">///</span><span class="c"> closing the stream.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r18 r">raw</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">input stream containing the raw file content.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">true if raw is likely to be a binary file, false otherwise</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#bf546e435199e83c" class="t t">IOException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">if input stream could not be read</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public static bool</b> <a id="20b97a45a41a8351" href="../R/20b97a45a41a8351.html" target="n" data-glyph="72,1" class="i method">IsBinary</a>(<a href="/Sharpen/A.html#5fe75b93f596f64a" class="t t">InputStream</a> <span id="r18 rd" class="r18 r">raw</span>)
		{
			<b>byte</b>[] <span id="r19 rd" class="r19 r">buffer</span> = <b>new</b> <b>byte</b>[<a href="#8a92b14335cbcc50" class="i field">FIRST_FEW_BYTES</a>];
			<b>int</b> <span id="r20 rd" class="r20 r">cnt</span> = 0;
			<b>while</b> (<span class="r20 r">cnt</span> &lt; <span class="r19 r">buffer</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
			{
				<b>int</b> <span id="r21 rd" class="r21 r">n</span> = <span class="r18 r">raw</span>.<a href="/Sharpen/A.html#aed09ce58860ccfe" class="i method">Read</a>(<span class="r19 r">buffer</span>, <span class="r20 r">cnt</span>, <span class="r19 r">buffer</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - <span class="r20 r">cnt</span>);
				<b>if</b> (<span class="r21 r">n</span> == -1)
				{
					<b>break</b>;
				}
				<span class="r20 r">cnt</span> += <span class="r21 r">n</span>;
			}
			<b>return</b> <a href="#b4a618b879af223b" class="i method">IsBinary</a>(<span class="r19 r">buffer</span>, <span class="r20 r">cnt</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether a byte array represents binary (as</span>
		<span class="c">///</span><span class="c"> opposed to text) content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> Determine heuristically whether a byte array represents binary (as</span>
		<span class="c">///</span><span class="c"> opposed to text) content.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r22 r">raw</span><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">the raw file content.</span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">param</span><span class="c"> </span><span class="c">name</span><span class="c">=</span><span class="c">&quot;</span><span class="r23 r">length</span><span class="c">&quot;</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> number of bytes in</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">raw</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> to evaluate. This should be</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">raw.length</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> unless</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">raw</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> was over-allocated by</span>
		<span class="c">///</span><span class="c"> the caller.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;/</span><span class="c">param</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">true if raw is likely to be a binary file, false otherwise</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public static bool</b> <a id="b4a618b879af223b" href="../R/b4a618b879af223b.html" target="n" data-glyph="72,1" class="i method">IsBinary</a>(<b>byte</b>[] <span id="r22 rd" class="r22 r">raw</span>, <b>int</b> <span id="r23 rd" class="r23 r">length</span>)
		{
			<span class="c">// Same heuristic as C Git</span>
			<b>if</b> (<span class="r23 r">length</span> &gt; <a href="#8a92b14335cbcc50" class="i field">FIRST_FEW_BYTES</a>)
			{
				<span class="r23 r">length</span> = <a href="#8a92b14335cbcc50" class="i field">FIRST_FEW_BYTES</a>;
			}
			<b>for</b> (<b>int</b> <span id="r24 rd" class="r24 r">ptr</span> = 0; <span class="r24 r">ptr</span> &lt; <span class="r23 r">length</span>; <span class="r24 r">ptr</span>++)
			{
				<b>if</b> (<span class="r22 r">raw</span>[<span class="r24 r">ptr</span>] == <span class="s">&#39;\0&#39;</span>)
				{
					<b>return true</b>;
				}
			}
			<b>return false</b>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">summary</span><span class="c">&gt;</span><span class="c">Get the line delimiter for the first line.</span><span class="c">&lt;/</span><span class="c">summary</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">remarks</span><span class="c">&gt;</span><span class="c">Get the line delimiter for the first line.</span><span class="c">&lt;/</span><span class="c">remarks</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">since</span><span class="c">&gt;</span><span class="c">2.0</span><span class="c">&lt;/</span><span class="c">since</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">returns</span><span class="c">&gt;</span><span class="c">the line delimiter or </span><span class="c">&lt;</span><span class="c">code</span><span class="c">&gt;</span><span class="c">null</span><span class="c">&lt;/</span><span class="c">code</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">returns</span><span class="c">&gt;</span>
		<b>public virtual string</b> <a id="050779238a5efe52" href="../R/050779238a5efe52.html" target="n" data-glyph="72,1" class="i method">GetLineDelimiter</a>()
		{
			<b>if</b> (<a href="#2a97005ebe12610e" class="i method">Size</a>() == 0)
			{
				<b>return null</b>;
			}
			<b>int</b> <span id="r25 rd" class="r25 r">e</span> = <a href="#60808c809ec84cc3" class="i method">GetEnd</a>(0);
			<b>if</b> (<a href="#71f3680bcc91eeed" class="i field">content</a>[<span class="r25 r">e</span> - 1] != <span class="s">&#39;\n&#39;</span>)
			{
				<b>return null</b>;
			}
			<b>if</b> (<a href="#71f3680bcc91eeed" class="i field">content</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 1 &amp;&amp; <a href="#71f3680bcc91eeed" class="i field">content</a>[<span class="r25 r">e</span> - 2] == <span class="s">&#39;\r&#39;</span>)
			{
				<b>return</b> <span class="s">&quot;\r\n&quot;</span>;
			}
			<b>else</b>
			{
				<b>return</b> <span class="s">&quot;\n&quot;</span>;
			}
		}
	}
}
</pre></td></tr></table></div></body></html>
