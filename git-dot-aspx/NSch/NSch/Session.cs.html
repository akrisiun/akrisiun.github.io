<!DOCTYPE html>
<html><head><title>Session.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(2564);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#NSch/NSch/Session.cs" target="_top">NSch\Session.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#NSch" target="_top">lib\NGit\NSch\NSch.csproj</a> (NSch)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">/*
Copyright (c) 2006-2010 ymnk, JCraft,Inc. All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

  1. Redistributions of source code must retain the above copyright notice,
     this list of conditions and the following disclaimer.

  2. Redistributions in binary form must reproduce the above copyright 
     notice, this list of conditions and the following disclaimer in 
     the documentation and/or other materials provided with the distribution.

  3. The names of the authors may not be used to endorse or promote products
     derived from this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED ``AS IS&#39;&#39; AND ANY EXPRESSED OR IMPLIED WARRANTIES,
INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL JCRAFT,
INC. OR ANY CONTRIBUTORS TO THIS SOFTWARE BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA,
OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This code is based on jsch (http://www.jcraft.com/jsch).
All credit should go to the authors of jsch.
*/</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">IO</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Net</span>.<span class="i n">Sockets</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">NSch</span>;
<b>using</b> <span class="i n">Sharpen</span>;

<b>namespace</b> <span class="i n">NSch</span>
{
	<b>public class</b> <a id="9447883c1d8c7b7f" href="../R/9447883c1d8c7b7f.html" target="n" data-glyph="0,0" class="t t">Session</a> : <a href="/Sharpen/A.html#f045ac791f6c522f" class="t t">Runnable</a>
	{
		<b>internal const int</b> <a id="6901129ba842857e" href="../R/6901129ba842857e.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_DISCONNECT</a> = 1;

		<b>internal const int</b> <a id="8556f5a2c6fd264b" href="../R/8556f5a2c6fd264b.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_IGNORE</a> = 2;

		<b>internal const int</b> <a id="11f5be3bdb161271" href="../R/11f5be3bdb161271.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_UNIMPLEMENTED</a> = 3;

		<b>internal const int</b> <a id="04c90d6a81fa80a0" href="../R/04c90d6a81fa80a0.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_DEBUG</a> = 4;

		<b>internal const int</b> <a id="ab6e24e1c05dfc7c" href="../R/ab6e24e1c05dfc7c.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_SERVICE_REQUEST</a> = 5;

		<b>internal const int</b> <a id="23b747452310f043" href="../R/../../0000000000.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_SERVICE_ACCEPT</a> = 6;

		<b>internal const int</b> <a id="fa37ec3e1195635d" href="../R/fa37ec3e1195635d.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEXINIT</a> = 20;

		<b>internal const int</b> <a id="a99d5a0391eb6ca0" href="../R/a99d5a0391eb6ca0.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_NEWKEYS</a> = 21;

		<b>internal const int</b> <a id="caf8ece498631a0d" href="../R/caf8ece498631a0d.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEXDH_INIT</a> = 30;

		<b>internal const int</b> <a id="70c92e5da4273c52" href="../R/70c92e5da4273c52.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEXDH_REPLY</a> = 31;

		<b>internal const int</b> <a id="62aeb34449888918" href="../R/62aeb34449888918.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEX_DH_GEX_GROUP</a> = 31;

		<b>internal const int</b> <a id="e6757fb3e16628fa" href="../R/e6757fb3e16628fa.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEX_DH_GEX_INIT</a> = 32;

		<b>internal const int</b> <a id="066b63fc2e9684d0" href="../R/066b63fc2e9684d0.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEX_DH_GEX_REPLY</a> = 33;

		<b>internal const int</b> <a id="d27d3eff48daf8a3" href="../R/d27d3eff48daf8a3.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_KEX_DH_GEX_REQUEST</a> = 34;

		<b>internal const int</b> <a id="e60fbcd8d67e6cce" href="../R/e60fbcd8d67e6cce.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_GLOBAL_REQUEST</a> = 80;

		<b>internal const int</b> <a id="c30a99e324371501" href="../R/c30a99e324371501.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_REQUEST_SUCCESS</a> = 81;

		<b>internal const int</b> <a id="6eca13ed50306ce7" href="../R/6eca13ed50306ce7.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_REQUEST_FAILURE</a> = 82;

		<b>internal const int</b> <a id="7cbf2ebd62ea45c4" href="../R/7cbf2ebd62ea45c4.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_OPEN</a> = 90;

		<b>internal const int</b> <a id="d5fda4b550d17d09" href="../R/d5fda4b550d17d09.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_OPEN_CONFIRMATION</a> = 91;

		<b>internal const int</b> <a id="fc15ca34980d78bc" href="../R/fc15ca34980d78bc.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_OPEN_FAILURE</a> = 92;

		<b>internal const int</b> <a id="4a72a00f3da6f6e8" href="../R/4a72a00f3da6f6e8.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_WINDOW_ADJUST</a> = 93;

		<b>internal const int</b> <a id="7314fc463e9c39ed" href="../R/7314fc463e9c39ed.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_DATA</a> = 94;

		<b>internal const int</b> <a id="4fc0a1abd8711abd" href="../R/4fc0a1abd8711abd.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_EXTENDED_DATA</a> = 95;

		<b>internal const int</b> <a id="fd7ba2041841416e" href="../R/fd7ba2041841416e.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_EOF</a> = 96;

		<b>internal const int</b> <a id="ea58bdb49f16aae0" href="../R/ea58bdb49f16aae0.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_CLOSE</a> = 97;

		<b>internal const int</b> <a id="dac146671529e612" href="../R/dac146671529e612.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_REQUEST</a> = 98;

		<b>internal const int</b> <a id="549f0394eb0c9c0d" href="../R/549f0394eb0c9c0d.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_SUCCESS</a> = 99;

		<b>internal const int</b> <a id="e2fec3fa5a2534b9" href="../R/e2fec3fa5a2534b9.html" target="n" data-glyph="8,1" class="i field">SSH_MSG_CHANNEL_FAILURE</a> = 100;

		<b>private const int</b> <a id="827c2c290094450b" href="../R/827c2c290094450b.html" target="n" data-glyph="10,1" class="i field">PACKET_MAX_SIZE</a> = 256 * 1024;

		<b>private byte</b>[] <a id="89221780c105f245" href="../R/89221780c105f245.html" target="n" data-glyph="46,1" class="i field">V_S</a>;

		<b>private byte</b>[] <a id="295fb16f7829b6aa" href="../R/295fb16f7829b6aa.html" target="n" data-glyph="46,1" class="i field">V_C</a> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="s">&quot;SSH-2.0-JSCH-&quot;</span> + <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#44114ff937ba1eb4" class="i field">VERSION</a>);

		<b>private byte</b>[] <a id="1e6a830eb951c117" href="../R/1e6a830eb951c117.html" target="n" data-glyph="46,1" class="i field">I_C</a>;

		<b>private byte</b>[] <a id="c44ddf657067893d" href="../R/c44ddf657067893d.html" target="n" data-glyph="46,1" class="i field">I_S</a>;

		<b>private byte</b>[] <a id="1b647c5adf1e5a0e" href="../R/../../0000000000.html" target="n" data-glyph="46,1" class="i field">K_S</a>;

		<b>private byte</b>[] <a id="c5ca410c2658e737" href="../R/c5ca410c2658e737.html" target="n" data-glyph="46,1" class="i field">session_id</a>;

		<b>private byte</b>[] <a id="82851712d28e8cee" href="../R/82851712d28e8cee.html" target="n" data-glyph="46,1" class="i field">IVc2s</a>;

		<b>private byte</b>[] <a id="5b2badb120b43641" href="../R/5b2badb120b43641.html" target="n" data-glyph="46,1" class="i field">IVs2c</a>;

		<b>private byte</b>[] <a id="018c8f473dff058d" href="../R/018c8f473dff058d.html" target="n" data-glyph="46,1" class="i field">Ec2s</a>;

		<b>private byte</b>[] <a id="aca49bdfa4d33386" href="../R/aca49bdfa4d33386.html" target="n" data-glyph="46,1" class="i field">Es2c</a>;

		<b>private byte</b>[] <a id="6c3a65c9a5cdd6f2" href="../R/6c3a65c9a5cdd6f2.html" target="n" data-glyph="46,1" class="i field">MACc2s</a>;

		<b>private byte</b>[] <a id="481e41b555bfd531" href="../R/481e41b555bfd531.html" target="n" data-glyph="46,1" class="i field">MACs2c</a>;

		<b>private int</b> <a id="4f87f223bf75c532" href="../R/4f87f223bf75c532.html" target="n" data-glyph="46,1" class="i field">seqi</a> = 0;

		<b>private int</b> <a id="60f7215ff9f1e0be" href="../R/60f7215ff9f1e0be.html" target="n" data-glyph="46,1" class="i field">seqo</a> = 0;

		<b>internal string</b>[] <a id="c71d800be7c637d4" href="../R/c71d800be7c637d4.html" target="n" data-glyph="44,1" class="i field">guess</a> = <b>null</b>;

		<b>private</b> <span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a> <a id="b60669493962e185" href="../R/b60669493962e185.html" target="n" data-glyph="46,1" class="i field">s2ccipher</a>;

		<b>private</b> <span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a> <a id="5805a27d2b691225" href="../R/5805a27d2b691225.html" target="n" data-glyph="46,1" class="i field">c2scipher</a>;

		<b>private</b> <a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a> <a id="6267ce77b9c28218" href="../R/6267ce77b9c28218.html" target="n" data-glyph="46,1" class="i field">s2cmac</a>;

		<b>private</b> <a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a> <a id="1adab18fdf624dce" href="../R/1adab18fdf624dce.html" target="n" data-glyph="46,1" class="i field">c2smac</a>;

		<b>private byte</b>[] <a id="70eaa3cfc7fbc545" href="../R/70eaa3cfc7fbc545.html" target="n" data-glyph="46,1" class="i field">s2cmac_result1</a>;

		<b>private byte</b>[] <a id="c6ff516beefc50c1" href="../R/c6ff516beefc50c1.html" target="n" data-glyph="46,1" class="i field">s2cmac_result2</a>;

		<b>private</b> <a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a> <a id="fe62776ddd16a6bd" href="../R/fe62776ddd16a6bd.html" target="n" data-glyph="46,1" class="i field">deflater</a>;

		<b>private</b> <a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a> <a id="57cdef084060c615" href="../R/57cdef084060c615.html" target="n" data-glyph="46,1" class="i field">inflater</a>;

		<b>private</b> <a href="IO.cs.html#18d78866649b3d5a" class="t t">IO</a> <a id="c59740342aed7ca8" href="../R/c59740342aed7ca8.html" target="n" data-glyph="46,1" class="i field">io</a>;

		<b>private</b> <a href="@0@System/A.html#c84007a498b38b5f" class="t t">Socket</a> <a id="cecd2519df141327" href="../R/cecd2519df141327.html" target="n" data-glyph="46,1" class="i field">socket</a>;

		<b>private int</b> <a id="e5455bfe534c29f8" href="../R/e5455bfe534c29f8.html" target="n" data-glyph="46,1" class="i field">timeout</a> = 0;

		<b>private volatile bool</b> <a id="4abfa4fb08e3731c" href="../R/4abfa4fb08e3731c.html" target="n" data-glyph="46,1" class="i field">isConnected</a> = <b>false</b>;

		<b>private bool</b> <a id="9d201effb55c3143" href="../R/9d201effb55c3143.html" target="n" data-glyph="46,1" class="i field">isAuthed</a> = <b>false</b>;

		<b>private</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <a id="05db945f2e416c87" href="../R/05db945f2e416c87.html" target="n" data-glyph="46,1" class="i field">connectThread</a> = <b>null</b>;

		<b>private object</b> <a id="2dd88d5f8d13745d" href="../R/2dd88d5f8d13745d.html" target="n" data-glyph="46,1" class="i field">Lock</a> = <b>new</b> <b>object</b>();

		<b>internal bool</b> <a id="bab8f7829f2952d2" href="../R/bab8f7829f2952d2.html" target="n" data-glyph="44,1" class="i field">x11_forwarding</a> = <b>false</b>;

		<b>internal bool</b> <a id="1f7a40e5883b960b" href="../R/1f7a40e5883b960b.html" target="n" data-glyph="44,1" class="i field">agent_forwarding</a> = <b>false</b>;

		<b>internal</b> <a href="/Sharpen/A.html#5fe75b93f596f64a" class="t t">InputStream</a> <a id="3d3b0dccb6fc85a2" href="../R/3d3b0dccb6fc85a2.html" target="n" data-glyph="44,1" class="i field">@in</a> = <b>null</b>;

		<b>internal</b> <a href="/Sharpen/A.html#f960ef5651b4ede1" class="t t">OutputStream</a> <a id="5e82a45cb582c76e" href="../R/5e82a45cb582c76e.html" target="n" data-glyph="44,1" class="i field">@out</a> = <b>null</b>;

		<b>internal static</b> <a href="Random.cs.html#aa8a2288a3abd46c" class="t t">Random</a> <a id="c6706870ca880511" href="../R/c6706870ca880511.html" target="n" data-glyph="44,1" class="i field">random</a>;

		<b>internal</b> <a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <a id="c9533f8905ab0b0d" href="../R/c9533f8905ab0b0d.html" target="n" data-glyph="44,1" class="i field">buf</a>;

		<b>internal</b> <a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <a id="506c38da0761c8da" href="../R/506c38da0761c8da.html" target="n" data-glyph="44,1" class="i field">packet</a>;

		<b>internal</b> <a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a> <a id="334a62486322e43b" href="../R/334a62486322e43b.html" target="n" data-glyph="44,1" class="i field">socket_factory</a> = <b>null</b>;

		<b>internal const int</b> <a id="fda6851a4c5bd494" href="../R/fda6851a4c5bd494.html" target="n" data-glyph="8,1" class="i field">buffer_margin</a> = 32 + 20 + 32;

		<b>private</b> <a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <a id="6032927205ea9744" href="../R/6032927205ea9744.html" target="n" data-glyph="46,1" class="i field">config</a> = <b>null</b>;

		<b>private</b> <a href="Proxy.cs.html#b97f6805764d44c9" class="t t">Proxy</a> <a id="efa24b7b8a46acaa" href="../R/efa24b7b8a46acaa.html" target="n" data-glyph="46,1" class="i field">proxy</a> = <b>null</b>;

		<b>private</b> <a href="UserInfo.cs.html#6c4e07f23c6cc7bb" class="t t">UserInfo</a> <a id="db6703f509870e09" href="../R/db6703f509870e09.html" target="n" data-glyph="46,1" class="i field">userinfo</a>;

		<b>private string</b> <a id="274893d49d1a5973" href="../R/274893d49d1a5973.html" target="n" data-glyph="46,1" class="i field">hostKeyAlias</a> = <b>null</b>;

		<b>private int</b> <a id="b7a309548ec32022" href="../R/b7a309548ec32022.html" target="n" data-glyph="46,1" class="i field">serverAliveInterval</a> = 0;

		<b>private int</b> <a id="a7217574673ef3a2" href="../R/a7217574673ef3a2.html" target="n" data-glyph="46,1" class="i field">serverAliveCountMax</a> = 1;

		<b>protected internal bool</b> <a id="2cae7a45190c79cb" href="../R/2cae7a45190c79cb.html" target="n" data-glyph="45,1" class="i field">daemon_thread</a> = <b>false</b>;

		<b>private long</b> <a id="09138aef4c73af81" href="../R/09138aef4c73af81.html" target="n" data-glyph="46,1" class="i field">kex_start_time</a> = 0L;

		<b>internal int</b> <a id="1d4c324d003d5954" href="../R/1d4c324d003d5954.html" target="n" data-glyph="44,1" class="i field">max_auth_tries</a> = 6;

		<b>internal int</b> <a id="63e9794d17d59d6d" href="../R/63e9794d17d59d6d.html" target="n" data-glyph="44,1" class="i field">auth_failures</a> = 0;

		<b>internal string</b> <a id="1a2b75046ce43fcd" href="../R/1a2b75046ce43fcd.html" target="n" data-glyph="44,1" class="i field">host</a> = <span class="s">&quot;127.0.0.1&quot;</span>;

		<b>internal int</b> <a id="6e04a039d8ded1f9" href="../R/6e04a039d8ded1f9.html" target="n" data-glyph="44,1" class="i field">port</a> = 22;

		<b>internal string</b> <a id="2c060e318aeb0c5f" href="../R/2c060e318aeb0c5f.html" target="n" data-glyph="44,1" class="i field">username</a> = <b>null</b>;

		<b>internal byte</b>[] <a id="1facbe2f33793c2a" href="../R/1facbe2f33793c2a.html" target="n" data-glyph="44,1" class="i field">password</a> = <b>null</b>;

		<b>internal</b> <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a> <a id="3cb0c6825676d304" href="../R/3cb0c6825676d304.html" target="n" data-glyph="44,1" class="i field">jsch</a>;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>internal</b> <a id="ba61cdd0db400753" href="../R/ba61cdd0db400753.html" target="n" data-glyph="74,1" class="i constructor">Session</a>(<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a> <span id="r0 rd" class="r0 r">jsch</span>) : <a href="@0@mscorlib/A.html#38a0f6ea217e6f67" class="k">base</a>()
		{
			<a href="#ac8ee95adacf8a52" class="i field">grr</a> = <b>new</b> <a href="#9447883c1d8c7b7f" class="t t">Session</a>.<a href="#78a3bb7fa8e686be" class="t constructor">GlobalRequestReply</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
			<span class="c">// http://ietf.org/internet-drafts/draft-ietf-secsh-assignednumbers-01.txt</span>
			<span class="c">// server version</span>
			<span class="c">// client version</span>
			<span class="c">// the payload of the client&#39;s SSH_MSG_KEXINIT</span>
			<span class="c">// the payload of the server&#39;s SSH_MSG_KEXINIT</span>
			<span class="c">// the host key</span>
			<span class="c">//private byte[] mac_buf;</span>
			<span class="c">// maximum padding length</span>
			<span class="c">// maximum mac length</span>
			<span class="c">// margin for deflater; deflater may inflate data</span>
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#3cb0c6825676d304" class="i field">jsch</a> = <span class="r0 r">jsch</span>;
			<a href="#c9533f8905ab0b0d" class="i field">buf</a> = <b>new</b> <a href="Buffer.cs.html#35c62a99009984d5" class="t constructor">Buffer</a>();
			<a href="#506c38da0761c8da" class="i field">packet</a> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="505a27beb39d5a8f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Connect</a>()
		{
			<a href="#4716810d53f53914" class="i method">Connect</a>(<a href="#e5455bfe534c29f8" class="i field">timeout</a>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="4716810d53f53914" href="../R/4716810d53f53914.html" target="n" data-glyph="72,1" class="i method">Connect</a>(<b>int</b> <span id="r1 rd" class="r1 r">connectTimeout</span>)
		{
			<b>if</b> (<a href="#4abfa4fb08e3731c" class="i field">isConnected</a>)
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;session is already connected&quot;</span>);
			}
			<a href="#c59740342aed7ca8" class="i field">io</a> = <b>new</b> <a href="IO.cs.html#18d78866649b3d5a" class="t constructor">IO</a>();
			<b>if</b> (<a href="#c6706870ca880511" class="i field">random</a> == <b>null</b>)
			{
				<b>try</b>
				{
					<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r2 rd" class="r2 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;random&quot;</span>));
					<a href="#c6706870ca880511" class="i field">random</a> = (<a href="Random.cs.html#aa8a2288a3abd46c" class="t t">Random</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r2 r">c</span>));
				}
				<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r3 rd" class="r3 r">e</span>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r3 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r3 r">e</span>);
				}
			}
			<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a>.<a href="Packet.cs.html#262a662864c90ea2" class="i method">SetRandom</a>(<a href="#c6706870ca880511" class="i field">random</a>);
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Connecting to &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot; port &quot;</span> + <a href="#6e04a039d8ded1f9" class="i field">port</a>);
			}
			<b>try</b>
			{
				<b>int</b> <span id="r4 rd" class="r4 r">i</span>;
				<b>int</b> <span id="r5 rd" class="r5 r">j</span>;
				<b>if</b> (<a href="#efa24b7b8a46acaa" class="i field">proxy</a> == <b>null</b>)
				{
					<a href="/Sharpen/A.html#5fe75b93f596f64a" class="t t">InputStream</a> <span id="r6 rd" class="r6 r">@in</span>;
					<a href="/Sharpen/A.html#f960ef5651b4ede1" class="t t">OutputStream</a> <span id="r7 rd" class="r7 r">@out</span>;
					<b>if</b> (<a href="#334a62486322e43b" class="i field">socket_factory</a> == <b>null</b>)
					{
						<a href="#cecd2519df141327" class="i field">socket</a> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#f9ccb4ac55e1b038" class="i method">CreateSocket</a>(<a href="#1a2b75046ce43fcd" class="i field">host</a>, <a href="#6e04a039d8ded1f9" class="i field">port</a>, <span class="r1 r">connectTimeout</span>);
						<span class="r6 r">@in</span> = <a href="#cecd2519df141327" class="i field">socket</a>.<a href="/Sharpen/A.html#6176979eb33b386a" class="i method">GetInputStream</a>();
						<span class="r7 r">@out</span> = <a href="#cecd2519df141327" class="i field">socket</a>.<a href="/Sharpen/A.html#ed233a06e567bb6a" class="i method">GetOutputStream</a>();
					}
					<b>else</b>
					{
						<a href="#cecd2519df141327" class="i field">socket</a> = <a href="#334a62486322e43b" class="i field">socket_factory</a>.<a href="SocketFactory.cs.html#4df7f8221b3361a0" class="i method">CreateSocket</a>(<a href="#1a2b75046ce43fcd" class="i field">host</a>, <a href="#6e04a039d8ded1f9" class="i field">port</a>);
						<span class="r6 r">@in</span> = <a href="#334a62486322e43b" class="i field">socket_factory</a>.<a href="SocketFactory.cs.html#982cb48d06e7ff74" class="i method">GetInputStream</a>(<a href="#cecd2519df141327" class="i field">socket</a>);
						<span class="r7 r">@out</span> = <a href="#334a62486322e43b" class="i field">socket_factory</a>.<a href="SocketFactory.cs.html#37b8d6d4f3cda3aa" class="i method">GetOutputStream</a>(<a href="#cecd2519df141327" class="i field">socket</a>);
					}
					<span class="c">//if(timeout&gt;0){ socket.setSoTimeout(timeout); }</span>
					<a href="#cecd2519df141327" class="i field">socket</a>.<a href="@0@System/A.html#4fa5d510cc1dc1ec" class="i property">NoDelay</a> = <b>true</b>;
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#788b3d7714adf1a5" class="i method">SetInputStream</a>(<span class="r6 r">@in</span>);
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#1c1fd68cf9ab06a9" class="i method">SetOutputStream</a>(<span class="r7 r">@out</span>);
				}
				<b>else</b>
				{
					<b>lock</b> (<a href="#efa24b7b8a46acaa" class="i field">proxy</a>)
					{
						<a href="#efa24b7b8a46acaa" class="i field">proxy</a>.<a href="Proxy.cs.html#2b70d843b1795fbd" class="i method">Connect</a>(<a href="#334a62486322e43b" class="i field">socket_factory</a>, <a href="#1a2b75046ce43fcd" class="i field">host</a>, <a href="#6e04a039d8ded1f9" class="i field">port</a>, <span class="r1 r">connectTimeout</span>);
						<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#788b3d7714adf1a5" class="i method">SetInputStream</a>(<a href="#efa24b7b8a46acaa" class="i field">proxy</a>.<a href="Proxy.cs.html#886dcaf638d28da8" class="i method">GetInputStream</a>());
						<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#1c1fd68cf9ab06a9" class="i method">SetOutputStream</a>(<a href="#efa24b7b8a46acaa" class="i field">proxy</a>.<a href="Proxy.cs.html#68158fbdce310619" class="i method">GetOutputStream</a>());
						<a href="#cecd2519df141327" class="i field">socket</a> = <a href="#efa24b7b8a46acaa" class="i field">proxy</a>.<a href="Proxy.cs.html#7d916a5273b9a487" class="i method">GetSocket</a>();
					}
				}
				<b>if</b> (<span class="r1 r">connectTimeout</span> &gt; 0 &amp;&amp; <a href="#cecd2519df141327" class="i field">socket</a> != <b>null</b>)
				{
					<a href="#cecd2519df141327" class="i field">socket</a>.<a href="@0@System/A.html#b78f7d4a8a51dfd6" class="i property">ReceiveTimeout</a> = <span class="r1 r">connectTimeout</span>;
				}
				<a href="#4abfa4fb08e3731c" class="i field">isConnected</a> = <b>true</b>;
				<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Connection established&quot;</span>);
				}
				<a href="#3cb0c6825676d304" class="i field">jsch</a>.<a href="JSch.cs.html#9f240e5b19aeb7c9" class="i method">AddSession</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
				{
					<span class="c">// Some Cisco devices will miss to read &#39;\n&#39; if it is sent separately.</span>
					<b>byte</b>[] <span id="r8 rd" class="r8 r">foo</span> = <b>new</b> <b>byte</b>[<a href="#295fb16f7829b6aa" class="i field">V_C</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> + 1];
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<a href="#295fb16f7829b6aa" class="i field">V_C</a>, 0, <span class="r8 r">foo</span>, 0, <a href="#295fb16f7829b6aa" class="i field">V_C</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<span class="r8 r">foo</span>[<span class="r8 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - 1] = <b>unchecked</b>((<b>byte</b>)(<b>byte</b>)(<span class="s">&#39;\n&#39;</span>));
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#f6e9db8e4f2ac933" class="i method">Put</a>(<span class="r8 r">foo</span>, 0, <span class="r8 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
				}
				<b>while</b> (<b>true</b>)
				{
					<span class="r4 r">i</span> = 0;
					<span class="r5 r">j</span> = 0;
					<b>while</b> (<span class="r4 r">i</span> &lt; <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
					{
						<span class="r5 r">j</span> = <a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#06baf95ead96c72c" class="i method">GetByte</a>();
						<b>if</b> (<span class="r5 r">j</span> &lt; 0)
						{
							<b>break</b>;
						}
						<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r4 r">i</span>] = <b>unchecked</b>((<b>byte</b>)<span class="r5 r">j</span>);
						<span class="r4 r">i</span>++;
						<b>if</b> (<span class="r5 r">j</span> == 10)
						{
							<b>break</b>;
						}
					}
					<b>if</b> (<span class="r5 r">j</span> &lt; 0)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;connection is closed by foreign host&quot;</span>);
					}
					<b>if</b> (<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r4 r">i</span> - 1] == 10)
					{
						<span class="c">// 0x0a</span>
						<span class="r4 r">i</span>--;
						<b>if</b> (<span class="r4 r">i</span> &gt; 0 &amp;&amp; <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r4 r">i</span> - 1] == 13)
						{
							<span class="c">// 0x0d</span>
							<span class="r4 r">i</span>--;
						}
					}
					<b>if</b> (<span class="r4 r">i</span> &lt;= 3 || ((<span class="r4 r">i</span> != <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>) &amp;&amp; (<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[0] != <span class="s">&#39;S&#39;</span> || <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[1]
						 != <span class="s">&#39;S&#39;</span> || <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[2] != <span class="s">&#39;H&#39;</span> || <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[3] != <span class="s">&#39;-&#39;</span>)))
					{
						<span class="c">// It must not start with &#39;SSH-&#39;</span>
						<span class="c">//System.err.println(new String(buf.buffer, 0, i);</span>
						<b>continue</b>;
					}
					<b>if</b> (<span class="r4 r">i</span> == <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> || <span class="r4 r">i</span> &lt; 7 || (<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[4] == <span class="s">&#39;1&#39;</span> &amp;&amp; <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[6] != 
						<span class="s">&#39;9&#39;</span>))
					{
						<span class="c">// SSH-1.99 or SSH-2.0</span>
						<span class="c">// SSH-1.5</span>
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;invalid server&#39;s version string&quot;</span>);
					}
					<b>break</b>;
				}
				<a href="#89221780c105f245" class="i field">V_S</a> = <b>new</b> <b>byte</b>[<span class="r4 r">i</span>];
				<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#89221780c105f245" class="i field">V_S</a>, 0, <span class="r4 r">i</span>);
				<span class="c">//System.err.println(&quot;V_S: (&quot;+i+&quot;) [&quot;+new String(V_S)+&quot;]&quot;);</span>
				<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Remote version string: &quot;</span> + <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<a href="#89221780c105f245" class="i field">V_S</a>));
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Local version string: &quot;</span> + <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<a href="#295fb16f7829b6aa" class="i field">V_C</a>));
				}
				<a href="#d537396b7ec1ae39" class="i method">Send_kexinit</a>();
				<a href="#c9533f8905ab0b0d" class="i field">buf</a> = <a href="#f1672c97029d017f" class="i method">Read</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
				<b>if</b> (<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>() != <a href="#fa37ec3e1195635d" class="i field">SSH_MSG_KEXINIT</a>)
				{
					<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;invalid protocol: &quot;</span> + <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>());
				}
				<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;SSH_MSG_KEXINIT received&quot;</span>);
				}
				<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r9 rd" class="r9 r">kex</span> = <a href="#3a5880bf06fa30b5" class="i method">Receive_kexinit</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
				<b>while</b> (<b>true</b>)
				{
					<a href="#c9533f8905ab0b0d" class="i field">buf</a> = <a href="#f1672c97029d017f" class="i method">Read</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
					<b>if</b> (<span class="r9 r">kex</span>.<a href="KeyExchange.cs.html#1f8e1099fb018d79" class="i method">GetState</a>() == <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>())
					{
						<a href="#09138aef4c73af81" class="i field">kex_start_time</a> = <a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#e138393156840d80" class="i method">CurrentTimeMillis</a>();
						<b>bool</b> <span id="r10 rd" class="r10 r">result</span> = <span class="r9 r">kex</span>.<a href="KeyExchange.cs.html#4ded7c8a69246269" class="i method">Next</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
						<b>if</b> (!<span class="r10 r">result</span>)
						{
							<span class="c">//System.err.println(&quot;verify: &quot;+result);</span>
							<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
							<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;verify: &quot;</span> + <span class="r10 r">result</span>);
						}
					}
					<b>else</b>
					{
						<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;invalid protocol(kex): &quot;</span> + <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>());
					}
					<b>if</b> (<span class="r9 r">kex</span>.<a href="KeyExchange.cs.html#1f8e1099fb018d79" class="i method">GetState</a>() == <a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#f29b9f3197536ad2" class="i field">STATE_END</a>)
					{
						<b>break</b>;
					}
				}
				<b>try</b>
				{
					<a href="#1aedd8a087fafa43" class="i method">CheckHost</a>(<a href="#1a2b75046ce43fcd" class="i field">host</a>, <a href="#6e04a039d8ded1f9" class="i field">port</a>, <span class="r9 r">kex</span>);
				}
				<b>catch</b> (<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a> <span id="r11 rd" class="r11 r">ee</span>)
				{
					<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
					<b>throw</b>;
				}
				<a href="#92fee1d77983bd38" class="i method">Send_newkeys</a>();
				<span class="c">// receive SSH_MSG_NEWKEYS(21)</span>
				<a href="#c9533f8905ab0b0d" class="i field">buf</a> = <a href="#f1672c97029d017f" class="i method">Read</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>);
				<span class="c">//System.err.println(&quot;read: 21 ? &quot;+buf.getCommand());</span>
				<b>if</b> (<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>() == <a href="#a99d5a0391eb6ca0" class="i field">SSH_MSG_NEWKEYS</a>)
				{
					<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
					{
						<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;SSH_MSG_NEWKEYS received&quot;</span>);
					}
					<a href="#f7e7d8d22e54bb88" class="i method">Receive_newkeys</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>, <span class="r9 r">kex</span>);
				}
				<b>else</b>
				{
					<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;invalid protocol(newkyes): &quot;</span> + <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>());
				}
				<b>try</b>
				{
					<b>string</b> <span id="r12 rd" class="r12 r">s</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;MaxAuthTries&quot;</span>);
					<b>if</b> (<span class="r12 r">s</span> != <b>null</b>)
					{
						<a href="#1d4c324d003d5954" class="i field">max_auth_tries</a> = <span class="i n">System</span>.<a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#069d595792a157df" class="i method">ToInt32</a>(<span class="r12 r">s</span>);
					}
				}
				<b>catch</b> (<a href="@0@mscorlib/A.html#80a470d64a9b80ef" class="t t">FormatException</a> <span id="r13 rd" class="r13 r">e</span>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="s">&quot;MaxAuthTries: &quot;</span> + <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;MaxAuthTries&quot;</span>), <span class="r13 r">e</span>);
				}
				<b>bool</b> <span id="r14 rd" class="r14 r">auth</span> = <b>false</b>;
				<b>bool</b> <span id="r15 rd" class="r15 r">auth_cancel</span> = <b>false</b>;
				<a href="UserAuth.cs.html#5abee9f0959059d5" class="t t">UserAuth</a> <span id="r16 rd" class="r16 r">ua</span> = <b>null</b>;
				<b>try</b>
				{
					<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r17 rd" class="r17 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;userauth.none&quot;</span>));
					<span class="r16 r">ua</span> = (<a href="UserAuth.cs.html#5abee9f0959059d5" class="t t">UserAuth</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r17 r">c</span>));
				}
				<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r18 rd" class="r18 r">e</span>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r18 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r18 r">e</span>);
				}
				<span class="r14 r">auth</span> = <span class="r16 r">ua</span>.<a href="UserAuth.cs.html#47adc4858f3ca57a" class="i method">Start</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
				<b>string</b> <span id="r19 rd" class="r19 r">cmethods</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;PreferredAuthentications&quot;</span>);
				<b>string</b>[] <span id="r20 rd" class="r20 r">cmethoda</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#3524eb6ee742432d" class="i method">Split</a>(<span class="r19 r">cmethods</span>, <span class="s">&quot;,&quot;</span>);
				<b>string</b> <span id="r21 rd" class="r21 r">smethods</span> = <b>null</b>;
				<b>if</b> (!<span class="r14 r">auth</span>)
				{
					<span class="r21 r">smethods</span> = ((<a href="UserAuthNone.cs.html#c29c978f8553f93c" class="t t">UserAuthNone</a>)<span class="r16 r">ua</span>).<a href="UserAuthNone.cs.html#5a781f58ccccb2c7" class="i method">GetMethods</a>();
					<b>if</b> (<span class="r21 r">smethods</span> != <b>null</b>)
					{
						<span class="r21 r">smethods</span> = <span class="r21 r">smethods</span>.<a href="@0@mscorlib/A.html#0b5a1ee33618e0b3" class="i method">ToLower</a>();
					}
					<b>else</b>
					{
						<span class="c">// methods: publickey,password,keyboard-interactive</span>
						<span class="c">//smethods=&quot;publickey,password,keyboard-interactive&quot;;</span>
						<span class="r21 r">smethods</span> = <span class="r19 r">cmethods</span>;
					}
				}
				<b>string</b>[] <span id="r22 rd" class="r22 r">smethoda</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#3524eb6ee742432d" class="i method">Split</a>(<span class="r21 r">smethods</span>, <span class="s">&quot;,&quot;</span>);
				<b>int</b> <span id="r23 rd" class="r23 r">methodi</span> = 0;
				<b>while</b> (<b>true</b>)
				{
					<b>while</b> (!<span class="r14 r">auth</span> &amp;&amp; <span class="r20 r">cmethoda</span> != <b>null</b> &amp;&amp; <span class="r23 r">methodi</span> &lt; <span class="r20 r">cmethoda</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
					{
						<b>string</b> <span id="r24 rd" class="r24 r">method</span> = <span class="r20 r">cmethoda</span>[<span class="r23 r">methodi</span>++];
						<b>bool</b> <span id="r25 rd" class="r25 r">acceptable</span> = <b>false</b>;
						<b>for</b> (<b>int</b> <span id="r26 rd" class="r26 r">k</span> = 0; <span class="r26 r">k</span> &lt; <span class="r22 r">smethoda</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r26 r">k</span>++)
						{
							<b>if</b> (<span class="r22 r">smethoda</span>[<span class="r26 r">k</span>].<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="r24 r">method</span>))
							{
								<span class="r25 r">acceptable</span> = <b>true</b>;
								<b>break</b>;
							}
						}
						<b>if</b> (!<span class="r25 r">acceptable</span>)
						{
							<b>continue</b>;
						}
						<span class="c">//System.err.println(&quot;  method: &quot;+method);</span>
						<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
						{
							<b>string</b> <span id="r27 rd" class="r27 r">str</span> = <span class="s">&quot;Authentications that can continue: &quot;</span>;
							<b>for</b> (<b>int</b> <span id="r28 rd" class="r28 r">k_1</span> = <span class="r23 r">methodi</span> - 1; <span class="r28 r">k_1</span> &lt; <span class="r20 r">cmethoda</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r28 r">k_1</span>++)
							{
								<span class="r27 r">str</span> += <span class="r20 r">cmethoda</span>[<span class="r28 r">k_1</span>];
								<b>if</b> (<span class="r28 r">k_1</span> + 1 &lt; <span class="r20 r">cmethoda</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
								{
									<span class="r27 r">str</span> += <span class="s">&quot;,&quot;</span>;
								}
							}
							<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="r27 r">str</span>);
							<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Next authentication method: &quot;</span> + <span class="r24 r">method</span>);
						}
						<span class="r16 r">ua</span> = <b>null</b>;
						<b>try</b>
						{
							<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r29 rd" class="r29 r">c</span> = <b>null</b>;
							<b>if</b> (<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;userauth.&quot;</span> + <span class="r24 r">method</span>) != <b>null</b>)
							{
								<span class="r29 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;userauth.&quot;</span> + <span class="r24 r">method</span>));
								<span class="r16 r">ua</span> = (<a href="UserAuth.cs.html#5abee9f0959059d5" class="t t">UserAuth</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r29 r">c</span>));
							}
						}
						<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
						{
							<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#92f3994a2cc9e4b1" class="i field">WARN</a>))
							{
								<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#92f3994a2cc9e4b1" class="i field">WARN</a>, <span class="s">&quot;failed to load &quot;</span> + <span class="r24 r">method</span> + <span class="s">&quot; method&quot;</span>);
							}
						}
						<b>if</b> (<span class="r16 r">ua</span> != <b>null</b>)
						{
							<span class="r15 r">auth_cancel</span> = <b>false</b>;
							<b>try</b>
							{
								<span class="r14 r">auth</span> = <span class="r16 r">ua</span>.<a href="UserAuth.cs.html#47adc4858f3ca57a" class="i method">Start</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
								<b>if</b> (<span class="r14 r">auth</span> &amp;&amp; <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
								{
									<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Authentication succeeded (&quot;</span> + <span class="r24 r">method</span> + <span class="s">&quot;).&quot;</span>);
								}
							}
							<b>catch</b> (<a href="JSchAuthCancelException.cs.html#eb116035bf5bcacc" class="t t">JSchAuthCancelException</a>)
							{
								<span class="r15 r">auth_cancel</span> = <b>true</b>;
							}
							<b>catch</b> (<a href="JSchPartialAuthException.cs.html#b06866954f0da964" class="t t">JSchPartialAuthException</a> <span id="r30 rd" class="r30 r">ee</span>)
							{
								<b>string</b> <span id="r31 rd" class="r31 r">tmp</span> = <span class="r21 r">smethods</span>;
								<span class="r21 r">smethods</span> = <span class="r30 r">ee</span>.<a href="JSchPartialAuthException.cs.html#9e3f73a159629512" class="i method">GetMethods</a>();
								<span class="r22 r">smethoda</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#3524eb6ee742432d" class="i method">Split</a>(<span class="r21 r">smethods</span>, <span class="s">&quot;,&quot;</span>);
								<b>if</b> (!<span class="r31 r">tmp</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="r21 r">smethods</span>))
								{
									<span class="r23 r">methodi</span> = 0;
								}
								<span class="c">//System.err.println(&quot;PartialAuth: &quot;+methods);</span>
								<span class="r15 r">auth_cancel</span> = <b>false</b>;
								<b>goto</b> <span class="i">loop_continue</span>;
							}
							<b>catch</b> (<a href="/Sharpen/A.html#7752f9982c130655" class="t t">RuntimeException</a> <span id="r32 rd" class="r32 r">ee</span>)
							{
								<b>throw</b>;
							}
							<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
							{
								<span class="c">//System.err.println(&quot;ee: &quot;+ee); // SSH_MSG_DISCONNECT: 2 Too many authentication failures</span>
								<b>goto</b> <span class="i">loop_break</span>;
							}
						}
					}
					<b>break</b>;
<span class="i">loop_continue</span>: ;
				}
<span class="i">loop_break</span>: ;
				<b>if</b> (!<span class="r14 r">auth</span>)
				{
					<b>if</b> (<a href="#63e9794d17d59d6d" class="i field">auth_failures</a> &gt;= <a href="#1d4c324d003d5954" class="i field">max_auth_tries</a>)
					{
						<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
						{
							<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Login trials exceeds &quot;</span> + <a href="#1d4c324d003d5954" class="i field">max_auth_tries</a>);
						}
					}
					<b>if</b> (<span class="r15 r">auth_cancel</span>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Auth cancel&quot;</span>);
					}
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Auth fail&quot;</span>);
				}
				<b>if</b> (<span class="r1 r">connectTimeout</span> &gt; 0 || <a href="#e5455bfe534c29f8" class="i field">timeout</a> &gt; 0)
				{
					<a href="#cecd2519df141327" class="i field">socket</a>.<a href="@0@System/A.html#b78f7d4a8a51dfd6" class="i property">ReceiveTimeout</a> = <a href="#e5455bfe534c29f8" class="i field">timeout</a>;
				}
				<a href="#9d201effb55c3143" class="i field">isAuthed</a> = <b>true</b>;
				<b>lock</b> (<a href="#2dd88d5f8d13745d" class="i field">Lock</a>)
				{
					<b>if</b> (<a href="#4abfa4fb08e3731c" class="i field">isConnected</a>)
					{
						<a href="#05db945f2e416c87" class="i field">connectThread</a> = <b>new</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#83966b7a9ccffe23" class="t constructor">Thread</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
						<a href="#05db945f2e416c87" class="i field">connectThread</a>.<a href="/Sharpen/A.html#7046e9ef75861e01" class="i method">SetName</a>(<span class="s">&quot;Connect thread &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot; session&quot;</span>);
						<b>if</b> (<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>)
						{
							<a href="#05db945f2e416c87" class="i field">connectThread</a>.<a href="/Sharpen/A.html#492a2f0356d4059d" class="i method">SetDaemon</a>(<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>);
						}
						<a href="#05db945f2e416c87" class="i field">connectThread</a>.<a href="/Sharpen/A.html#492a2f0356d4059d" class="i method">SetDaemon</a> (<b>true</b>);
						<a href="#05db945f2e416c87" class="i field">connectThread</a>.<a href="/Sharpen/A.html#421e075210622d1e" class="i method">Start</a>();
					}
				}
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r33 rd" class="r33 r">e</span>)
			{
				<span class="c">// The session has been already down and</span>
				<span class="c">// we don&#39;t have to start new thread.</span>
				<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
				<b>if</b> (<a href="#4abfa4fb08e3731c" class="i field">isConnected</a>)
				{
					<b>try</b>
					{
						<a href="#506c38da0761c8da" class="i field">packet</a>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
						<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#6901129ba842857e" class="i field">SSH_MSG_DISCONNECT</a>));
						<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(3);
						<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r33 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>()));
						<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="s">&quot;en&quot;</span>));
						<a href="#3023fd09cf504160" class="i method">Write</a>(<a href="#506c38da0761c8da" class="i field">packet</a>);
						<a href="#72b3f15fae507244" class="i method">Disconnect</a>();
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
					{
					}
				}
				<a href="#4abfa4fb08e3731c" class="i field">isConnected</a> = <b>false</b>;
				<span class="c">//e.printStackTrace();</span>
				<b>if</b> (<span class="r33 r">e</span> <b>is</b> <a href="/Sharpen/A.html#7752f9982c130655" class="t t">RuntimeException</a>)
				{
					<b>throw</b> (<a href="/Sharpen/A.html#7752f9982c130655" class="t t">RuntimeException</a>)<span class="r33 r">e</span>;
				}
				<b>if</b> (<span class="r33 r">e</span> <b>is</b> <a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a>)
				{
					<b>throw</b> (<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a>)<span class="r33 r">e</span>;
				}
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Session.connect: &quot;</span> + <span class="r33 r">e</span>);
			}
			<b>finally</b>
			{
				<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#b17052e2c95ddc15" class="i method">Bzero</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1facbe2f33793c2a" class="i field">password</a>);
				<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1facbe2f33793c2a" class="i field">password</a> = <b>null</b>;
			}
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private</b> <a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <a id="3a5880bf06fa30b5" href="../R/3a5880bf06fa30b5.html" target="n" data-glyph="76,1" class="i method">Receive_kexinit</a>(<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r34 rd" class="r34 r">buf</span>)
		{
			<b>int</b> <span id="r35 rd" class="r35 r">j</span> = <span class="r34 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
			<b>if</b> (<span class="r35 r">j</span> != <span class="r34 r">buf</span>.<a href="Buffer.cs.html#e00f767833732c18" class="i method">GetLength</a>())
			{
				<span class="c">// packet was compressed and</span>
				<span class="r34 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>();
				<span class="c">// j is the size of deflated packet.</span>
				<a href="#c44ddf657067893d" class="i field">I_S</a> = <b>new</b> <b>byte</b>[<span class="r34 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> - 5];
			}
			<b>else</b>
			{
				<a href="#c44ddf657067893d" class="i field">I_S</a> = <b>new</b> <b>byte</b>[<span class="r35 r">j</span> - 1 - <span class="r34 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>()];
			}
			<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r34 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r34 r">buf</span>.<a href="Buffer.cs.html#126a5a63b6659839" class="i field">s</a>, <a href="#c44ddf657067893d" class="i field">I_S</a>, 0, <a href="#c44ddf657067893d" class="i field">I_S</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
			<b>if</b> (!<a href="#c76805519b7a0e7c" class="i field">in_kex</a>)
			{
				<span class="c">// We are in rekeying activated by the remote!</span>
				<a href="#d537396b7ec1ae39" class="i method">Send_kexinit</a>();
			}
			<a href="#c71d800be7c637d4" class="i field">guess</a> = <a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#a24f5b13b2025b5e" class="i method">Guess</a>(<a href="#c44ddf657067893d" class="i field">I_S</a>, <a href="#1e6a830eb951c117" class="i field">I_C</a>);
			<b>if</b> (<a href="#c71d800be7c637d4" class="i field">guess</a> == <b>null</b>)
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Algorithm negotiation fail&quot;</span>);
			}
			<b>if</b> (!<a href="#9d201effb55c3143" class="i field">isAuthed</a> &amp;&amp; (<a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#54cf85d9f6b9bcf4" class="i field">PROPOSAL_ENC_ALGS_CTOS</a>].<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;none&quot;</span>) || (<a href="#c71d800be7c637d4" class="i field">guess</a>
				[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#717e315a8759c8ed" class="i field">PROPOSAL_ENC_ALGS_STOC</a>].<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;none&quot;</span>))))
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;NONE Cipher should not be chosen before authentification is successed.&quot;</span>
					);
			}
			<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r36 rd" class="r36 r">kex</span> = <b>null</b>;
			<b>try</b>
			{
				<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r37 rd" class="r37 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#2746a1ab57a3353b" class="i field">PROPOSAL_KEX_ALGS</a>]));
				<span class="r36 r">kex</span> = (<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r37 r">c</span>));
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r38 rd" class="r38 r">e</span>)
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r38 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r38 r">e</span>);
			}
			<span class="r36 r">kex</span>.<a href="KeyExchange.cs.html#6cc44c2b6ad0e299" class="i method">Init</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <a href="#89221780c105f245" class="i field">V_S</a>, <a href="#295fb16f7829b6aa" class="i field">V_C</a>, <a href="#c44ddf657067893d" class="i field">I_S</a>, <a href="#1e6a830eb951c117" class="i field">I_C</a>);
			<b>return</b> <span class="r36 r">kex</span>;
		}

		<b>private bool</b> <a id="c76805519b7a0e7c" href="../R/c76805519b7a0e7c.html" target="n" data-glyph="46,1" class="i field">in_kex</a> = <b>false</b>;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="2cca309087b8001f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">Rekey</a>()
		{
			<a href="#d537396b7ec1ae39" class="i method">Send_kexinit</a>();
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="d537396b7ec1ae39" href="../R/d537396b7ec1ae39.html" target="n" data-glyph="76,1" class="i method">Send_kexinit</a>()
		{
			<b>if</b> (<a href="#c76805519b7a0e7c" class="i field">in_kex</a>)
			{
				<b>return</b>;
			}
			<b>string</b> <span id="r39 rd" class="r39 r">cipherc2s</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;cipher.c2s&quot;</span>);
			<b>string</b> <span id="r40 rd" class="r40 r">ciphers2c</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;cipher.s2c&quot;</span>);
			<b>string</b>[] <span id="r41 rd" class="r41 r">not_available_ciphers</span> = <a href="#bddebb7c59fb0058" class="i method">CheckCiphers</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;CheckCiphers&quot;</span>));
			<b>if</b> (<span class="r41 r">not_available_ciphers</span> != <b>null</b> &amp;&amp; <span class="r41 r">not_available_ciphers</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
			{
				<span class="r39 r">cipherc2s</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#d7d037e4350ff620" class="i method">DiffString</a>(<span class="r39 r">cipherc2s</span>, <span class="r41 r">not_available_ciphers</span>);
				<span class="r40 r">ciphers2c</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#d7d037e4350ff620" class="i method">DiffString</a>(<span class="r40 r">ciphers2c</span>, <span class="r41 r">not_available_ciphers</span>);
				<b>if</b> (<span class="r39 r">cipherc2s</span> == <b>null</b> || <span class="r40 r">ciphers2c</span> == <b>null</b>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;There are not any available ciphers.&quot;</span>);
				}
			}
			<b>string</b> <span id="r42 rd" class="r42 r">kex</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;kex&quot;</span>);
			<b>string</b>[] <span id="r43 rd" class="r43 r">not_available_kexes</span> = <a href="#c03b6a8c35c4a547" class="i method">CheckKexes</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;CheckKexes&quot;</span>));
			<b>if</b> (<span class="r43 r">not_available_kexes</span> != <b>null</b> &amp;&amp; <span class="r43 r">not_available_kexes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> &gt; 0)
			{
				<span class="r42 r">kex</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#d7d037e4350ff620" class="i method">DiffString</a>(<span class="r42 r">kex</span>, <span class="r43 r">not_available_kexes</span>);
				<b>if</b> (<span class="r42 r">kex</span> == <b>null</b>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;There are not any available kexes.&quot;</span>);
				}
			}
			<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>true</b>;
			<a href="#09138aef4c73af81" class="i field">kex_start_time</a> = <a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#e138393156840d80" class="i method">CurrentTimeMillis</a>();
			<span class="c">// byte      SSH_MSG_KEXINIT(20)</span>
			<span class="c">// byte[16]  cookie (random bytes)</span>
			<span class="c">// string    kex_algorithms</span>
			<span class="c">// string    server_host_key_algorithms</span>
			<span class="c">// string    encryption_algorithms_client_to_server</span>
			<span class="c">// string    encryption_algorithms_server_to_client</span>
			<span class="c">// string    mac_algorithms_client_to_server</span>
			<span class="c">// string    mac_algorithms_server_to_client</span>
			<span class="c">// string    compression_algorithms_client_to_server</span>
			<span class="c">// string    compression_algorithms_server_to_client</span>
			<span class="c">// string    languages_client_to_server</span>
			<span class="c">// string    languages_server_to_client</span>
			<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r44 rd" class="r44 r">buf</span> = <b>new</b> <a href="Buffer.cs.html#35c62a99009984d5" class="t constructor">Buffer</a>();
			<span class="c">// send_kexinit may be invoked</span>
			<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r45 rd" class="r45 r">packet</span> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<span class="r44 r">buf</span>);
			<span class="c">// by user thread.</span>
			<span class="r45 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#fa37ec3e1195635d" class="i field">SSH_MSG_KEXINIT</a>));
			<b>lock</b> (<a href="#c6706870ca880511" class="i field">random</a>)
			{
				<a href="#c6706870ca880511" class="i field">random</a>.<a href="Random.cs.html#cb96f3cbbfb5358d" class="i method">Fill</a>(<span class="r44 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r44 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>, 16);
				<span class="r44 r">buf</span>.<a href="Buffer.cs.html#ec7e1e853698309a" class="i method">Skip</a>(16);
			}
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r42 r">kex</span>));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;server_host_key&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r39 r">cipherc2s</span>));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r40 r">ciphers2c</span>));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;mac.c2s&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;mac.s2c&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;compression.c2s&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;compression.s2c&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;lang.c2s&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;lang.s2c&quot;</span>)));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)0));
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(0);
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#39576cfc0e90bd4d" class="i method">SetOffSet</a>(5);
			<a href="#1e6a830eb951c117" class="i field">I_C</a> = <b>new</b> <b>byte</b>[<span class="r44 r">buf</span>.<a href="Buffer.cs.html#e00f767833732c18" class="i method">GetLength</a>()];
			<span class="r44 r">buf</span>.<a href="Buffer.cs.html#1cac2539eb55098a" class="i method">GetByte</a>(<a href="#1e6a830eb951c117" class="i field">I_C</a>);
			<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r45 r">packet</span>);
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;SSH_MSG_KEXINIT sent&quot;</span>);
			}
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="92fee1d77983bd38" href="../R/92fee1d77983bd38.html" target="n" data-glyph="76,1" class="i method">Send_newkeys</a>()
		{
			<span class="c">// send SSH_MSG_NEWKEYS(21)</span>
			<a href="#506c38da0761c8da" class="i field">packet</a>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#a99d5a0391eb6ca0" class="i field">SSH_MSG_NEWKEYS</a>));
			<a href="#3023fd09cf504160" class="i method">Write</a>(<a href="#506c38da0761c8da" class="i field">packet</a>);
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;SSH_MSG_NEWKEYS sent&quot;</span>);
			}
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="1aedd8a087fafa43" href="../R/1aedd8a087fafa43.html" target="n" data-glyph="76,1" class="i method">CheckHost</a>(<b>string</b> <span id="r46 rd" class="r46 r">chost</span>, <b>int</b> <span id="r47 rd" class="r47 r">port</span>, <a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r48 rd" class="r48 r">kex</span>)
		{
			<b>string</b> <span id="r49 rd" class="r49 r">shkc</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;StrictHostKeyChecking&quot;</span>);
			<b>if</b> (<a href="#274893d49d1a5973" class="i field">hostKeyAlias</a> != <b>null</b>)
			{
				<span class="r46 r">chost</span> = <a href="#274893d49d1a5973" class="i field">hostKeyAlias</a>;
			}
			<span class="c">//System.err.println(&quot;shkc: &quot;+shkc);</span>
			<b>byte</b>[] <span id="r50 rd" class="r50 r">K_S</span> = <span class="r48 r">kex</span>.<a href="KeyExchange.cs.html#1c486fd533858407" class="i method">GetHostKey</a>();
			<b>string</b> <span id="r51 rd" class="r51 r">key_type</span> = <span class="r48 r">kex</span>.<a href="KeyExchange.cs.html#c59027ba06a64830" class="i method">GetKeyType</a>();
			<b>string</b> <span id="r52 rd" class="r52 r">key_fprint</span> = <span class="r48 r">kex</span>.<a href="KeyExchange.cs.html#8f030446af5e5b47" class="i method">GetFingerPrint</a>();
			<b>if</b> (<a href="#274893d49d1a5973" class="i field">hostKeyAlias</a> == <b>null</b> &amp;&amp; <span class="r47 r">port</span> != 22)
			{
				<span class="r46 r">chost</span> = (<span class="s">&quot;[&quot;</span> + <span class="r46 r">chost</span> + <span class="s">&quot;]:&quot;</span> + <span class="r47 r">port</span>);
			}
			<span class="c">//    hostkey=new HostKey(chost, K_S);</span>
			<a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a> <span id="r53 rd" class="r53 r">hkr</span> = <a href="#3cb0c6825676d304" class="i field">jsch</a>.<a href="JSch.cs.html#13a50240364adf77" class="i method">GetHostKeyRepository</a>();
			<b>int</b> <span id="r54 rd" class="r54 r">i</span> = 0;
			<b>lock</b> (<span class="r53 r">hkr</span>)
			{
				<span class="r54 r">i</span> = <span class="r53 r">hkr</span>.<a href="HostKeyRepository.cs.html#4b65c918e5145d1e" class="i method">Check</a>(<span class="r46 r">chost</span>, <span class="r50 r">K_S</span>);
			}
			<b>bool</b> <span id="r55 rd" class="r55 r">insert</span> = <b>false</b>;
			<b>if</b> ((<span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;ask&quot;</span>) || <span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;yes&quot;</span>)) &amp;&amp; <span class="r54 r">i</span> == <a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a>.<a href="HostKeyRepository.cs.html#6633f2bfa88ff42e" class="i field">CHANGED</a>)
			{
				<b>string</b> <span id="r56 rd" class="r56 r">file</span> = <b>null</b>;
				<b>lock</b> (<span class="r53 r">hkr</span>)
				{
					<span class="r56 r">file</span> = <span class="r53 r">hkr</span>.<a href="HostKeyRepository.cs.html#db7916e9aa0de00b" class="i method">GetKnownHostsRepositoryID</a>();
				}
				<b>if</b> (<span class="r56 r">file</span> == <b>null</b>)
				{
					<span class="r56 r">file</span> = <span class="s">&quot;known_hosts&quot;</span>;
				}
				<b>bool</b> <span id="r57 rd" class="r57 r">b</span> = <b>false</b>;
				<b>if</b> (<a href="#db6703f509870e09" class="i field">userinfo</a> != <b>null</b>)
				{
					<b>string</b> <span id="r58 rd" class="r58 r">message</span> = <span class="s">&quot;WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!\n&quot;</span> + <span class="s">&quot;IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!\n&quot;</span>
						 + <span class="s">&quot;Someone could be eavesdropping on you right now (man-in-the-middle attack)!\n&quot;</span>
						 + <span class="s">&quot;It is also possible that the &quot;</span> + <span class="r51 r">key_type</span> + <span class="s">&quot; host key has just been changed.\n&quot;</span>
						 + <span class="s">&quot;The fingerprint for the &quot;</span> + <span class="r51 r">key_type</span> + <span class="s">&quot; key sent by the remote host is\n&quot;</span> +
						 <span class="r52 r">key_fprint</span> + <span class="s">&quot;.\n&quot;</span> + <span class="s">&quot;Please contact your system administrator.\n&quot;</span> + <span class="s">&quot;Add correct host key in &quot;</span>
						 + <span class="r56 r">file</span> + <span class="s">&quot; to get rid of this message.&quot;</span>;
					<b>if</b> (<span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;ask&quot;</span>))
					{
						<span class="r57 r">b</span> = <a href="#db6703f509870e09" class="i field">userinfo</a>.<a href="UserInfo.cs.html#c7d1e6d73bcc6b2f" class="i method">PromptYesNo</a>(<span class="r58 r">message</span> + <span class="s">&quot;\nDo you want to delete the old key and insert the new key?&quot;</span>
							);
					}
					<b>else</b>
					{
						<span class="c">// shkc.equals(&quot;yes&quot;)</span>
						<a href="#db6703f509870e09" class="i field">userinfo</a>.<a href="UserInfo.cs.html#154ce7ce8d309a9d" class="i method">ShowMessage</a>(<span class="r58 r">message</span>);
					}
				}
				<b>if</b> (!<span class="r57 r">b</span>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;HostKey has been changed: &quot;</span> + <span class="r46 r">chost</span>);
				}
				<b>lock</b> (<span class="r53 r">hkr</span>)
				{
					<span class="r53 r">hkr</span>.<a href="HostKeyRepository.cs.html#61ceb8a43b9552d5" class="i method">Remove</a>(<span class="r46 r">chost</span>, (<span class="r51 r">key_type</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;DSA&quot;</span>) ? <span class="s">&quot;ssh-dss&quot;</span> : <span class="s">&quot;ssh-rsa&quot;</span>), <b>null</b>);
					<span class="r55 r">insert</span> = <b>true</b>;
				}
			}
			<b>if</b> ((<span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;ask&quot;</span>) || <span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;yes&quot;</span>)) &amp;&amp; (<span class="r54 r">i</span> != <a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a>.<a href="HostKeyRepository.cs.html#5eb56034b4a54589" class="i field">OK</a>) &amp;&amp; 
				!<span class="r55 r">insert</span>)
			{
				<b>if</b> (<span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;yes&quot;</span>))
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;reject HostKey: &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a>);
				}
				<span class="c">//System.err.println(&quot;finger-print: &quot;+key_fprint);</span>
				<b>if</b> (<a href="#db6703f509870e09" class="i field">userinfo</a> != <b>null</b>)
				{
					<b>bool</b> <span id="r59 rd" class="r59 r">foo</span> = <a href="#db6703f509870e09" class="i field">userinfo</a>.<a href="UserInfo.cs.html#c7d1e6d73bcc6b2f" class="i method">PromptYesNo</a>(<span class="s">&quot;The authenticity of host &#39;&quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot;&#39; can&#39;t be established.\n&quot;</span>
						 + <span class="r51 r">key_type</span> + <span class="s">&quot; key fingerprint is &quot;</span> + <span class="r52 r">key_fprint</span> + <span class="s">&quot;.\n&quot;</span> + <span class="s">&quot;Are you sure you want to continue connecting?&quot;</span>
						);
					<b>if</b> (!<span class="r59 r">foo</span>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;reject HostKey: &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a>);
					}
					<span class="r55 r">insert</span> = <b>true</b>;
				}
				<b>else</b>
				{
					<b>if</b> (<span class="r54 r">i</span> == <a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a>.<a href="HostKeyRepository.cs.html#b52ed14c33debb5c" class="i field">NOT_INCLUDED</a>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;UnknownHostKey: &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot;. &quot;</span> + <span class="r51 r">key_type</span> + <span class="s">&quot; key fingerprint is &quot;</span>
							 + <span class="r52 r">key_fprint</span>);
					}
					<b>else</b>
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;HostKey has been changed: &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a>);
					}
				}
			}
			<b>if</b> (<span class="r49 r">shkc</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;no&quot;</span>) &amp;&amp; <a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a>.<a href="HostKeyRepository.cs.html#b52ed14c33debb5c" class="i field">NOT_INCLUDED</a> == <span class="r54 r">i</span>)
			{
				<span class="r55 r">insert</span> = <b>true</b>;
			}
			<b>if</b> (<span class="r54 r">i</span> == <a href="HostKeyRepository.cs.html#858c98d90784055a" class="t t">HostKeyRepository</a>.<a href="HostKeyRepository.cs.html#5eb56034b4a54589" class="i field">OK</a> &amp;&amp; <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Host &#39;&quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot;&#39; is known and mathces the &quot;</span>
					 + <span class="r51 r">key_type</span> + <span class="s">&quot; host key&quot;</span>);
			}
			<b>if</b> (<span class="r55 r">insert</span> &amp;&amp; <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#92f3994a2cc9e4b1" class="i field">WARN</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#92f3994a2cc9e4b1" class="i field">WARN</a>, <span class="s">&quot;Permanently added &#39;&quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot;&#39; (&quot;</span> + <span class="r51 r">key_type</span>
					 + <span class="s">&quot;) to the list of known hosts.&quot;</span>);
			}
			<b>string</b> <span id="r60 rd" class="r60 r">hkh</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;HashKnownHosts&quot;</span>);
			<b>if</b> (<span class="r60 r">hkh</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;yes&quot;</span>) &amp;&amp; (<span class="r53 r">hkr</span> <b>is</b> <a href="KnownHosts.cs.html#08e004d466c0e2f9" class="t t">KnownHosts</a>))
			{
				<a href="#a14ba590db0163e9" class="i field">hostkey</a> = ((<a href="KnownHosts.cs.html#08e004d466c0e2f9" class="t t">KnownHosts</a>)<span class="r53 r">hkr</span>).<a href="KnownHosts.cs.html#5d4624b55f5e7473" class="i method">CreateHashedHostKey</a>(<span class="r46 r">chost</span>, <span class="r50 r">K_S</span>);
			}
			<b>else</b>
			{
				<a href="#a14ba590db0163e9" class="i field">hostkey</a> = <b>new</b> <a href="HostKey.cs.html#834f61cbba935a93" class="t constructor">HostKey</a>(<span class="r46 r">chost</span>, <span class="r50 r">K_S</span>);
			}
			<b>if</b> (<span class="r55 r">insert</span>)
			{
				<b>lock</b> (<span class="r53 r">hkr</span>)
				{
					<span class="r53 r">hkr</span>.<a href="HostKeyRepository.cs.html#b25dbecf52d2a193" class="i method">Add</a>(<a href="#a14ba590db0163e9" class="i field">hostkey</a>, <a href="#db6703f509870e09" class="i field">userinfo</a>);
				}
			}
		}

		<span class="c">//public void start(){ (new Thread(this)).start();  }</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual</b> <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <a id="8411a4a45e904e3c" href="../R/8411a4a45e904e3c.html" target="n" data-glyph="72,1" class="i method">OpenChannel</a>(<b>string</b> <span id="r61 rd" class="r61 r">type</span>)
		{
			<b>if</b> (!<a href="#4abfa4fb08e3731c" class="i field">isConnected</a>)
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;session is down&quot;</span>);
			}
			<b>try</b>
			{
				<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <span id="r62 rd" class="r62 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#5370fa8f8d8d4adb" class="i method">GetChannel</a>(<span class="r61 r">type</span>);
				<a href="#57b777872ce77a20" class="i method">AddChannel</a>(<span class="r62 r">channel</span>);
				<span class="r62 r">channel</span>.<a href="Channel.cs.html#a0ce5fa5d917b00a" class="i method">Init</a>();
				<b>return</b> <span class="r62 r">channel</span>;
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
			{
			}
			<span class="c">//e.printStackTrace();</span>
			<b>return null</b>;
		}

		<span class="c">// encode will bin invoked in write with synchronization.</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="b038b33a80dca60d" href="../R/b038b33a80dca60d.html" target="n" data-glyph="72,1" class="i method">Encode</a>(<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r63 rd" class="r63 r">packet</span>)
		{
			<span class="c">//System.err.println(&quot;encode: &quot;+packet.buffer.getCommand());</span>
			<span class="c">//System.err.println(&quot;        &quot;+packet.buffer.index);</span>
			<span class="c">//if(packet.buffer.getCommand()==96){</span>
			<span class="c">//Thread.dumpStack();</span>
			<span class="c">//}</span>
			<b>if</b> (<a href="#fe62776ddd16a6bd" class="i field">deflater</a> != <b>null</b>)
			{
				<a href="#f036ba14fe1b5ad5" class="i field">compress_len</a>[0] = <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>;
				<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a> = <a href="#fe62776ddd16a6bd" class="i field">deflater</a>.<a href="Compression.cs.html#4ea91f00a7579a62" class="i method">Compress</a>(<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 5, <a href="#f036ba14fe1b5ad5" class="i field">compress_len</a>);
				<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> = <a href="#f036ba14fe1b5ad5" class="i field">compress_len</a>[0];
			}
			<b>if</b> (<a href="#5805a27d2b691225" class="i field">c2scipher</a> != <b>null</b>)
			{
				<span class="c">//packet.padding(c2scipher.getIVSize());</span>
				<span class="r63 r">packet</span>.<a href="Packet.cs.html#8a0de0886c100b9b" class="i method">Padding</a>(<a href="#ae0713223a47c8d7" class="i field">c2scipher_size</a>);
				<b>int</b> <span id="r64 rd" class="r64 r">pad</span> = <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[4];
				<b>lock</b> (<a href="#c6706870ca880511" class="i field">random</a>)
				{
					<a href="#c6706870ca880511" class="i field">random</a>.<a href="Random.cs.html#cb96f3cbbfb5358d" class="i method">Fill</a>(<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> - <span class="r64 r">pad</span>, <span class="r64 r">pad</span>);
				}
			}
			<b>else</b>
			{
				<span class="r63 r">packet</span>.<a href="Packet.cs.html#8a0de0886c100b9b" class="i method">Padding</a>(8);
			}
			<b>if</b> (<a href="#1adab18fdf624dce" class="i field">c2smac</a> != <b>null</b>)
			{
				<a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#0fbc1b56e9a931ab" class="i method">Update</a>(<a href="#60f7215ff9f1e0be" class="i field">seqo</a>);
				<a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#e15c7a6378fe4e4e" class="i method">Update</a>(<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
				<a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#a6a8d2a8aadbcc6a" class="i method">DoFinal</a>(<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			}
			<b>if</b> (<a href="#5805a27d2b691225" class="i field">c2scipher</a> != <b>null</b>)
			{
				<b>byte</b>[] <span id="r65 rd" class="r65 r">buf</span> = <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>;
				<a href="#5805a27d2b691225" class="i field">c2scipher</a>.<a href="Cipher.cs.html#60bdc531a8b9eb87" class="i method">Update</a>(<span class="r65 r">buf</span>, 0, <span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>, <span class="r65 r">buf</span>, 0);
			}
			<b>if</b> (<a href="#1adab18fdf624dce" class="i field">c2smac</a> != <b>null</b>)
			{
				<span class="r63 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#ec7e1e853698309a" class="i method">Skip</a>(<a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#15ffc4086f5087c3" class="i method">GetBlockSize</a>());
			}
		}

		<b>internal int</b>[] <a id="3a3a877223ae6762" href="../R/3a3a877223ae6762.html" target="n" data-glyph="44,1" class="i field">uncompress_len</a> = <b>new</b> <b>int</b>[1];

		<b>internal int</b>[] <a id="f036ba14fe1b5ad5" href="../R/f036ba14fe1b5ad5.html" target="n" data-glyph="44,1" class="i field">compress_len</a> = <b>new</b> <b>int</b>[1];

		<b>private int</b> <a id="1344b48bcb1429f6" href="../R/1344b48bcb1429f6.html" target="n" data-glyph="46,1" class="i field">s2ccipher_size</a> = 8;

		<b>private int</b> <a id="ae0713223a47c8d7" href="../R/ae0713223a47c8d7.html" target="n" data-glyph="46,1" class="i field">c2scipher_size</a> = 8;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual</b> <a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <a id="f1672c97029d017f" href="../R/f1672c97029d017f.html" target="n" data-glyph="72,1" class="i method">Read</a>(<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r66 rd" class="r66 r">buf</span>)
		{
			<b>int</b> <span id="r67 rd" class="r67 r">j</span> = 0;
			<b>while</b> (<b>true</b>)
			{
				<span class="r66 r">buf</span>.<a href="Buffer.cs.html#18387319e44d9605" class="i method">Reset</a>();
				<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#2e8d097dc1aaffb2" class="i method">GetByte</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>, <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>);
				<span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> += <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>;
				<b>if</b> (<a href="#b60669493962e185" class="i field">s2ccipher</a> != <b>null</b>)
				{
					<a href="#b60669493962e185" class="i field">s2ccipher</a>.<a href="Cipher.cs.html#60bdc531a8b9eb87" class="i method">Update</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0);
				}
				<span class="r67 r">j</span> = ((<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[0] &lt;&lt; 24) &amp; <b>unchecked</b>((<b>int</b>)(0xff000000))) | ((<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[1] &lt;&lt; 16
					) &amp; <b>unchecked</b>((<b>int</b>)(0x00ff0000))) | ((<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[2] &lt;&lt; 8) &amp; <b>unchecked</b>((<b>int</b>)(0x0000ff00
					))) | ((<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[3]) &amp; <b>unchecked</b>((<b>int</b>)(0x000000ff)));
				<span class="c">// RFC 4253 6.1. Maximum Packet Length</span>
				<b>if</b> (<span class="r67 r">j</span> &lt; 5 || <span class="r67 r">j</span> &gt; <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a>)
				{
					<a href="#8e10764843b5f219" class="i method">Start_discard</a>(<span class="r66 r">buf</span>, <a href="#b60669493962e185" class="i field">s2ccipher</a>, <a href="#6267ce77b9c28218" class="i field">s2cmac</a>, <span class="r67 r">j</span>, <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a>);
				}
				<b>int</b> <span id="r68 rd" class="r68 r">need</span> = <span class="r67 r">j</span> + 4 - <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>;
				<span class="c">//if(need&lt;0){</span>
				<span class="c">//  throw new IOException(&quot;invalid data&quot;);</span>
				<span class="c">//}</span>
				<b>if</b> ((<span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> + <span class="r68 r">need</span>) &gt; <span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
				{
					<b>byte</b>[] <span id="r69 rd" class="r69 r">foo</span> = <b>new</b> <b>byte</b>[<span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> + <span class="r68 r">need</span>];
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <span class="r69 r">foo</span>, 0, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
					<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a> = <span class="r69 r">foo</span>;
				}
				<b>if</b> ((<span class="r68 r">need</span> % <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>) != 0)
				{
					<b>string</b> <span id="r70 rd" class="r70 r">message</span> = <span class="s">&quot;Bad packet length &quot;</span> + <span class="r68 r">need</span>;
					<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#d601e3bb88c15da2" class="i field">FATAL</a>))
					{
						<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#d601e3bb88c15da2" class="i field">FATAL</a>, <span class="r70 r">message</span>);
					}
					<a href="#8e10764843b5f219" class="i method">Start_discard</a>(<span class="r66 r">buf</span>, <a href="#b60669493962e185" class="i field">s2ccipher</a>, <a href="#6267ce77b9c28218" class="i field">s2cmac</a>, <span class="r67 r">j</span>, <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a> - <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>);
				}
				<b>if</b> (<span class="r68 r">need</span> &gt; 0)
				{
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#2e8d097dc1aaffb2" class="i method">GetByte</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>, <span class="r68 r">need</span>);
					<span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> += (<span class="r68 r">need</span>);
					<b>if</b> (<a href="#b60669493962e185" class="i field">s2ccipher</a> != <b>null</b>)
					{
						<a href="#b60669493962e185" class="i field">s2ccipher</a>.<a href="Cipher.cs.html#60bdc531a8b9eb87" class="i method">Update</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>, <span class="r68 r">need</span>, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, <a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a>);
					}
				}
				<b>if</b> (<a href="#6267ce77b9c28218" class="i field">s2cmac</a> != <b>null</b>)
				{
					<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#0fbc1b56e9a931ab" class="i method">Update</a>(<a href="#4f87f223bf75c532" class="i field">seqi</a>);
					<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#e15c7a6378fe4e4e" class="i method">Update</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
					<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#a6a8d2a8aadbcc6a" class="i method">DoFinal</a>(<a href="#70eaa3cfc7fbc545" class="i field">s2cmac_result1</a>, 0);
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#2e8d097dc1aaffb2" class="i method">GetByte</a>(<a href="#c6ff516beefc50c1" class="i field">s2cmac_result2</a>, 0, <a href="#c6ff516beefc50c1" class="i field">s2cmac_result2</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<b>if</b> (!<a href="/Sharpen/A.html#7342d8d23595dd8e" class="t t">Arrays</a>.<a href="/Sharpen/A.html#50f3bfce6629d114" class="i method">Equals</a>(<a href="#70eaa3cfc7fbc545" class="i field">s2cmac_result1</a>, <a href="#c6ff516beefc50c1" class="i field">s2cmac_result2</a>))
					{
						<b>if</b> (<span class="r68 r">need</span> &gt; <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a>)
						{
							<b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#db370b64091ac4df" class="t constructor">IOException</a>(<span class="s">&quot;MAC Error&quot;</span>);
						}
						<a href="#8e10764843b5f219" class="i method">Start_discard</a>(<span class="r66 r">buf</span>, <a href="#b60669493962e185" class="i field">s2ccipher</a>, <a href="#6267ce77b9c28218" class="i field">s2cmac</a>, <span class="r67 r">j</span>, <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a> - <span class="r68 r">need</span>);
						<b>continue</b>;
					}
				}
				<a href="#4f87f223bf75c532" class="i field">seqi</a>++;
				<b>if</b> (<a href="#57cdef084060c615" class="i field">inflater</a> != <b>null</b>)
				{
					<span class="c">//inflater.uncompress(buf);</span>
					<b>int</b> <span id="r71 rd" class="r71 r">pad</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[4];
					<a href="#3a3a877223ae6762" class="i field">uncompress_len</a>[0] = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> - 5 - <span class="r71 r">pad</span>;
					<b>byte</b>[] <span id="r72 rd" class="r72 r">foo</span> = <a href="#57cdef084060c615" class="i field">inflater</a>.<a href="Compression.cs.html#1b5c1a34d5755fa5" class="i method">Uncompress</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 5, <a href="#3a3a877223ae6762" class="i field">uncompress_len</a>);
					<b>if</b> (<span class="r72 r">foo</span> != <b>null</b>)
					{
						<span class="r66 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a> = <span class="r72 r">foo</span>;
						<span class="r66 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> = 5 + <a href="#3a3a877223ae6762" class="i field">uncompress_len</a>[0];
					}
					<b>else</b>
					{
						<span class="i n">System</span>.<a href="@0@mscorlib/A.html#f907d79481da6ba4" class="t t">Console</a>.<a href="@0@mscorlib/A.html#7c403e083a0bb390" class="i property">Error</a>.<a href="@0@mscorlib/A.html#5238cceaebfeaa74" class="i method">WriteLine</a>(<span class="s">&quot;fail in inflater&quot;</span>);
						<b>break</b>;
					}
				}
				<b>int</b> <span id="r73 rd" class="r73 r">type</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>() &amp; <b>unchecked</b>((<b>int</b>)(0xff));
				<span class="c">//System.err.println(&quot;read: &quot;+type);</span>
				<b>if</b> (<span class="r73 r">type</span> == <a href="#6901129ba842857e" class="i field">SSH_MSG_DISCONNECT</a>)
				{
					<span class="r66 r">buf</span>.<a href="Buffer.cs.html#d524bf752711cc4a" class="i method">Rewind</a>();
					<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
					<span class="r66 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
					<b>int</b> <span id="r74 rd" class="r74 r">reason_code</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
					<b>byte</b>[] <span id="r75 rd" class="r75 r">description</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#d7ae0c5e17ba9ef9" class="i method">GetString</a>();
					<b>byte</b>[] <span id="r76 rd" class="r76 r">language_tag</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#d7ae0c5e17ba9ef9" class="i method">GetString</a>();
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;SSH_MSG_DISCONNECT: &quot;</span> + <span class="r74 r">reason_code</span> + <span class="s">&quot; &quot;</span> + <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>
						(<span class="r75 r">description</span>) + <span class="s">&quot; &quot;</span> + <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<span class="r76 r">language_tag</span>));
				}
				<b>else</b>
				{
					<span class="c">//break;</span>
					<b>if</b> (<span class="r73 r">type</span> == <a href="#8556f5a2c6fd264b" class="i field">SSH_MSG_IGNORE</a>)
					{
					}
					<b>else</b>
					{
						<b>if</b> (<span class="r73 r">type</span> == <a href="#11f5be3bdb161271" class="i field">SSH_MSG_UNIMPLEMENTED</a>)
						{
							<span class="r66 r">buf</span>.<a href="Buffer.cs.html#d524bf752711cc4a" class="i method">Rewind</a>();
							<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r66 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<b>int</b> <span id="r77 rd" class="r77 r">reason_id</span> = <span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
							{
								<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Received SSH_MSG_UNIMPLEMENTED for &quot;</span> + <span class="r77 r">reason_id</span>
									);
							}
						}
						<b>else</b>
						{
							<b>if</b> (<span class="r73 r">type</span> == <a href="#04c90d6a81fa80a0" class="i field">SSH_MSG_DEBUG</a>)
							{
								<span class="r66 r">buf</span>.<a href="Buffer.cs.html#d524bf752711cc4a" class="i method">Rewind</a>();
								<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
								<span class="r66 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							}
							<b>else</b>
							{
								<b>if</b> (<span class="r73 r">type</span> == <a href="#4a72a00f3da6f6e8" class="i field">SSH_MSG_CHANNEL_WINDOW_ADJUST</a>)
								{
									<span class="r66 r">buf</span>.<a href="Buffer.cs.html#d524bf752711cc4a" class="i method">Rewind</a>();
									<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
									<span class="r66 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
									<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <span id="r78 rd" class="r78 r">c</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>(), <a href="#9447883c1d8c7b7f" class="k">this</a>);
									<b>if</b> (<span class="r78 r">c</span> == <b>null</b>)
									{
									}
									<b>else</b>
									{
										<span class="r78 r">c</span>.<a href="Channel.cs.html#e8c75da9f32ca727" class="i method">AddRemoteWindowSize</a>(<span class="r66 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>());
									}
								}
								<b>else</b>
								{
									<b>if</b> (<span class="r73 r">type</span> == <a href="UserAuth.cs.html#5abee9f0959059d5" class="t t">UserAuth</a>.<a href="UserAuth.cs.html#20890cb613d98700" class="i field">SSH_MSG_USERAUTH_SUCCESS</a>)
									{
										<a href="#9d201effb55c3143" class="i field">isAuthed</a> = <b>true</b>;
										<b>if</b> (<a href="#57cdef084060c615" class="i field">inflater</a> == <b>null</b> &amp;&amp; <a href="#fe62776ddd16a6bd" class="i field">deflater</a> == <b>null</b>)
										{
											<b>string</b> <span id="r79 rd" class="r79 r">method</span>;
											<span class="r79 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#83b7f46995d943c2" class="i field">PROPOSAL_COMP_ALGS_CTOS</a>];
											<a href="#0fdfc9e1df305477" class="i method">InitDeflater</a>(<span class="r79 r">method</span>);
											<span class="r79 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#17688cb4cf220d81" class="i field">PROPOSAL_COMP_ALGS_STOC</a>];
											<a href="#0e07215720abc886" class="i method">InitInflater</a>(<span class="r79 r">method</span>);
										}
										<b>break</b>;
									}
									<b>else</b>
									{
										<b>break</b>;
									}
								}
							}
						}
					}
				}
			}
			<span class="r66 r">buf</span>.<a href="Buffer.cs.html#d524bf752711cc4a" class="i method">Rewind</a>();
			<b>return</b> <span class="r66 r">buf</span>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<span class="i n">IO</span>.<a href="@0@mscorlib/A.html#bf546e435199e83c" class="t t">IOException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="8e10764843b5f219" href="../R/8e10764843b5f219.html" target="n" data-glyph="76,1" class="i method">Start_discard</a>(<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r80 rd" class="r80 r">buf</span>, <span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a> <span id="r81 rd" class="r81 r">cipher</span>, <a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a> <span id="r82 rd" class="r82 r">mac</span>, <b>int</b> <span id="r83 rd" class="r83 r">packet_length</span>
			, <b>int</b> <span id="r84 rd" class="r84 r">discard</span>)
		{
			<a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a> <span id="r85 rd" class="r85 r">discard_mac</span> = <b>null</b>;
			<b>if</b> (!<span class="r81 r">cipher</span>.<a href="Cipher.cs.html#90e5a212578478d3" class="i method">IsCBC</a>())
			{
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Packet corrupt&quot;</span>);
			}
			<b>if</b> (<span class="r83 r">packet_length</span> != <a href="#827c2c290094450b" class="i field">PACKET_MAX_SIZE</a> &amp;&amp; <span class="r82 r">mac</span> != <b>null</b>)
			{
				<span class="r85 r">discard_mac</span> = <span class="r82 r">mac</span>;
			}
			<span class="r84 r">discard</span> -= <span class="r80 r">buf</span>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>;
			<b>while</b> (<span class="r84 r">discard</span> &gt; 0)
			{
				<span class="r80 r">buf</span>.<a href="Buffer.cs.html#18387319e44d9605" class="i method">Reset</a>();
				<b>int</b> <span id="r86 rd" class="r86 r">len</span> = <span class="r84 r">discard</span> &gt; <span class="r80 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> ? <span class="r80 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> : <span class="r84 r">discard</span>;
				<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#2e8d097dc1aaffb2" class="i method">GetByte</a>(<span class="r80 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <span class="r86 r">len</span>);
				<b>if</b> (<span class="r85 r">discard_mac</span> != <b>null</b>)
				{
					<span class="r85 r">discard_mac</span>.<a href="MAC.cs.html#e15c7a6378fe4e4e" class="i method">Update</a>(<span class="r80 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <span class="r86 r">len</span>);
				}
				<span class="r84 r">discard</span> -= <span class="r86 r">len</span>;
			}
			<b>if</b> (<span class="r85 r">discard_mac</span> != <b>null</b>)
			{
				<span class="r85 r">discard_mac</span>.<a href="MAC.cs.html#a6a8d2a8aadbcc6a" class="i method">DoFinal</a>(<span class="r80 r">buf</span>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0);
			}
			<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;Packet corrupt&quot;</span>);
		}

		<b>internal virtual byte</b>[] <a id="f1c49ce47552d847" href="../R/f1c49ce47552d847.html" target="n" data-glyph="74,1" class="i method">GetSessionId</a>()
		{
			<b>return</b> <a href="#c5ca410c2658e737" class="i field">session_id</a>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="f7e7d8d22e54bb88" href="../R/f7e7d8d22e54bb88.html" target="n" data-glyph="76,1" class="i method">Receive_newkeys</a>(<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r87 rd" class="r87 r">buf</span>, <a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r88 rd" class="r88 r">kex</span>)
		{
			<a href="#c571ef03b4cefa07" class="i method">UpdateKeys</a>(<span class="r88 r">kex</span>);
			<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="c571ef03b4cefa07" href="../R/c571ef03b4cefa07.html" target="n" data-glyph="76,1" class="i method">UpdateKeys</a>(<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r89 rd" class="r89 r">kex</span>)
		{
			<b>byte</b>[] <span id="r90 rd" class="r90 r">K</span> = <span class="r89 r">kex</span>.<a href="KeyExchange.cs.html#2d48d23de2fe389d" class="i method">GetK</a>();
			<b>byte</b>[] <span id="r91 rd" class="r91 r">H</span> = <span class="r89 r">kex</span>.<a href="KeyExchange.cs.html#0bb7f6f1fe659533" class="i method">GetH</a>();
			<a href="HASH.cs.html#54de76954ded55eb" class="t t">HASH</a> <span id="r92 rd" class="r92 r">hash</span> = <span class="r89 r">kex</span>.<a href="KeyExchange.cs.html#660d1ca4fe0f02ec" class="i method">GetHash</a>();
			<span class="c">//    String[] guess=kex.guess;</span>
			<b>if</b> (<a href="#c5ca410c2658e737" class="i field">session_id</a> == <b>null</b>)
			{
				<a href="#c5ca410c2658e737" class="i field">session_id</a> = <b>new</b> <b>byte</b>[<span class="r91 r">H</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>];
				<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r91 r">H</span>, 0, <a href="#c5ca410c2658e737" class="i field">session_id</a>, 0, <span class="r91 r">H</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
			}
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#18387319e44d9605" class="i method">Reset</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#dba16b8083f6c1e4" class="i method">PutMPInt</a>(<span class="r90 r">K</span>);
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<span class="r91 r">H</span>);
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<b>unchecked</b>((<b>int</b>)(0x41))));
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<a href="#c5ca410c2658e737" class="i field">session_id</a>);
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#82851712d28e8cee" class="i field">IVc2s</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<b>int</b> <span id="r93 rd" class="r93 r">j</span> = <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a> - <a href="#c5ca410c2658e737" class="i field">session_id</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> - 1;
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r93 r">j</span>]++;
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#5b2badb120b43641" class="i field">IVs2c</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r93 r">j</span>]++;
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#018c8f473dff058d" class="i field">Ec2s</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r93 r">j</span>]++;
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#aca49bdfa4d33386" class="i field">Es2c</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r93 r">j</span>]++;
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#6c3a65c9a5cdd6f2" class="i field">MACc2s</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>[<span class="r93 r">j</span>]++;
			<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
			<a href="#481e41b555bfd531" class="i field">MACs2c</a> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
			<b>try</b>
			{
				<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r94 rd" class="r94 r">c</span>;
				<b>string</b> <span id="r95 rd" class="r95 r">method</span>;
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#717e315a8759c8ed" class="i field">PROPOSAL_ENC_ALGS_STOC</a>];
				<span class="r94 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r95 r">method</span>));
				<a href="#b60669493962e185" class="i field">s2ccipher</a> = (<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r94 r">c</span>));
				<b>while</b> (<a href="#b60669493962e185" class="i field">s2ccipher</a>.<a href="Cipher.cs.html#64b8b78bddbbd9c6" class="i method">GetBlockSize</a>() &gt; <a href="#aca49bdfa4d33386" class="i field">Es2c</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
				{
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#18387319e44d9605" class="i method">Reset</a>();
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#dba16b8083f6c1e4" class="i method">PutMPInt</a>(<span class="r90 r">K</span>);
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<span class="r91 r">H</span>);
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<a href="#aca49bdfa4d33386" class="i field">Es2c</a>);
					<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
					<b>byte</b>[] <span id="r96 rd" class="r96 r">foo</span> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
					<b>byte</b>[] <span id="r97 rd" class="r97 r">bar</span> = <b>new</b> <b>byte</b>[<a href="#aca49bdfa4d33386" class="i field">Es2c</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> + <span class="r96 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>];
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<a href="#aca49bdfa4d33386" class="i field">Es2c</a>, 0, <span class="r97 r">bar</span>, 0, <a href="#aca49bdfa4d33386" class="i field">Es2c</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r96 r">foo</span>, 0, <span class="r97 r">bar</span>, <a href="#aca49bdfa4d33386" class="i field">Es2c</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r96 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<a href="#aca49bdfa4d33386" class="i field">Es2c</a> = <span class="r97 r">bar</span>;
				}
				<a href="#b60669493962e185" class="i field">s2ccipher</a>.<a href="Cipher.cs.html#827aa331e9c4ef6d" class="i method">Init</a>(<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>.<a href="Cipher.cs.html#114d78182f7c4c02" class="i field">DECRYPT_MODE</a>, <a href="#aca49bdfa4d33386" class="i field">Es2c</a>, <a href="#5b2badb120b43641" class="i field">IVs2c</a>);
				<a href="#1344b48bcb1429f6" class="i field">s2ccipher_size</a> = <a href="#b60669493962e185" class="i field">s2ccipher</a>.<a href="Cipher.cs.html#43b43c0e9f7c041b" class="i method">GetIVSize</a>();
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#649ca82c26d61e7e" class="i field">PROPOSAL_MAC_ALGS_STOC</a>];
				<span class="r94 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r95 r">method</span>));
				<a href="#6267ce77b9c28218" class="i field">s2cmac</a> = (<a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r94 r">c</span>));
				<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#e4bd51f209b4a4f4" class="i method">Init</a>(<a href="#481e41b555bfd531" class="i field">MACs2c</a>);
				<span class="c">//mac_buf=new byte[s2cmac.getBlockSize()];</span>
				<a href="#70eaa3cfc7fbc545" class="i field">s2cmac_result1</a> = <b>new</b> <b>byte</b>[<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#15ffc4086f5087c3" class="i method">GetBlockSize</a>()];
				<a href="#c6ff516beefc50c1" class="i field">s2cmac_result2</a> = <b>new</b> <b>byte</b>[<a href="#6267ce77b9c28218" class="i field">s2cmac</a>.<a href="MAC.cs.html#15ffc4086f5087c3" class="i method">GetBlockSize</a>()];
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#54cf85d9f6b9bcf4" class="i field">PROPOSAL_ENC_ALGS_CTOS</a>];
				<span class="r94 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r95 r">method</span>));
				<a href="#5805a27d2b691225" class="i field">c2scipher</a> = (<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r94 r">c</span>));
				<b>while</b> (<a href="#5805a27d2b691225" class="i field">c2scipher</a>.<a href="Cipher.cs.html#64b8b78bddbbd9c6" class="i method">GetBlockSize</a>() &gt; <a href="#018c8f473dff058d" class="i field">Ec2s</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>)
				{
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#18387319e44d9605" class="i method">Reset</a>();
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#dba16b8083f6c1e4" class="i method">PutMPInt</a>(<span class="r90 r">K</span>);
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<span class="r91 r">H</span>);
					<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#f2d287d3186bd9fc" class="i method">PutByte</a>(<a href="#018c8f473dff058d" class="i field">Ec2s</a>);
					<span class="r92 r">hash</span>.<a href="HASH.cs.html#51db2e6d267da9d3" class="i method">Update</a>(<a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#5f2c9a94e380f60f" class="i field">buffer</a>, 0, <a href="#c9533f8905ab0b0d" class="i field">buf</a>.<a href="Buffer.cs.html#ae9480473e9538fd" class="i field">index</a>);
					<b>byte</b>[] <span id="r98 rd" class="r98 r">foo</span> = <span class="r92 r">hash</span>.<a href="HASH.cs.html#d3a36cb07d737254" class="i method">Digest</a>();
					<b>byte</b>[] <span id="r99 rd" class="r99 r">bar</span> = <b>new</b> <b>byte</b>[<a href="#018c8f473dff058d" class="i field">Ec2s</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a> + <span class="r98 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>];
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<a href="#018c8f473dff058d" class="i field">Ec2s</a>, 0, <span class="r99 r">bar</span>, 0, <a href="#018c8f473dff058d" class="i field">Ec2s</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r98 r">foo</span>, 0, <span class="r99 r">bar</span>, <a href="#018c8f473dff058d" class="i field">Ec2s</a>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>, <span class="r98 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
					<a href="#018c8f473dff058d" class="i field">Ec2s</a> = <span class="r99 r">bar</span>;
				}
				<a href="#5805a27d2b691225" class="i field">c2scipher</a>.<a href="Cipher.cs.html#827aa331e9c4ef6d" class="i method">Init</a>(<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>.<a href="Cipher.cs.html#7892e6892db1524e" class="i field">ENCRYPT_MODE</a>, <a href="#018c8f473dff058d" class="i field">Ec2s</a>, <a href="#82851712d28e8cee" class="i field">IVc2s</a>);
				<a href="#ae0713223a47c8d7" class="i field">c2scipher_size</a> = <a href="#5805a27d2b691225" class="i field">c2scipher</a>.<a href="Cipher.cs.html#43b43c0e9f7c041b" class="i method">GetIVSize</a>();
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#1dfa59c9950d24ec" class="i field">PROPOSAL_MAC_ALGS_CTOS</a>];
				<span class="r94 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r95 r">method</span>));
				<a href="#1adab18fdf624dce" class="i field">c2smac</a> = (<a href="MAC.cs.html#4b9111c7e05965d8" class="t t">MAC</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r94 r">c</span>));
				<a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#e4bd51f209b4a4f4" class="i method">Init</a>(<a href="#6c3a65c9a5cdd6f2" class="i field">MACc2s</a>);
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#83b7f46995d943c2" class="i field">PROPOSAL_COMP_ALGS_CTOS</a>];
				<a href="#0fdfc9e1df305477" class="i method">InitDeflater</a>(<span class="r95 r">method</span>);
				<span class="r95 r">method</span> = <a href="#c71d800be7c637d4" class="i field">guess</a>[<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>.<a href="KeyExchange.cs.html#17688cb4cf220d81" class="i field">PROPOSAL_COMP_ALGS_STOC</a>];
				<a href="#0e07215720abc886" class="i method">InitInflater</a>(<span class="r95 r">method</span>);
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r100 rd" class="r100 r">e</span>)
			{
				<b>if</b> (<span class="r100 r">e</span> <b>is</b> <a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a>)
				{
					<b>throw</b>;
				}
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r100 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r100 r">e</span>);
			}
		}

		<span class="c">//System.err.println(&quot;updatekeys: &quot;+e); </span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>internal virtual void</b> <a id="e0bf6822ed1dd13a" href="../R/e0bf6822ed1dd13a.html" target="n" data-glyph="74,1" class="i method">Write</a>(<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r101 rd" class="r101 r">packet</span>, <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <span id="r102 rd" class="r102 r">c</span>, <b>int</b> <span id="r103 rd" class="r103 r">length</span>)
		{
			<b>long</b> <span id="r104 rd" class="r104 r">t</span> = <a href="#796657ea79a25a7b" class="i method">GetTimeout</a>();
			<b>while</b> (<b>true</b>)
			{
				<b>if</b> (<a href="#c76805519b7a0e7c" class="i field">in_kex</a>)
				{
					<b>if</b> (<span class="r104 r">t</span> &gt; 0L &amp;&amp; (<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#e138393156840d80" class="i method">CurrentTimeMillis</a>() - <a href="#09138aef4c73af81" class="i field">kex_start_time</a>) &gt; <span class="r104 r">t</span>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;timeout in wating for rekeying process.&quot;</span>);
					}
					<b>try</b>
					{
						<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a>.<a href="/Sharpen/A.html#7fe5d5fe7cd5df12" class="i method">Sleep</a>(10);
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
					{
					}
					<b>continue</b>;
				}
				<b>lock</b> (<span class="r102 r">c</span>)
				{
					<b>if</b> (<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> &lt; <span class="r103 r">length</span>)
					{
						<b>try</b>
						{
							<span class="r102 r">c</span>.<a href="Channel.cs.html#155a338ca71147e3" class="i field">notifyme</a>++;
							<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#db416a8cb30585bd" class="i method">Wait</a>(<span class="r102 r">c</span>, 100);
						}
						<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
						{
						}
						<b>finally</b>
						{
							<span class="r102 r">c</span>.<a href="Channel.cs.html#155a338ca71147e3" class="i field">notifyme</a>--;
						}
					}
					<b>if</b> (<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> &gt;= <span class="r103 r">length</span>)
					{
						<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> -= <span class="r103 r">length</span>;
						<b>break</b>;
					}
				}
				<b>if</b> (<span class="r102 r">c</span>.<a href="Channel.cs.html#c9fd70d4a7f7a5de" class="i field">close</a> || !<span class="r102 r">c</span>.<a href="Channel.cs.html#ec2125f2d537f685" class="i method">IsConnected</a>())
				{
					<b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#db370b64091ac4df" class="t constructor">IOException</a>(<span class="s">&quot;channel is broken&quot;</span>);
				}
				<b>bool</b> <span id="r105 rd" class="r105 r">sendit</span> = <b>false</b>;
				<b>int</b> <span id="r106 rd" class="r106 r">s</span> = 0;
				<b>byte</b> <span id="r107 rd" class="r107 r">command</span> = 0;
				<b>int</b> <span id="r108 rd" class="r108 r">recipient</span> = -1;
				<b>lock</b> (<span class="r102 r">c</span>)
				{
					<b>if</b> (<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> &gt; 0)
					{
						<b>long</b> <span id="r109 rd" class="r109 r">len</span> = <span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a>;
						<b>if</b> (<span class="r109 r">len</span> &gt; <span class="r103 r">length</span>)
						{
							<span class="r109 r">len</span> = <span class="r103 r">length</span>;
						}
						<b>if</b> (<span class="r109 r">len</span> != <span class="r103 r">length</span>)
						{
							<span class="r106 r">s</span> = <span class="r101 r">packet</span>.<a href="Packet.cs.html#a25a1cf3bb3bda46" class="i method">Shift</a>((<b>int</b>)<span class="r109 r">len</span>, (<a href="#5805a27d2b691225" class="i field">c2scipher</a> != <b>null</b> ? <a href="#ae0713223a47c8d7" class="i field">c2scipher_size</a> : 8), (<a href="#1adab18fdf624dce" class="i field">c2smac</a> != <b>null</b>
								 ? <a href="#1adab18fdf624dce" class="i field">c2smac</a>.<a href="MAC.cs.html#15ffc4086f5087c3" class="i method">GetBlockSize</a>() : 0));
						}
						<span class="r107 r">command</span> = <span class="r101 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>();
						<span class="r108 r">recipient</span> = <span class="r102 r">c</span>.<a href="Channel.cs.html#97edb8f20c9cf72a" class="i method">GetRecipient</a>();
						<span class="r103 r">length</span> -= (<b>int</b>)<span class="r109 r">len</span>;
						<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> -= <span class="r109 r">len</span>;
						<span class="r105 r">sendit</span> = <b>true</b>;
					}
				}
				<b>if</b> (<span class="r105 r">sendit</span>)
				{
					<a href="#0e8e1d53448e3579" class="i method">_write</a>(<span class="r101 r">packet</span>);
					<b>if</b> (<span class="r103 r">length</span> == 0)
					{
						<b>return</b>;
					}
					<span class="r101 r">packet</span>.<a href="Packet.cs.html#aaf852a122e2c63d" class="i method">Unshift</a>(<span class="r107 r">command</span>, <span class="r108 r">recipient</span>, <span class="r106 r">s</span>, <span class="r103 r">length</span>);
				}
				<b>lock</b> (<span class="r102 r">c</span>)
				{
					<b>if</b> (<a href="#c76805519b7a0e7c" class="i field">in_kex</a>)
					{
						<b>continue</b>;
					}
					<b>if</b> (<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> &gt;= <span class="r103 r">length</span>)
					{
						<span class="r102 r">c</span>.<a href="Channel.cs.html#8af92ea30ec0295e" class="i field">rwsize</a> -= <span class="r103 r">length</span>;
						<b>break</b>;
					}
				}
			}
			<span class="c">//try{ </span>
			<span class="c">//System.out.println(&quot;1wait: &quot;+c.rwsize);</span>
			<span class="c">//  c.notifyme++;</span>
			<span class="c">//  c.wait(100); </span>
			<span class="c">//}</span>
			<span class="c">//catch(java.lang.InterruptedException e){</span>
			<span class="c">//}</span>
			<span class="c">//finally{</span>
			<span class="c">//  c.notifyme--;</span>
			<span class="c">//}</span>
			<a href="#0e8e1d53448e3579" class="i method">_write</a>(<span class="r101 r">packet</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="3023fd09cf504160" href="../R/3023fd09cf504160.html" target="n" data-glyph="72,1" class="i method">Write</a>(<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r110 rd" class="r110 r">packet</span>)
		{
			<span class="c">// System.err.println(&quot;in_kex=&quot;+in_kex+&quot; &quot;+(packet.buffer.getCommand()));</span>
			<b>long</b> <span id="r111 rd" class="r111 r">t</span> = <a href="#796657ea79a25a7b" class="i method">GetTimeout</a>();
			<b>while</b> (<a href="#c76805519b7a0e7c" class="i field">in_kex</a>)
			{
				<b>if</b> (<span class="r111 r">t</span> &gt; 0L &amp;&amp; (<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#e138393156840d80" class="i method">CurrentTimeMillis</a>() - <a href="#09138aef4c73af81" class="i field">kex_start_time</a>) &gt; <span class="r111 r">t</span>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;timeout in wating for rekeying process.&quot;</span>);
				}
				<b>byte</b> <span id="r112 rd" class="r112 r">command</span> = <span class="r110 r">packet</span>.<a href="Packet.cs.html#bbbc9847b2050cbc" class="i field">buffer</a>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>();
				<span class="c">//System.err.println(&quot;command: &quot;+command);</span>
				<b>if</b> (<span class="r112 r">command</span> == <a href="#fa37ec3e1195635d" class="i field">SSH_MSG_KEXINIT</a> || <span class="r112 r">command</span> == <a href="#a99d5a0391eb6ca0" class="i field">SSH_MSG_NEWKEYS</a> || <span class="r112 r">command</span> == <a href="#caf8ece498631a0d" class="i field">SSH_MSG_KEXDH_INIT</a>
					 || <span class="r112 r">command</span> == <a href="#70c92e5da4273c52" class="i field">SSH_MSG_KEXDH_REPLY</a> || <span class="r112 r">command</span> == <a href="#62aeb34449888918" class="i field">SSH_MSG_KEX_DH_GEX_GROUP</a> || <span class="r112 r">command</span>
					 == <a href="#e6757fb3e16628fa" class="i field">SSH_MSG_KEX_DH_GEX_INIT</a> || <span class="r112 r">command</span> == <a href="#066b63fc2e9684d0" class="i field">SSH_MSG_KEX_DH_GEX_REPLY</a> || <span class="r112 r">command</span> ==
					 <a href="#d27d3eff48daf8a3" class="i field">SSH_MSG_KEX_DH_GEX_REQUEST</a> || <span class="r112 r">command</span> == <a href="#6901129ba842857e" class="i field">SSH_MSG_DISCONNECT</a>)
				{
					<b>break</b>;
				}
				<b>try</b>
				{
					<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a>.<a href="/Sharpen/A.html#7fe5d5fe7cd5df12" class="i method">Sleep</a>(10);
				}
				<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
				{
				}
			}
			<a href="#0e8e1d53448e3579" class="i method">_write</a>(<span class="r110 r">packet</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="0e8e1d53448e3579" href="../R/0e8e1d53448e3579.html" target="n" data-glyph="76,1" class="i method">_write</a>(<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r113 rd" class="r113 r">packet</span>)
		{
			<b>lock</b> (<a href="#2dd88d5f8d13745d" class="i field">Lock</a>)
			{
				<a href="#b038b33a80dca60d" class="i method">Encode</a>(<span class="r113 r">packet</span>);
				<b>if</b> (<a href="#c59740342aed7ca8" class="i field">io</a> != <b>null</b>)
				{
					<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#836b398293a60c2d" class="i method">Put</a>(<span class="r113 r">packet</span>);
					<a href="#60f7215ff9f1e0be" class="i field">seqo</a>++;
				}
			}
		}

		<b>internal</b> <a href="/Sharpen/A.html#f045ac791f6c522f" class="t t">Runnable</a> <a id="458bf4ed59f416ea" href="../R/458bf4ed59f416ea.html" target="n" data-glyph="44,1" class="i field">thread</a>;

		<b>public virtual void</b> <a id="c0bd1bfd1f363f95" href="../R/c0bd1bfd1f363f95.html" target="n" data-glyph="72,1" class="i method">Run</a>()
		{
			<a href="#458bf4ed59f416ea" class="i field">thread</a> = <a href="#9447883c1d8c7b7f" class="k">this</a>;
			<b>byte</b>[] <span id="r114 rd" class="r114 r">foo</span>;
			<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r115 rd" class="r115 r">buf</span> = <b>new</b> <a href="Buffer.cs.html#35c62a99009984d5" class="t constructor">Buffer</a>();
			<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r116 rd" class="r116 r">packet</span> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<span class="r115 r">buf</span>);
			<b>int</b> <span id="r117 rd" class="r117 r">i</span> = 0;
			<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <span id="r118 rd" class="r118 r">channel</span>;
			<b>int</b>[] <span id="r119 rd" class="r119 r">start</span> = <b>new</b> <b>int</b>[1];
			<b>int</b>[] <span id="r120 rd" class="r120 r">length</span> = <b>new</b> <b>int</b>[1];
			<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r121 rd" class="r121 r">kex</span> = <b>null</b>;
			<b>int</b> <span id="r122 rd" class="r122 r">stimeout</span> = 0;
			<b>try</b>
			{
				<b>while</b> (<a href="#4abfa4fb08e3731c" class="i field">isConnected</a> &amp;&amp; <a href="#458bf4ed59f416ea" class="i field">thread</a> != <b>null</b>)
				{
					<b>try</b>
					{
						<span class="r115 r">buf</span> = <a href="#f1672c97029d017f" class="i method">Read</a>(<span class="r115 r">buf</span>);
						<span class="r122 r">stimeout</span> = 0;
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#c832bfca8785698a" class="t t">ThreadInterruptedException</a> <span id="r123 rd" class="r123 r">ee</span>)
					{
						<b>if</b> (!<a href="#c76805519b7a0e7c" class="i field">in_kex</a> &amp;&amp; <span class="r122 r">stimeout</span> &lt; <a href="#a7217574673ef3a2" class="i field">serverAliveCountMax</a>)
						{
							<a href="#22f85a4848bdf6d3" class="i method">SendKeepAliveMsg</a>();
							<span class="r122 r">stimeout</span>++;
							<b>continue</b>;
						}
						<b>else</b>
						{
							<b>if</b> (<a href="#c76805519b7a0e7c" class="i field">in_kex</a> &amp;&amp; <span class="r122 r">stimeout</span> &lt; <a href="#a7217574673ef3a2" class="i field">serverAliveCountMax</a>)
							{
								<span class="r122 r">stimeout</span>++;
								<b>continue</b>;
							}
						}
						<b>throw</b>;
					}
					<b>int</b> <span id="r124 rd" class="r124 r">msgType</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#1c132223772333f4" class="i method">GetCommand</a>() &amp; <b>unchecked</b>((<b>int</b>)(0xff));
					<b>if</b> (<span class="r121 r">kex</span> != <b>null</b> &amp;&amp; <span class="r121 r">kex</span>.<a href="KeyExchange.cs.html#1f8e1099fb018d79" class="i method">GetState</a>() == <span class="r124 r">msgType</span>)
					{
						<a href="#09138aef4c73af81" class="i field">kex_start_time</a> = <a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#e138393156840d80" class="i method">CurrentTimeMillis</a>();
						<b>bool</b> <span id="r125 rd" class="r125 r">result</span> = <span class="r121 r">kex</span>.<a href="KeyExchange.cs.html#4ded7c8a69246269" class="i method">Next</a>(<span class="r115 r">buf</span>);
						<b>if</b> (!<span class="r125 r">result</span>)
						{
							<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;verify: &quot;</span> + <span class="r125 r">result</span>);
						}
						<b>continue</b>;
					}
					<b>switch</b> (<span class="r124 r">msgType</span>)
					{
						<b>case</b> <a href="#fa37ec3e1195635d" class="i field">SSH_MSG_KEXINIT</a>:
						{
							<span class="c">//System.err.println(&quot;KEXINIT&quot;);</span>
							<span class="r121 r">kex</span> = <a href="#3a5880bf06fa30b5" class="i method">Receive_kexinit</a>(<span class="r115 r">buf</span>);
							<b>break</b>;
						}

						<b>case</b> <a href="#a99d5a0391eb6ca0" class="i field">SSH_MSG_NEWKEYS</a>:
						{
							<span class="c">//System.err.println(&quot;NEWKEYS&quot;);</span>
							<a href="#92fee1d77983bd38" class="i method">Send_newkeys</a>();
							<a href="#f7e7d8d22e54bb88" class="i method">Receive_newkeys</a>(<span class="r115 r">buf</span>, <span class="r121 r">kex</span>);
							<span class="r121 r">kex</span> = <b>null</b>;
							<b>break</b>;
						}

						<b>case</b> <a href="#7314fc463e9c39ed" class="i field">SSH_MSG_CHANNEL_DATA</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<span class="r114 r">foo</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#f4c69199826adb69" class="i method">GetString</a>(<span class="r119 r">start</span>, <span class="r120 r">length</span>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
								<b>break</b>;
							}
							<b>if</b> (<span class="r120 r">length</span>[0] == 0)
							{
								<b>break</b>;
							}
							<b>try</b>
							{
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#28d77fff82ce78fd" class="i method">Write</a>(<span class="r114 r">foo</span>, <span class="r119 r">start</span>[0], <span class="r120 r">length</span>[0]);
							}
							<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
							{
								<span class="c">//System.err.println(e);</span>
								<b>try</b>
								{
									<span class="r118 r">channel</span>.<a href="Channel.cs.html#cba49b6e437094d8" class="i method">Disconnect</a>();
								}
								<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
								{
								}
								<b>break</b>;
							}
							<b>int</b> <span id="r126 rd" class="r126 r">len</span> = <span class="r120 r">length</span>[0];
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#776c8a2a5bafdc67" class="i method">SetLocalWindowSize</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a> - <span class="r126 r">len</span>);
							<b>if</b> (<span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a> &lt; <span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a> / 2)
							{
								<span class="r116 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#4a72a00f3da6f6e8" class="i field">SSH_MSG_CHANNEL_WINDOW_ADJUST</a>));
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#97edb8f20c9cf72a" class="i method">GetRecipient</a>());
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a> - <span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a>);
								<b>lock</b> (<span class="r118 r">channel</span>)
								{
									<b>if</b> (!<span class="r118 r">channel</span>.<a href="Channel.cs.html#c9fd70d4a7f7a5de" class="i field">close</a>)
									{
										<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r116 r">packet</span>);
									}
								}
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#776c8a2a5bafdc67" class="i method">SetLocalWindowSize</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a>);
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#4fc0a1abd8711abd" class="i field">SSH_MSG_CHANNEL_EXTENDED_DATA</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="c">// data_type_code == 1</span>
							<span class="r114 r">foo</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#f4c69199826adb69" class="i method">GetString</a>(<span class="r119 r">start</span>, <span class="r120 r">length</span>);
							<span class="c">//System.err.println(&quot;stderr: &quot;+new String(foo,start[0],length[0]));</span>
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
								<b>break</b>;
							}
							<b>if</b> (<span class="r120 r">length</span>[0] == 0)
							{
								<b>break</b>;
							}
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#5fe0e81a952f3516" class="i method">Write_ext</a>(<span class="r114 r">foo</span>, <span class="r119 r">start</span>[0], <span class="r120 r">length</span>[0]);
							<b>int</b> <span id="r127 rd" class="r127 r">len</span> = <span class="r120 r">length</span>[0];
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#776c8a2a5bafdc67" class="i method">SetLocalWindowSize</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a> - <span class="r127 r">len</span>);
							<b>if</b> (<span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a> &lt; <span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a> / 2)
							{
								<span class="r116 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#4a72a00f3da6f6e8" class="i field">SSH_MSG_CHANNEL_WINDOW_ADJUST</a>));
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#97edb8f20c9cf72a" class="i method">GetRecipient</a>());
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a> - <span class="r118 r">channel</span>.<a href="Channel.cs.html#b4247fc1c9e57392" class="i field">lwsize</a>);
								<b>lock</b> (<span class="r118 r">channel</span>)
								{
									<b>if</b> (!<span class="r118 r">channel</span>.<a href="Channel.cs.html#c9fd70d4a7f7a5de" class="i field">close</a>)
									{
										<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r116 r">packet</span>);
									}
								}
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#776c8a2a5bafdc67" class="i method">SetLocalWindowSize</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#ba4343639c844c66" class="i field">lwsize_max</a>);
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#4a72a00f3da6f6e8" class="i field">SSH_MSG_CHANNEL_WINDOW_ADJUST</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
								<b>break</b>;
							}
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#e8c75da9f32ca727" class="i method">AddRemoteWindowSize</a>(<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>());
							<b>break</b>;
						}

						<b>case</b> <a href="#fd7ba2041841416e" class="i field">SSH_MSG_CHANNEL_EOF</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> != <b>null</b>)
							{
								<span class="c">//channel.eof_remote=true;</span>
								<span class="c">//channel.eof();</span>
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#b90354ab00a48b1f" class="i method">Eof_remote</a>();
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#ea58bdb49f16aae0" class="i field">SSH_MSG_CHANNEL_CLOSE</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> != <b>null</b>)
							{
								<span class="c">//	      channel.close();</span>
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#cba49b6e437094d8" class="i method">Disconnect</a>();
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#d5fda4b550d17d09" class="i field">SSH_MSG_CHANNEL_OPEN_CONFIRMATION</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
							}
							<span class="c">//break;</span>
							<b>int</b> <span id="r128 rd" class="r128 r">r</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<b>long</b> <span id="r129 rd" class="r129 r">rws</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#11bff5d9958ba78f" class="i method">GetUInt</a>();
							<b>int</b> <span id="r130 rd" class="r130 r">rps</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#5e2b6843313461d7" class="i method">SetRemoteWindowSize</a>(<span class="r129 r">rws</span>);
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#8d59c95d26cf411a" class="i method">SetRemotePacketSize</a>(<span class="r130 r">rps</span>);
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#30caa95db0d656b0" class="i field">open_confirmation</a> = <b>true</b>;
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#2cc84671002715e1" class="i method">SetRecipient</a>(<span class="r128 r">r</span>);
							<b>break</b>;
						}

						<b>case</b> <a href="#fc15ca34980d78bc" class="i field">SSH_MSG_CHANNEL_OPEN_FAILURE</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
							}
							<span class="c">//break;</span>
							<b>int</b> <span id="r131 rd" class="r131 r">reason_code</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="c">//foo=buf.getString();  // additional textual information</span>
							<span class="c">//foo=buf.getString();  // language tag </span>
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#6adff339b7c0a4e3" class="i method">SetExitStatus</a>(<span class="r131 r">reason_code</span>);
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#c9fd70d4a7f7a5de" class="i field">close</a> = <b>true</b>;
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#501df66f4a200c14" class="i field">eof_remote</a> = <b>true</b>;
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#2cc84671002715e1" class="i method">SetRecipient</a>(0);
							<b>break</b>;
						}

						<b>case</b> <a href="#dac146671529e612" class="i field">SSH_MSG_CHANNEL_REQUEST</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r114 r">foo</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#d7ae0c5e17ba9ef9" class="i method">GetString</a>();
							<b>bool</b> <span id="r132 rd" class="r132 r">reply</span> = (<span class="r115 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>() != 0);
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> != <b>null</b>)
							{
								<b>byte</b> <span id="r133 rd" class="r133 r">reply_type</span> = <b>unchecked</b>((<b>byte</b>)<a href="#e2fec3fa5a2534b9" class="i field">SSH_MSG_CHANNEL_FAILURE</a>);
								<b>if</b> ((<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<span class="r114 r">foo</span>)).<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;exit-status&quot;</span>))
								{
									<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
									<span class="c">// exit-status</span>
									<span class="r118 r">channel</span>.<a href="Channel.cs.html#6adff339b7c0a4e3" class="i method">SetExitStatus</a>(<span class="r117 r">i</span>);
									<span class="r133 r">reply_type</span> = <b>unchecked</b>((<b>byte</b>)<a href="#549f0394eb0c9c0d" class="i field">SSH_MSG_CHANNEL_SUCCESS</a>);
								}
								<b>if</b> (<span class="r132 r">reply</span>)
								{
									<span class="r116 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
									<span class="r115 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<span class="r133 r">reply_type</span>);
									<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r118 r">channel</span>.<a href="Channel.cs.html#97edb8f20c9cf72a" class="i method">GetRecipient</a>());
									<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r116 r">packet</span>);
								}
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#7cbf2ebd62ea45c4" class="i field">SSH_MSG_CHANNEL_OPEN</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r114 r">foo</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#d7ae0c5e17ba9ef9" class="i method">GetString</a>();
							<b>string</b> <span id="r134 rd" class="r134 r">ctyp</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<span class="r114 r">foo</span>);
							<b>if</b> (!<span class="s">&quot;forwarded-tcpip&quot;</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="r134 r">ctyp</span>) &amp;&amp; !(<span class="s">&quot;x11&quot;</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="r134 r">ctyp</span>) &amp;&amp; <a href="#bab8f7829f2952d2" class="i field">x11_forwarding</a>) &amp;&amp;
								 !(<span class="s">&quot;auth-agent@openssh.com&quot;</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="r134 r">ctyp</span>) &amp;&amp; <a href="#1f7a40e5883b960b" class="i field">agent_forwarding</a>))
							{
								<span class="c">//System.err.println(&quot;Session.run: CHANNEL OPEN &quot;+ctyp); </span>
								<span class="c">//throw new IOException(&quot;Session.run: CHANNEL OPEN &quot;+ctyp);</span>
								<span class="r116 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#fc15ca34980d78bc" class="i field">SSH_MSG_CHANNEL_OPEN_FAILURE</a>));
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>());
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#c0bdc0b546b5a806" class="i field">SSH_OPEN_ADMINISTRATIVELY_PROHIBITED</a>);
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#801425a71e3eb20a" class="i field">empty</a>);
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#801425a71e3eb20a" class="i field">empty</a>);
								<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r116 r">packet</span>);
							}
							<b>else</b>
							{
								<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#5370fa8f8d8d4adb" class="i method">GetChannel</a>(<span class="r134 r">ctyp</span>);
								<a href="#57b777872ce77a20" class="i method">AddChannel</a>(<span class="r118 r">channel</span>);
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#d640829e80d9a883" class="i method">GetData</a>(<span class="r115 r">buf</span>);
								<span class="r118 r">channel</span>.<a href="Channel.cs.html#a0ce5fa5d917b00a" class="i method">Init</a>();
								<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <span id="r135 rd" class="r135 r">tmp</span> = <b>new</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#83966b7a9ccffe23" class="t constructor">Thread</a>(<span class="r118 r">channel</span>);
								<span class="r135 r">tmp</span>.<a href="/Sharpen/A.html#7046e9ef75861e01" class="i method">SetName</a>(<span class="s">&quot;Channel &quot;</span> + <span class="r134 r">ctyp</span> + <span class="s">&quot; &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a>);
								<b>if</b> (<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>)
								{
									<span class="r135 r">tmp</span>.<a href="/Sharpen/A.html#492a2f0356d4059d" class="i method">SetDaemon</a>(<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>);
								}
								<span class="r135 r">tmp</span>.<a href="/Sharpen/A.html#421e075210622d1e" class="i method">Start</a>();
								<b>break</b>;
							}
							<b>goto case</b> <a href="#549f0394eb0c9c0d" class="i field">SSH_MSG_CHANNEL_SUCCESS</a>;
						}

						<b>case</b> <a href="#549f0394eb0c9c0d" class="i field">SSH_MSG_CHANNEL_SUCCESS</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
								<b>break</b>;
							}
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#ef2034ab1c41e360" class="i field">reply</a> = 1;
							<b>break</b>;
						}

						<b>case</b> <a href="#e2fec3fa5a2534b9" class="i field">SSH_MSG_CHANNEL_FAILURE</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r117 r">i</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r118 r">channel</span> = <a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#58f1e930a99b303b" class="i method">GetChannel</a>(<span class="r117 r">i</span>, <a href="#9447883c1d8c7b7f" class="k">this</a>);
							<b>if</b> (<span class="r118 r">channel</span> == <b>null</b>)
							{
								<b>break</b>;
							}
							<span class="r118 r">channel</span>.<a href="Channel.cs.html#ef2034ab1c41e360" class="i field">reply</a> = 0;
							<b>break</b>;
						}

						<b>case</b> <a href="#e60fbcd8d67e6cce" class="i field">SSH_MSG_GLOBAL_REQUEST</a>:
						{
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#314530af017b25d1" class="i method">GetInt</a>();
							<span class="r115 r">buf</span>.<a href="Buffer.cs.html#4a384b59cfc400d1" class="i method">GetShort</a>();
							<span class="r114 r">foo</span> = <span class="r115 r">buf</span>.<a href="Buffer.cs.html#d7ae0c5e17ba9ef9" class="i method">GetString</a>();
							<span class="c">// request name</span>
							<b>bool</b> <span id="r136 rd" class="r136 r">reply</span> = (<span class="r115 r">buf</span>.<a href="Buffer.cs.html#eb6cd2b9846db476" class="i method">GetByte</a>() != 0);
							<b>if</b> (<span class="r136 r">reply</span>)
							{
								<span class="r116 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
								<span class="r115 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#6eca13ed50306ce7" class="i field">SSH_MSG_REQUEST_FAILURE</a>));
								<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r116 r">packet</span>);
							}
							<b>break</b>;
						}

						<b>case</b> <a href="#6eca13ed50306ce7" class="i field">SSH_MSG_REQUEST_FAILURE</a>:
						<b>case</b> <a href="#c30a99e324371501" class="i field">SSH_MSG_REQUEST_SUCCESS</a>:
						{
							<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <span id="r137 rd" class="r137 r">t</span> = <a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#3ff0647e168a7c26" class="i method">GetThread</a>();
							<b>if</b> (<span class="r137 r">t</span> != <b>null</b>)
							{
								<a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#87c350613dad8734" class="i method">SetReply</a>(<span class="r124 r">msgType</span> == <a href="#c30a99e324371501" class="i field">SSH_MSG_REQUEST_SUCCESS</a> ? 1 : 0);
								<span class="r137 r">t</span>.<a href="/Sharpen/A.html#10516fb714437913" class="i method">Interrupt</a>();
							}
							<b>break</b>;
						}

						<b>default</b>:
						{
							<span class="c">//System.err.println(&quot;Session.run: unsupported type &quot;+msgType); </span>
							<b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#db370b64091ac4df" class="t constructor">IOException</a>(<span class="s">&quot;Unknown SSH message type &quot;</span> + <span class="r124 r">msgType</span>);
						}
					}
				}
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r138 rd" class="r138 r">e</span>)
			{
				<a href="#c76805519b7a0e7c" class="i field">in_kex</a> = <b>false</b>;
				<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Caught an exception, leaving main loop due to &quot;</span>
						 + <span class="r138 r">e</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
				}
			}
			<span class="c">//System.err.println(&quot;# Session.run&quot;);</span>
			<span class="c">//e.printStackTrace();</span>
			<b>try</b>
			{
				<a href="#72b3f15fae507244" class="i method">Disconnect</a>();
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#c742289497493bb8" class="t t">ArgumentNullException</a>)
			{
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
			{
			}
			<span class="c">//System.err.println(&quot;@1&quot;);</span>
			<span class="c">//e.printStackTrace();</span>
			<span class="c">//System.err.println(&quot;@2&quot;);</span>
			<span class="c">//e.printStackTrace();</span>
			<a href="#4abfa4fb08e3731c" class="i field">isConnected</a> = <b>false</b>;
		}

		<b>public virtual void</b> <a id="72b3f15fae507244" href="../R/72b3f15fae507244.html" target="n" data-glyph="72,1" class="i method">Disconnect</a>()
		{
			<b>if</b> (!<a href="#4abfa4fb08e3731c" class="i field">isConnected</a>)
			{
				<b>return</b>;
			}
			<span class="c">//System.err.println(this+&quot;: disconnect&quot;);</span>
			<span class="c">//Thread.dumpStack();</span>
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;Disconnecting from &quot;</span> + <a href="#1a2b75046ce43fcd" class="i field">host</a> + <span class="s">&quot; port &quot;</span> + <a href="#6e04a039d8ded1f9" class="i field">port</a>);
			}
			<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a>.<a href="Channel.cs.html#60695d1a5668ca02" class="i method">Disconnect</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
			<a href="#4abfa4fb08e3731c" class="i field">isConnected</a> = <b>false</b>;
			<a href="PortWatcher.cs.html#2efdb4ba93fa953d" class="t t">PortWatcher</a>.<a href="PortWatcher.cs.html#58d9524756182a4a" class="i method">DelPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
			<a href="ChannelForwardedTCPIP.cs.html#cbeebe8376b06da0" class="t t">ChannelForwardedTCPIP</a>.<a href="ChannelForwardedTCPIP.cs.html#7d5d31368eed7f35" class="i method">DelPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
			<a href="ChannelX11.cs.html#cca9b53b8316f449" class="t t">ChannelX11</a>.<a href="ChannelX11.cs.html#161245ee2c50a5fd" class="i method">RemoveFakedCookie</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
			<b>lock</b> (<a href="#2dd88d5f8d13745d" class="i field">Lock</a>)
			{
				<b>if</b> (<a href="#05db945f2e416c87" class="i field">connectThread</a> != <b>null</b>)
				{
					<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a>.<a href="/Sharpen/A.html#74a771f61801d704" class="i method">Yield</a>();
					<a href="#05db945f2e416c87" class="i field">connectThread</a>.<a href="/Sharpen/A.html#10516fb714437913" class="i method">Interrupt</a>();
					<a href="#05db945f2e416c87" class="i field">connectThread</a> = <b>null</b>;
				}
			}
			<a href="#458bf4ed59f416ea" class="i field">thread</a> = <b>null</b>;
			<b>try</b>
			{
				<b>if</b> (<a href="#c59740342aed7ca8" class="i field">io</a> != <b>null</b>)
				{
					<b>if</b> (<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#f484b365e4c7012f" class="i field">@in</a> != <b>null</b>)
					{
						<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#f484b365e4c7012f" class="i field">@in</a>.<a href="/Sharpen/A.html#33119cbb009fb311" class="i method">Close</a>();
					}
					<b>if</b> (<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#9474ee737a7a5183" class="i field">@out</a> != <b>null</b>)
					{
						<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#9474ee737a7a5183" class="i field">@out</a>.<a href="/Sharpen/A.html#6788f268a20b51ce" class="i method">Close</a>();
					}
					<b>if</b> (<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#bb2caa48f29ca44e" class="i field">out_ext</a> != <b>null</b>)
					{
						<a href="#c59740342aed7ca8" class="i field">io</a>.<a href="IO.cs.html#bb2caa48f29ca44e" class="i field">out_ext</a>.<a href="/Sharpen/A.html#6788f268a20b51ce" class="i method">Close</a>();
					}
				}
				<b>if</b> (<a href="#efa24b7b8a46acaa" class="i field">proxy</a> == <b>null</b>)
				{
					<b>if</b> (<a href="#cecd2519df141327" class="i field">socket</a> != <b>null</b>)
					{
						<a href="#cecd2519df141327" class="i field">socket</a>.<a href="@0@System/A.html#e16e31549d173065" class="i method">Close</a>();
					}
				}
				<b>else</b>
				{
					<b>lock</b> (<a href="#efa24b7b8a46acaa" class="i field">proxy</a>)
					{
						<a href="#efa24b7b8a46acaa" class="i field">proxy</a>.<a href="Proxy.cs.html#868a356212e815ba" class="i method">Close</a>();
					}
					<a href="#efa24b7b8a46acaa" class="i field">proxy</a> = <b>null</b>;
				}
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
			{
			}
			<span class="c">//      e.printStackTrace();</span>
			<a href="#c59740342aed7ca8" class="i field">io</a> = <b>null</b>;
			<a href="#cecd2519df141327" class="i field">socket</a> = <b>null</b>;
			<span class="c">//    synchronized(jsch.pool){</span>
			<span class="c">//      jsch.pool.removeElement(this);</span>
			<span class="c">//    }</span>
			<a href="#3cb0c6825676d304" class="i field">jsch</a>.<a href="JSch.cs.html#d3e319d688bb4a70" class="i method">RemoveSession</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
		}

		<span class="c">//System.gc();</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual int</b> <a id="bebb93b84496df1f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingL</a>(<b>int</b> <span id="r139 rd" class="r139 r">lport</span>, <b>string</b> <span id="r140 rd" class="r140 r">host</span>, <b>int</b> <span id="r141 rd" class="r141 r">rport</span>)
		{
			<b>return</b> <a href="#a18f90c37ed46fa4" class="i method">SetPortForwardingL</a>(<span class="s">&quot;127.0.0.1&quot;</span>, <span class="r139 r">lport</span>, <span class="r140 r">host</span>, <span class="r141 r">rport</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual int</b> <a id="a18f90c37ed46fa4" href="../R/a18f90c37ed46fa4.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingL</a>(<b>string</b> <span id="r142 rd" class="r142 r">boundaddress</span>, <b>int</b> <span id="r143 rd" class="r143 r">lport</span>, <b>string</b> <span id="r144 rd" class="r144 r">host</span>
			, <b>int</b> <span id="r145 rd" class="r145 r">rport</span>)
		{
			<b>return</b> <a href="#5ecc196196af073f" class="i method">SetPortForwardingL</a>(<span class="r142 r">boundaddress</span>, <span class="r143 r">lport</span>, <span class="r144 r">host</span>, <span class="r145 r">rport</span>, <b>null</b>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual int</b> <a id="5ecc196196af073f" href="../R/5ecc196196af073f.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingL</a>(<b>string</b> <span id="r146 rd" class="r146 r">boundaddress</span>, <b>int</b> <span id="r147 rd" class="r147 r">lport</span>, <b>string</b> <span id="r148 rd" class="r148 r">host</span>
			, <b>int</b> <span id="r149 rd" class="r149 r">rport</span>, <a href="ServerSocketFactory.cs.html#674831bb0634e118" class="t t">ServerSocketFactory</a> <span id="r150 rd" class="r150 r">ssf</span>)
		{
			<a href="PortWatcher.cs.html#2efdb4ba93fa953d" class="t t">PortWatcher</a> <span id="r151 rd" class="r151 r">pw</span> = <a href="PortWatcher.cs.html#2efdb4ba93fa953d" class="t t">PortWatcher</a>.<a href="PortWatcher.cs.html#bee6f9a84dcc7d2b" class="i method">AddPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <span class="r146 r">boundaddress</span>, <span class="r147 r">lport</span>, <span class="r148 r">host</span>, <span class="r149 r">rport</span>, <span class="r150 r">ssf</span>);
			<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <span id="r152 rd" class="r152 r">tmp</span> = <b>new</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#83966b7a9ccffe23" class="t constructor">Thread</a>(<span class="r151 r">pw</span>);
			<span class="r152 r">tmp</span>.<a href="/Sharpen/A.html#7046e9ef75861e01" class="i method">SetName</a>(<span class="s">&quot;PortWatcher Thread for &quot;</span> + <span class="r148 r">host</span>);
			<b>if</b> (<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>)
			{
				<span class="r152 r">tmp</span>.<a href="/Sharpen/A.html#492a2f0356d4059d" class="i method">SetDaemon</a>(<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a>);
			}
			<span class="r152 r">tmp</span>.<a href="/Sharpen/A.html#421e075210622d1e" class="i method">Start</a>();
			<b>return</b> <span class="r151 r">pw</span>.<a href="PortWatcher.cs.html#648a93a97bbf6a77" class="i field">lport</a>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="a9c154c2e164bc95" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DelPortForwardingL</a>(<b>int</b> <span id="r153 rd" class="r153 r">lport</span>)
		{
			<a href="#ee678111d3be96ce" class="i method">DelPortForwardingL</a>(<span class="s">&quot;127.0.0.1&quot;</span>, <span class="r153 r">lport</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="ee678111d3be96ce" href="../R/ee678111d3be96ce.html" target="n" data-glyph="72,1" class="i method">DelPortForwardingL</a>(<b>string</b> <span id="r154 rd" class="r154 r">boundaddress</span>, <b>int</b> <span id="r155 rd" class="r155 r">lport</span>)
		{
			<a href="PortWatcher.cs.html#2efdb4ba93fa953d" class="t t">PortWatcher</a>.<a href="PortWatcher.cs.html#dcd1644426258939" class="i method">DelPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <span class="r154 r">boundaddress</span>, <span class="r155 r">lport</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual string</b>[] <a id="e86558a8f8ef88de" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetPortForwardingL</a>()
		{
			<b>return</b> <a href="PortWatcher.cs.html#2efdb4ba93fa953d" class="t t">PortWatcher</a>.<a href="PortWatcher.cs.html#2547245dc1e12aa3" class="i method">GetPortForwarding</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="b64bda6753d1bbaa" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>int</b> <span id="r156 rd" class="r156 r">rport</span>, <b>string</b> <span id="r157 rd" class="r157 r">host</span>, <b>int</b> <span id="r158 rd" class="r158 r">lport</span>)
		{
			<a href="#077ee063a9c08105" class="i method">SetPortForwardingR</a>(<b>null</b>, <span class="r156 r">rport</span>, <span class="r157 r">host</span>, <span class="r158 r">lport</span>, (<a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a>)<b>null</b>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="59d48b2df67e20f9" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>string</b> <span id="r159 rd" class="r159 r">bind_address</span>, <b>int</b> <span id="r160 rd" class="r160 r">rport</span>, <b>string</b> <span id="r161 rd" class="r161 r">host</span>
			, <b>int</b> <span id="r162 rd" class="r162 r">lport</span>)
		{
			<a href="#077ee063a9c08105" class="i method">SetPortForwardingR</a>(<span class="r159 r">bind_address</span>, <span class="r160 r">rport</span>, <span class="r161 r">host</span>, <span class="r162 r">lport</span>, (<a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a>)<b>null</b>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="5e0a90b36b4def31" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>int</b> <span id="r163 rd" class="r163 r">rport</span>, <b>string</b> <span id="r164 rd" class="r164 r">host</span>, <b>int</b> <span id="r165 rd" class="r165 r">lport</span>, <a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a>
			 <span id="r166 rd" class="r166 r">sf</span>)
		{
			<a href="#077ee063a9c08105" class="i method">SetPortForwardingR</a>(<b>null</b>, <span class="r163 r">rport</span>, <span class="r164 r">host</span>, <span class="r165 r">lport</span>, <span class="r166 r">sf</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="077ee063a9c08105" href="../R/077ee063a9c08105.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>string</b> <span id="r167 rd" class="r167 r">bind_address</span>, <b>int</b> <span id="r168 rd" class="r168 r">rport</span>, <b>string</b> <span id="r169 rd" class="r169 r">host</span>
			, <b>int</b> <span id="r170 rd" class="r170 r">lport</span>, <a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a> <span id="r171 rd" class="r171 r">sf</span>)
		{
			<a href="ChannelForwardedTCPIP.cs.html#cbeebe8376b06da0" class="t t">ChannelForwardedTCPIP</a>.<a href="ChannelForwardedTCPIP.cs.html#8b659a69e2a5c268" class="i method">AddPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <span class="r167 r">bind_address</span>, <span class="r168 r">rport</span>, <span class="r169 r">host</span>, <span class="r170 r">lport</span>, <span class="r171 r">sf</span>);
			<a href="#e9b3c70593dc7fd5" class="i method">SetPortForwarding</a>(<span class="r167 r">bind_address</span>, <span class="r168 r">rport</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="31c9fe7e089c3b91" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>int</b> <span id="r172 rd" class="r172 r">rport</span>, <b>string</b> <span id="r173 rd" class="r173 r">daemon</span>)
		{
			<a href="#4297a7e4f3b35811" class="i method">SetPortForwardingR</a>(<b>null</b>, <span class="r172 r">rport</span>, <span class="r173 r">daemon</span>, <b>null</b>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="a5b57a787264a178" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>int</b> <span id="r174 rd" class="r174 r">rport</span>, <b>string</b> <span id="r175 rd" class="r175 r">daemon</span>, <b>object</b>[] <span id="r176 rd" class="r176 r">arg</span>)
		{
			<a href="#4297a7e4f3b35811" class="i method">SetPortForwardingR</a>(<b>null</b>, <span class="r174 r">rport</span>, <span class="r175 r">daemon</span>, <span class="r176 r">arg</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="4297a7e4f3b35811" href="../R/4297a7e4f3b35811.html" target="n" data-glyph="72,1" class="i method">SetPortForwardingR</a>(<b>string</b> <span id="r177 rd" class="r177 r">bind_address</span>, <b>int</b> <span id="r178 rd" class="r178 r">rport</span>, <b>string</b> <span id="r179 rd" class="r179 r">daemon</span>
			, <b>object</b>[] <span id="r180 rd" class="r180 r">arg</span>)
		{
			<a href="ChannelForwardedTCPIP.cs.html#cbeebe8376b06da0" class="t t">ChannelForwardedTCPIP</a>.<a href="ChannelForwardedTCPIP.cs.html#981c3b58f741211d" class="i method">AddPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <span class="r177 r">bind_address</span>, <span class="r178 r">rport</span>, <span class="r179 r">daemon</span>, <span class="r180 r">arg</span>);
			<a href="#e9b3c70593dc7fd5" class="i method">SetPortForwarding</a>(<span class="r177 r">bind_address</span>, <span class="r178 r">rport</span>);
		}

		<b>private class</b> <a id="7b969673182a7ce2" href="../R/7b969673182a7ce2.html" target="n" data-glyph="4,1" class="t t">GlobalRequestReply</a>
		{
			<b>private</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <a id="5555247773b9885b" href="../R/5555247773b9885b.html" target="n" data-glyph="46,2" class="i field">thread</a> = <b>null</b>;

			<b>private int</b> <a id="f8ed18baa2063fcd" href="../R/f8ed18baa2063fcd.html" target="n" data-glyph="46,2" class="i field">reply</a> = -1;

			<b>internal virtual void</b> <a id="e43674444bd1be00" href="../R/e43674444bd1be00.html" target="n" data-glyph="74,2" class="i method">SetThread</a>(<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <span id="r181 rd" class="r181 r">thread</span>)
			{
				<a href="#7b969673182a7ce2" class="k">this</a>.<a href="#5555247773b9885b" class="i field">thread</a> = <span class="r181 r">thread</span>;
				<a href="#7b969673182a7ce2" class="k">this</a>.<a href="#f8ed18baa2063fcd" class="i field">reply</a> = -1;
			}

			<b>internal virtual</b> <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a> <a id="3ff0647e168a7c26" href="../R/3ff0647e168a7c26.html" target="n" data-glyph="74,2" class="i method">GetThread</a>()
			{
				<b>return</b> <a href="#7b969673182a7ce2" class="k">this</a>.<a href="#5555247773b9885b" class="i field">thread</a>;
			}

			<b>internal virtual void</b> <a id="87c350613dad8734" href="../R/87c350613dad8734.html" target="n" data-glyph="74,2" class="i method">SetReply</a>(<b>int</b> <span id="r182 rd" class="r182 r">reply</span>)
			{
				<a href="#7b969673182a7ce2" class="k">this</a>.<a href="#f8ed18baa2063fcd" class="i field">reply</a> = <span class="r182 r">reply</span>;
			}

			<b>internal virtual int</b> <a id="91de0d9f804d601e" href="../R/91de0d9f804d601e.html" target="n" data-glyph="74,2" class="i method">GetReply</a>()
			{
				<b>return</b> <a href="#7b969673182a7ce2" class="k">this</a>.<a href="#f8ed18baa2063fcd" class="i field">reply</a>;
			}

			<b>internal</b> <a id="78a3bb7fa8e686be" href="../R/78a3bb7fa8e686be.html" target="n" data-glyph="74,2" class="i constructor">GlobalRequestReply</a>(<a href="#9447883c1d8c7b7f" class="t t">Session</a> <span id="r183 rd" class="r183 r">_enclosing</span>)
			{
				<a href="#7b969673182a7ce2" class="k">this</a>.<a href="#0cf3c6d9f951032f" class="i field">_enclosing</a> = <span class="r183 r">_enclosing</span>;
			}

			<b>private readonly</b> <a href="#9447883c1d8c7b7f" class="t t">Session</a> <a id="0cf3c6d9f951032f" href="../R/0cf3c6d9f951032f.html" target="n" data-glyph="46,2" class="i field">_enclosing</a>;
		}

		<b>private</b> <a href="#9447883c1d8c7b7f" class="t t">Session</a>.<a href="#7b969673182a7ce2" class="t t">GlobalRequestReply</a> <a id="ac8ee95adacf8a52" href="../R/ac8ee95adacf8a52.html" target="n" data-glyph="46,1" class="i field">grr</a>;

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="e9b3c70593dc7fd5" href="../R/e9b3c70593dc7fd5.html" target="n" data-glyph="76,1" class="i method">SetPortForwarding</a>(<b>string</b> <span id="r184 rd" class="r184 r">bind_address</span>, <b>int</b> <span id="r185 rd" class="r185 r">rport</span>)
		{
			<b>lock</b> (<a href="#ac8ee95adacf8a52" class="i field">grr</a>)
			{
				<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r186 rd" class="r186 r">buf</span> = <b>new</b> <a href="Buffer.cs.html#124585014bc24599" class="t constructor">Buffer</a>(100);
				<span class="c">// ??</span>
				<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r187 rd" class="r187 r">packet</span> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<span class="r186 r">buf</span>);
				<b>string</b> <span id="r188 rd" class="r188 r">address_to_bind</span> = <a href="ChannelForwardedTCPIP.cs.html#cbeebe8376b06da0" class="t t">ChannelForwardedTCPIP</a>.<a href="ChannelForwardedTCPIP.cs.html#c435a6d30d861585" class="i method">Normalize</a>(<span class="r184 r">bind_address</span>);
				<a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#e43674444bd1be00" class="i method">SetThread</a>(<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a>.<a href="/Sharpen/A.html#9c18f268284a4c54" class="i method">CurrentThread</a>());
				<b>try</b>
				{
					<span class="c">// byte SSH_MSG_GLOBAL_REQUEST 80</span>
					<span class="c">// string &quot;tcpip-forward&quot;</span>
					<span class="c">// boolean want_reply</span>
					<span class="c">// string  address_to_bind</span>
					<span class="c">// uint32  port number to bind</span>
					<span class="r187 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
					<span class="r186 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#e60fbcd8d67e6cce" class="i field">SSH_MSG_GLOBAL_REQUEST</a>));
					<span class="r186 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="s">&quot;tcpip-forward&quot;</span>));
					<span class="r186 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)1));
					<span class="r186 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r188 r">address_to_bind</span>));
					<span class="r186 r">buf</span>.<a href="Buffer.cs.html#b72b372c6741c2c6" class="i method">PutInt</a>(<span class="r185 r">rport</span>);
					<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r187 r">packet</span>);
				}
				<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r189 rd" class="r189 r">e</span>)
				{
					<a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#e43674444bd1be00" class="i method">SetThread</a>(<b>null</b>);
					<b>if</b> (<span class="r189 r">e</span> <b>is</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r189 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)<span class="r189 r">e</span>);
					}
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="r189 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>());
				}
				<b>int</b> <span id="r190 rd" class="r190 r">count</span> = 0;
				<b>int</b> <span id="r191 rd" class="r191 r">reply</span> = <a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#91de0d9f804d601e" class="i method">GetReply</a>();
				<b>while</b> (<span class="r190 r">count</span> &lt; 10 &amp;&amp; <span class="r191 r">reply</span> == -1)
				{
					<b>try</b>
					{
						<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#13a16ee813b75f98" class="t t">Thread</a>.<a href="/Sharpen/A.html#7fe5d5fe7cd5df12" class="i method">Sleep</a>(1000);
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
					{
					}
					<span class="r190 r">count</span>++;
					<span class="r191 r">reply</span> = <a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#91de0d9f804d601e" class="i method">GetReply</a>();
				}
				<a href="#ac8ee95adacf8a52" class="i field">grr</a>.<a href="#e43674444bd1be00" class="i method">SetThread</a>(<b>null</b>);
				<b>if</b> (<span class="r191 r">reply</span> != 1)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;remote port forwarding failed for listen port &quot;</span> + <span class="r185 r">rport</span>);
				}
			}
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="55b75a2dab623ccd" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">DelPortForwardingR</a>(<b>int</b> <span id="r192 rd" class="r192 r">rport</span>)
		{
			<a href="ChannelForwardedTCPIP.cs.html#cbeebe8376b06da0" class="t t">ChannelForwardedTCPIP</a>.<a href="ChannelForwardedTCPIP.cs.html#116123a0897987a2" class="i method">DelPort</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <span class="r192 r">rport</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="0fdfc9e1df305477" href="../R/0fdfc9e1df305477.html" target="n" data-glyph="76,1" class="i method">InitDeflater</a>(<b>string</b> <span id="r193 rd" class="r193 r">method</span>)
		{
			<b>if</b> (<span class="r193 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;none&quot;</span>))
			{
				<a href="#fe62776ddd16a6bd" class="i field">deflater</a> = <b>null</b>;
				<b>return</b>;
			}
			<b>string</b> <span id="r194 rd" class="r194 r">foo</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r193 r">method</span>);
			<b>if</b> (<span class="r194 r">foo</span> != <b>null</b>)
			{
				<b>if</b> (<span class="r193 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;zlib&quot;</span>) || (<a href="#9d201effb55c3143" class="i field">isAuthed</a> &amp;&amp; <span class="r193 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;zlib@openssh.com&quot;</span>)))
				{
					<b>try</b>
					{
						<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r195 rd" class="r195 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<span class="r194 r">foo</span>);
						<a href="#fe62776ddd16a6bd" class="i field">deflater</a> = (<a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r195 r">c</span>));
						<b>int</b> <span id="r196 rd" class="r196 r">level</span> = 6;
						<b>try</b>
						{
							<span class="r196 r">level</span> = <span class="i n">System</span>.<a href="@0@mscorlib/A.html#fc990bd1275d43d6" class="t t">Convert</a>.<a href="@0@mscorlib/A.html#069d595792a157df" class="i method">ToInt32</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="s">&quot;compression_level&quot;</span>));
						}
						<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
						{
						}
						<a href="#fe62776ddd16a6bd" class="i field">deflater</a>.<a href="Compression.cs.html#a515db7399e88d3e" class="i method">Init</a>(<a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a>.<a href="Compression.cs.html#25909b4d320d1dfd" class="i field">DEFLATER</a>, <span class="r196 r">level</span>);
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r197 rd" class="r197 r">ee</span>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r197 r">ee</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r197 r">ee</span>);
					}
				}
			}
		}

		<span class="c">//System.err.println(foo+&quot; isn&#39;t accessible.&quot;);</span>
		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>private void</b> <a id="0e07215720abc886" href="../R/0e07215720abc886.html" target="n" data-glyph="76,1" class="i method">InitInflater</a>(<b>string</b> <span id="r198 rd" class="r198 r">method</span>)
		{
			<b>if</b> (<span class="r198 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;none&quot;</span>))
			{
				<a href="#57cdef084060c615" class="i field">inflater</a> = <b>null</b>;
				<b>return</b>;
			}
			<b>string</b> <span id="r199 rd" class="r199 r">foo</span> = <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r198 r">method</span>);
			<b>if</b> (<span class="r199 r">foo</span> != <b>null</b>)
			{
				<b>if</b> (<span class="r198 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;zlib&quot;</span>) || (<a href="#9d201effb55c3143" class="i field">isAuthed</a> &amp;&amp; <span class="r198 r">method</span>.<a href="@0@mscorlib/A.html#31b307b02a3bd6b9" class="i method">Equals</a>(<span class="s">&quot;zlib@openssh.com&quot;</span>)))
				{
					<b>try</b>
					{
						<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r200 rd" class="r200 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<span class="r199 r">foo</span>);
						<a href="#57cdef084060c615" class="i field">inflater</a> = (<a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r200 r">c</span>));
						<a href="#57cdef084060c615" class="i field">inflater</a>.<a href="Compression.cs.html#a515db7399e88d3e" class="i method">Init</a>(<a href="Compression.cs.html#3aae6d3a4a360c95" class="t t">Compression</a>.<a href="Compression.cs.html#5deca260f81b183e" class="i field">INFLATER</a>, 0);
					}
					<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r201 rd" class="r201 r">ee</span>)
					{
						<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r201 r">ee</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), <span class="r201 r">ee</span>);
					}
				}
			}
		}

		<span class="c">//System.err.println(foo+&quot; isn&#39;t accessible.&quot;);</span>
		<b>internal virtual void</b> <a id="57b777872ce77a20" href="../R/57b777872ce77a20.html" target="n" data-glyph="74,1" class="i method">AddChannel</a>(<a href="Channel.cs.html#9ac373d02b985544" class="t t">Channel</a> <span id="r202 rd" class="r202 r">channel</span>)
		{
			<span class="r202 r">channel</span>.<a href="Channel.cs.html#b1107537c01236ae" class="i method">SetSession</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>);
		}

		<b>public virtual void</b> <a id="0c312e18ed11bb97" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetProxy</a>(<a href="Proxy.cs.html#b97f6805764d44c9" class="t t">Proxy</a> <span id="r203 rd" class="r203 r">proxy</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#efa24b7b8a46acaa" class="i field">proxy</a> = <span class="r203 r">proxy</span>;
		}

		<b>public virtual void</b> <a id="bf2b60d08b82f7bd" href="../R/bf2b60d08b82f7bd.html" target="n" data-glyph="72,1" class="i method">SetHost</a>(<b>string</b> <span id="r204 rd" class="r204 r">host</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1a2b75046ce43fcd" class="i field">host</a> = <span class="r204 r">host</span>;
		}

		<b>public virtual void</b> <a id="4256618de1fc2f66" href="../R/4256618de1fc2f66.html" target="n" data-glyph="72,1" class="i method">SetPort</a>(<b>int</b> <span id="r205 rd" class="r205 r">port</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#6e04a039d8ded1f9" class="i field">port</a> = <span class="r205 r">port</span>;
		}

		<b>internal virtual void</b> <a id="208c8b0858a179ce" href="../R/208c8b0858a179ce.html" target="n" data-glyph="74,1" class="i method">SetUserName</a>(<b>string</b> <span id="r206 rd" class="r206 r">username</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#2c060e318aeb0c5f" class="i field">username</a> = <span class="r206 r">username</span>;
		}

		<b>public virtual void</b> <a id="e74e8cae1b5ca4b6" href="../R/e74e8cae1b5ca4b6.html" target="n" data-glyph="72,1" class="i method">SetUserInfo</a>(<a href="UserInfo.cs.html#6c4e07f23c6cc7bb" class="t t">UserInfo</a> <span id="r207 rd" class="r207 r">userinfo</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#db6703f509870e09" class="i field">userinfo</a> = <span class="r207 r">userinfo</span>;
		}

		<b>public virtual</b> <a href="UserInfo.cs.html#6c4e07f23c6cc7bb" class="t t">UserInfo</a> <a id="cddf94a3787616a5" href="../R/cddf94a3787616a5.html" target="n" data-glyph="72,1" class="i method">GetUserInfo</a>()
		{
			<b>return</b> <a href="#db6703f509870e09" class="i field">userinfo</a>;
		}

		<b>public virtual void</b> <a id="3c33d78ec35e31e7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetInputStream</a>(<a href="/Sharpen/A.html#5fe75b93f596f64a" class="t t">InputStream</a> <span id="r208 rd" class="r208 r">@in</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#3d3b0dccb6fc85a2" class="i field">@in</a> = <span class="r208 r">@in</span>;
		}

		<b>public virtual void</b> <a id="c1f35797de0b8bd3" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetOutputStream</a>(<a href="/Sharpen/A.html#f960ef5651b4ede1" class="t t">OutputStream</a> <span id="r209 rd" class="r209 r">@out</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#5e82a45cb582c76e" class="i field">@out</a> = <span class="r209 r">@out</span>;
		}

		<b>public virtual void</b> <a id="4e0579b823e9924c" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetX11Host</a>(<b>string</b> <span id="r210 rd" class="r210 r">host</span>)
		{
			<a href="ChannelX11.cs.html#cca9b53b8316f449" class="t t">ChannelX11</a>.<a href="ChannelX11.cs.html#63da649fefa88151" class="i method">SetHost</a>(<span class="r210 r">host</span>);
		}

		<b>public virtual void</b> <a id="19f3fd18bf3e3674" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetX11Port</a>(<b>int</b> <span id="r211 rd" class="r211 r">port</span>)
		{
			<a href="ChannelX11.cs.html#cca9b53b8316f449" class="t t">ChannelX11</a>.<a href="ChannelX11.cs.html#7619c6c2367efe16" class="i method">SetPort</a>(<span class="r211 r">port</span>);
		}

		<b>public virtual void</b> <a id="6bd6da3fdad6d0da" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetX11Cookie</a>(<b>string</b> <span id="r212 rd" class="r212 r">cookie</span>)
		{
			<a href="ChannelX11.cs.html#cca9b53b8316f449" class="t t">ChannelX11</a>.<a href="ChannelX11.cs.html#60087ad98c5ac909" class="i method">SetCookie</a>(<span class="r212 r">cookie</span>);
		}

		<b>public virtual void</b> <a id="8ddda0b0256d35ed" href="../R/8ddda0b0256d35ed.html" target="n" data-glyph="72,1" class="i method">SetPassword</a>(<b>string</b> <span id="r213 rd" class="r213 r">password</span>)
		{
			<b>if</b> (<span class="r213 r">password</span> != <b>null</b>)
			{
				<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1facbe2f33793c2a" class="i field">password</a> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r213 r">password</span>);
			}
		}

		<b>public virtual void</b> <a id="6425edc49c4e11cc" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetPassword</a>(<b>byte</b>[] <span id="r214 rd" class="r214 r">password</span>)
		{
			<b>if</b> (<span class="r214 r">password</span> != <b>null</b>)
			{
				<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1facbe2f33793c2a" class="i field">password</a> = <b>new</b> <b>byte</b>[<span class="r214 r">password</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>];
				<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="r214 r">password</span>, 0, <a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#1facbe2f33793c2a" class="i field">password</a>, 0, <span class="r214 r">password</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>);
			}
		}

		<b>public virtual void</b> <a id="05d54ca0d320e379" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetConfig</a>(<a href="Sharpen/Properties.cs.html#963b4cc3d3c2c02d" class="t t">Properties</a> <span id="r215 rd" class="r215 r">newconf</span>)
		{
			<a href="#587a63092c5cace4" class="i method">SetConfig</a>((<a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a>)<span class="r215 r">newconf</span>);
		}

		<b>public virtual void</b> <a id="587a63092c5cace4" href="../R/587a63092c5cace4.html" target="n" data-glyph="72,1" class="i method">SetConfig</a>(<a href="@0@mscorlib/A.html#10fefb6e0ae510dd" class="t t">Hashtable</a> <span id="r216 rd" class="r216 r">newconf</span>)
		{
			<b>lock</b> (<a href="#2dd88d5f8d13745d" class="i field">Lock</a>)
			{
				<b>if</b> (<a href="#6032927205ea9744" class="i field">config</a> == <b>null</b>)
				{
					<a href="#6032927205ea9744" class="i field">config</a> = <b>new</b> <a href="@0@mscorlib/A.html#35eb148f5d60a68c" class="t constructor">Hashtable</a>();
				}
				<b>foreach</b> (<a href="@0@mscorlib/A.html#d9262ceecc1719ab" class="k">var</a> <span id="r217 rd" class="r217 r">e</span> <b>in</b> <span class="r216 r">newconf</span>.<a href="@0@mscorlib/A.html#d4c2d1ac82a925b3" class="i property">Keys</a>)
				{
					<b>string</b> <span id="r218 rd" class="r218 r">key</span> = (<b>string</b>)(<span class="r217 r">e</span>);
					<a href="#6032927205ea9744" class="i field">config</a>.<a href="/Sharpen/A.html#5fefce6eccf6c6f0" class="i method">Put</a>(<span class="r218 r">key</span>, (<b>string</b>)(<span class="r216 r">newconf</span><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="r218 r">key</span>]));
				}
			}
		}

		<b>public virtual void</b> <a id="439ae98e46432204" href="../R/439ae98e46432204.html" target="n" data-glyph="72,1" class="i method">SetConfig</a>(<b>string</b> <span id="r219 rd" class="r219 r">key</span>, <b>string</b> <span id="r220 rd" class="r220 r">value</span>)
		{
			<b>lock</b> (<a href="#2dd88d5f8d13745d" class="i field">Lock</a>)
			{
				<b>if</b> (<a href="#6032927205ea9744" class="i field">config</a> == <b>null</b>)
				{
					<a href="#6032927205ea9744" class="i field">config</a> = <b>new</b> <a href="@0@mscorlib/A.html#35eb148f5d60a68c" class="t constructor">Hashtable</a>();
				}
				<a href="#6032927205ea9744" class="i field">config</a>.<a href="/Sharpen/A.html#5fefce6eccf6c6f0" class="i method">Put</a>(<span class="r219 r">key</span>, <span class="r220 r">value</span>);
			}
		}

		<b>public virtual string</b> <a id="410565b7e665a1ac" href="../R/410565b7e665a1ac.html" target="n" data-glyph="72,1" class="i method">GetConfig</a>(<b>string</b> <span id="r221 rd" class="r221 r">key</span>)
		{
			<b>object</b> <span id="r222 rd" class="r222 r">foo</span> = <b>null</b>;
			<b>if</b> (<a href="#6032927205ea9744" class="i field">config</a> != <b>null</b>)
			{
				<span class="r222 r">foo</span> = <a href="#6032927205ea9744" class="i field">config</a><a href="@0@mscorlib/A.html#cd969ff2abf65ce3">[</a><span class="r221 r">key</span>];
				<b>if</b> (<span class="r222 r">foo</span> <b>is string</b>)
				{
					<b>return</b> (<b>string</b>)<span class="r222 r">foo</span>;
				}
			}
			<span class="r222 r">foo</span> = <a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#4a602d02111ef8ad" class="i method">GetConfig</a>(<span class="r221 r">key</span>);
			<b>if</b> (<span class="r222 r">foo</span> <b>is string</b>)
			{
				<b>return</b> (<b>string</b>)<span class="r222 r">foo</span>;
			}
			<b>return null</b>;
		}

		<b>public virtual void</b> <a id="b79d32efa8817f9d" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetSocketFactory</a>(<a href="SocketFactory.cs.html#3e0605c77775aa05" class="t t">SocketFactory</a> <span id="r223 rd" class="r223 r">sfactory</span>)
		{
			<a href="#334a62486322e43b" class="i field">socket_factory</a> = <span class="r223 r">sfactory</span>;
		}

		<b>public virtual bool</b> <a id="fcec76bc0b5d0d19" href="../R/fcec76bc0b5d0d19.html" target="n" data-glyph="72,1" class="i method">IsConnected</a>()
		{
			<b>return</b> <a href="#4abfa4fb08e3731c" class="i field">isConnected</a>;
		}

		<b>public virtual int</b> <a id="796657ea79a25a7b" href="../R/796657ea79a25a7b.html" target="n" data-glyph="72,1" class="i method">GetTimeout</a>()
		{
			<b>return</b> <a href="#e5455bfe534c29f8" class="i field">timeout</a>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="2ec45a378b9850a4" href="../R/2ec45a378b9850a4.html" target="n" data-glyph="72,1" class="i method">SetTimeout</a>(<b>int</b> <span id="r224 rd" class="r224 r">timeout</span>)
		{
			<b>if</b> (<a href="#cecd2519df141327" class="i field">socket</a> == <b>null</b>)
			{
				<b>if</b> (<span class="r224 r">timeout</span> &lt; 0)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="s">&quot;invalid timeout value&quot;</span>);
				}
				<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#e5455bfe534c29f8" class="i field">timeout</a> = <span class="r224 r">timeout</span>;
				<b>return</b>;
			}
			<b>try</b>
			{
				<a href="#cecd2519df141327" class="i field">socket</a>.<a href="@0@System/A.html#b78f7d4a8a51dfd6" class="i property">ReceiveTimeout</a> = <span class="r224 r">timeout</span>;
				<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#e5455bfe534c29f8" class="i field">timeout</a> = <span class="r224 r">timeout</span>;
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r225 rd" class="r225 r">e</span>)
			{
				<b>if</b> (<span class="r225 r">e</span> <b>is</b> <a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
				{
					<b>throw</b> <b>new</b> <a href="JSchException.cs.html#d7573e85fc1524a1" class="t constructor">JSchException</a>(<span class="r225 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>(), (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)<span class="r225 r">e</span>);
				}
				<b>throw</b> <b>new</b> <a href="JSchException.cs.html#406e93aecebf8dd7" class="t constructor">JSchException</a>(<span class="r225 r">e</span>.<a href="@0@mscorlib/A.html#e2e19f4ed8da81aa" class="i method">ToString</a>());
			}
		}

		<b>public virtual string</b> <a id="f7ef6d2b32533056" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetServerVersion</a>()
		{
			<b>return</b> <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<a href="#89221780c105f245" class="i field">V_S</a>);
		}

		<b>public virtual string</b> <a id="483ea42cdd74e836" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetClientVersion</a>()
		{
			<b>return</b> <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#c7da939e4d36b6ec" class="i method">Byte2str</a>(<a href="#295fb16f7829b6aa" class="i field">V_C</a>);
		}

		<b>public virtual void</b> <a id="5e3b0b684679fa37" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetClientVersion</a>(<b>string</b> <span id="r226 rd" class="r226 r">cv</span>)
		{
			<a href="#295fb16f7829b6aa" class="i field">V_C</a> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="r226 r">cv</span>);
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="88eb8ba9e65f7a6e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SendIgnore</a>()
		{
			<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r227 rd" class="r227 r">buf</span> = <b>new</b> <a href="Buffer.cs.html#35c62a99009984d5" class="t constructor">Buffer</a>();
			<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r228 rd" class="r228 r">packet</span> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<span class="r227 r">buf</span>);
			<span class="r228 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
			<span class="r227 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#8556f5a2c6fd264b" class="i field">SSH_MSG_IGNORE</a>));
			<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r228 r">packet</span>);
		}

		<b>private static readonly byte</b>[] <a id="382f88d3b4c903dd" href="../R/382f88d3b4c903dd.html" target="n" data-glyph="46,1" class="i field">keepalivemsg</a> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#e702d75bfa382791" class="i method">Str2byte</a>(<span class="s">&quot;keepalive@jcraft.com&quot;</span>
			);

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">System</span>.<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="22f85a4848bdf6d3" href="../R/22f85a4848bdf6d3.html" target="n" data-glyph="72,1" class="i method">SendKeepAliveMsg</a>()
		{
			<a href="Buffer.cs.html#af177b383b13b14e" class="t t">Buffer</a> <span id="r229 rd" class="r229 r">buf</span> = <b>new</b> <a href="Buffer.cs.html#35c62a99009984d5" class="t constructor">Buffer</a>();
			<a href="Packet.cs.html#7d7762b87d346ba6" class="t t">Packet</a> <span id="r230 rd" class="r230 r">packet</span> = <b>new</b> <a href="Packet.cs.html#01cd81379828c07b" class="t constructor">Packet</a>(<span class="r229 r">buf</span>);
			<span class="r230 r">packet</span>.<a href="Packet.cs.html#4fd925a8fd9cde3e" class="i method">Reset</a>();
			<span class="r229 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)<a href="#e60fbcd8d67e6cce" class="i field">SSH_MSG_GLOBAL_REQUEST</a>));
			<span class="r229 r">buf</span>.<a href="Buffer.cs.html#f1554e4bbcb866d4" class="i method">PutString</a>(<a href="#382f88d3b4c903dd" class="i field">keepalivemsg</a>);
			<span class="r229 r">buf</span>.<a href="Buffer.cs.html#9b1e7bbab844f343" class="i method">PutByte</a>(<b>unchecked</b>((<b>byte</b>)1));
			<a href="#3023fd09cf504160" class="i method">Write</a>(<span class="r230 r">packet</span>);
		}

		<b>private</b> <a href="HostKey.cs.html#51d7b0db47f04e2b" class="t t">HostKey</a> <a id="a14ba590db0163e9" href="../R/a14ba590db0163e9.html" target="n" data-glyph="46,1" class="i field">hostkey</a> = <b>null</b>;

		<b>public virtual</b> <a href="HostKey.cs.html#51d7b0db47f04e2b" class="t t">HostKey</a> <a id="3990e264bd2c354e" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHostKey</a>()
		{
			<b>return</b> <a href="#a14ba590db0163e9" class="i field">hostkey</a>;
		}

		<b>public virtual string</b> <a id="06b909f202a2138d" href="../R/06b909f202a2138d.html" target="n" data-glyph="72,1" class="i method">GetHost</a>()
		{
			<b>return</b> <a href="#1a2b75046ce43fcd" class="i field">host</a>;
		}

		<b>public virtual string</b> <a id="7f6efb2c403db7b8" href="../R/7f6efb2c403db7b8.html" target="n" data-glyph="72,1" class="i method">GetUserName</a>()
		{
			<b>return</b> <a href="#2c060e318aeb0c5f" class="i field">username</a>;
		}

		<b>public virtual int</b> <a id="76fcaf23386f07bd" href="../R/76fcaf23386f07bd.html" target="n" data-glyph="72,1" class="i method">GetPort</a>()
		{
			<b>return</b> <a href="#6e04a039d8ded1f9" class="i field">port</a>;
		}

		<b>public virtual void</b> <a id="2e1eb7119623167f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetHostKeyAlias</a>(<b>string</b> <span id="r231 rd" class="r231 r">hostKeyAlias</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#274893d49d1a5973" class="i field">hostKeyAlias</a> = <span class="r231 r">hostKeyAlias</span>;
		}

		<b>public virtual string</b> <a id="b38fa543149c5f14" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetHostKeyAlias</a>()
		{
			<b>return</b> <a href="#274893d49d1a5973" class="i field">hostKeyAlias</a>;
		}

		<span class="c">///</span><span class="c"> </span><span class="c">&lt;</span><span class="c">exception</span><span class="c"> </span><span class="c">cref</span><span class="c">=</span><span class="c">&quot;</span><span class="i n">NSch</span>.<a href="JSchException.cs.html#aa062d3f1316907c" class="t t">JSchException</a><span class="c">&quot;</span><span class="c">&gt;</span><span class="c">&lt;/</span><span class="c">exception</span><span class="c">&gt;</span>
		<b>public virtual void</b> <a id="e61c0d59dfcc9012" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetServerAliveInterval</a>(<b>int</b> <span id="r232 rd" class="r232 r">interval</span>)
		{
			<a href="#2ec45a378b9850a4" class="i method">SetTimeout</a>(<span class="r232 r">interval</span>);
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#b7a309548ec32022" class="i field">serverAliveInterval</a> = <span class="r232 r">interval</span>;
		}

		<b>public virtual void</b> <a id="f6aec000506af06a" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetServerAliveCountMax</a>(<b>int</b> <span id="r233 rd" class="r233 r">count</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#a7217574673ef3a2" class="i field">serverAliveCountMax</a> = <span class="r233 r">count</span>;
		}

		<b>public virtual int</b> <a id="ddba369896c7bcea" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetServerAliveInterval</a>()
		{
			<b>return</b> <a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#b7a309548ec32022" class="i field">serverAliveInterval</a>;
		}

		<b>public virtual int</b> <a id="ea6a57547424d40f" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">GetServerAliveCountMax</a>()
		{
			<b>return</b> <a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#a7217574673ef3a2" class="i field">serverAliveCountMax</a>;
		}

		<b>public virtual void</b> <a id="1e168abbfa6192c7" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i method">SetDaemonThread</a>(<b>bool</b> <span id="r234 rd" class="r234 r">enable</span>)
		{
			<a href="#9447883c1d8c7b7f" class="k">this</a>.<a href="#2cae7a45190c79cb" class="i field">daemon_thread</a> = <span class="r234 r">enable</span>;
		}

		<b>private string</b>[] <a id="bddebb7c59fb0058" href="../R/bddebb7c59fb0058.html" target="n" data-glyph="76,1" class="i method">CheckCiphers</a>(<b>string</b> <span id="r235 rd" class="r235 r">ciphers</span>)
		{
			<b>if</b> (<span class="r235 r">ciphers</span> == <b>null</b> || <span class="r235 r">ciphers</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> == 0)
			{
				<b>return null</b>;
			}
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;CheckCiphers: &quot;</span> + <span class="r235 r">ciphers</span>);
			}
			<a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r236 rd" class="r236 r">result</span> = <b>new</b> <a href="@0@mscorlib/A.html#3113636092b18f20" class="t constructor">ArrayList</a>();
			<b>string</b>[] <span id="r237 rd" class="r237 r">_ciphers</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#3524eb6ee742432d" class="i method">Split</a>(<span class="r235 r">ciphers</span>, <span class="s">&quot;,&quot;</span>);
			<b>for</b> (<b>int</b> <span id="r238 rd" class="r238 r">i</span> = 0; <span class="r238 r">i</span> &lt; <span class="r237 r">_ciphers</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r238 r">i</span>++)
			{
				<b>if</b> (!<a href="#51aca170ce6eef67" class="i method">CheckCipher</a>(<a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r237 r">_ciphers</span>[<span class="r238 r">i</span>])))
				{
					<span class="r236 r">result</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(<span class="r237 r">_ciphers</span>[<span class="r238 r">i</span>]);
				}
			}
			<b>if</b> (<span class="r236 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == 0)
			{
				<b>return null</b>;
			}
			<b>string</b>[] <span id="r239 rd" class="r239 r">foo</span> = <b>new</b> <b>string</b>[<span class="r236 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>];
			<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#108f8e45f204ed4e" class="t t">Collections</a>.<a href="/Sharpen/A.html#2ed5ab90f6222958" class="i method">ToArray</a>(<span class="r236 r">result</span>), 0, <span class="r239 r">foo</span>, 0, <span class="r236 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<b>for</b> (<b>int</b> <span id="r240 rd" class="r240 r">i_1</span> = 0; <span class="r240 r">i_1</span> &lt; <span class="r239 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r240 r">i_1</span>++)
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="r239 r">foo</span>[<span class="r240 r">i_1</span>] + <span class="s">&quot; is not available.&quot;</span>);
				}
			}
			<b>return</b> <span class="r239 r">foo</span>;
		}

		<b>internal static bool</b> <a id="51aca170ce6eef67" href="../R/51aca170ce6eef67.html" target="n" data-glyph="74,1" class="i method">CheckCipher</a>(<b>string</b> <span id="r241 rd" class="r241 r">cipher</span>)
		{
			<b>try</b>
			{
				<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r242 rd" class="r242 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<span class="r241 r">cipher</span>);
				<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a> <span id="r243 rd" class="r243 r">_c</span> = (<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r242 r">c</span>));
				<span class="r243 r">_c</span>.<a href="Cipher.cs.html#827aa331e9c4ef6d" class="i method">Init</a>(<span class="i n">NSch</span>.<a href="Cipher.cs.html#0151f6f6ceadd53d" class="t t">Cipher</a>.<a href="Cipher.cs.html#7892e6892db1524e" class="i field">ENCRYPT_MODE</a>, <b>new</b> <b>byte</b>[<span class="r243 r">_c</span>.<a href="Cipher.cs.html#64b8b78bddbbd9c6" class="i method">GetBlockSize</a>()], <b>new</b> <b>byte</b>[<span class="r243 r">_c</span>.<a href="Cipher.cs.html#43b43c0e9f7c041b" class="i method">GetIVSize</a>
					()]);
				<b>return true</b>;
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
			{
				<b>return false</b>;
			}
		}

		<b>private string</b>[] <a id="c03b6a8c35c4a547" href="../R/c03b6a8c35c4a547.html" target="n" data-glyph="76,1" class="i method">CheckKexes</a>(<b>string</b> <span id="r244 rd" class="r244 r">kexes</span>)
		{
			<b>if</b> (<span class="r244 r">kexes</span> == <b>null</b> || <span class="r244 r">kexes</span>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a> == 0)
			{
				<b>return null</b>;
			}
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="s">&quot;CheckKexes: &quot;</span> + <span class="r244 r">kexes</span>);
			}
			<a href="@0@mscorlib/A.html#3e3f6715773d6643" class="t t">ArrayList</a> <span id="r245 rd" class="r245 r">result</span> = <b>new</b> <a href="@0@mscorlib/A.html#3113636092b18f20" class="t constructor">ArrayList</a>();
			<b>string</b>[] <span id="r246 rd" class="r246 r">_kexes</span> = <a href="Util.cs.html#a69dbb8bb8216ba3" class="t t">Util</a>.<a href="Util.cs.html#3524eb6ee742432d" class="i method">Split</a>(<span class="r244 r">kexes</span>, <span class="s">&quot;,&quot;</span>);
			<b>for</b> (<b>int</b> <span id="r247 rd" class="r247 r">i</span> = 0; <span class="r247 r">i</span> &lt; <span class="r246 r">_kexes</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r247 r">i</span>++)
			{
				<b>if</b> (!<a href="#c1990fa4bb5ec806" class="i method">CheckKex</a>(<a href="#9447883c1d8c7b7f" class="k">this</a>, <a href="#410565b7e665a1ac" class="i method">GetConfig</a>(<span class="r246 r">_kexes</span>[<span class="r247 r">i</span>])))
				{
					<span class="r245 r">result</span>.<a href="@0@mscorlib/A.html#5e9cf3d0a9ed0b29" class="i method">Add</a>(<span class="r246 r">_kexes</span>[<span class="r247 r">i</span>]);
				}
			}
			<b>if</b> (<span class="r245 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a> == 0)
			{
				<b>return null</b>;
			}
			<b>string</b>[] <span id="r248 rd" class="r248 r">foo</span> = <b>new</b> <b>string</b>[<span class="r245 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>];
			<span class="i n">System</span>.<a href="@0@mscorlib/A.html#156e066ecc4ccedf" class="t t">Array</a>.<a href="@0@mscorlib/A.html#7441c6721593042c" class="i method">Copy</a>(<span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#108f8e45f204ed4e" class="t t">Collections</a>.<a href="/Sharpen/A.html#2ed5ab90f6222958" class="i method">ToArray</a>(<span class="r245 r">result</span>), 0, <span class="r248 r">foo</span>, 0, <span class="r245 r">result</span>.<a href="@0@mscorlib/A.html#2cf26d4c322d3a86" class="i property">Count</a>);
			<b>if</b> (<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e083363076a8c475" class="i method">IsEnabled</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>))
			{
				<b>for</b> (<b>int</b> <span id="r249 rd" class="r249 r">i_1</span> = 0; <span class="r249 r">i_1</span> &lt; <span class="r248 r">foo</span>.<a href="@0@mscorlib/A.html#42e9b7616956cf94" class="i property">Length</a>; <span class="r249 r">i_1</span>++)
				{
					<a href="JSch.cs.html#3960dfedaf21cb56" class="t t">JSch</a>.<a href="JSch.cs.html#9476536e68b722ab" class="i method">GetLogger</a>().<a href="Logger.cs.html#e8c8e1b36ca34901" class="i method">Log</a>(<a href="Logger.cs.html#6deb60855dc5aa17" class="t t">Logger</a>.<a href="Logger.cs.html#6ec64bdb5f4c3ab4" class="i field">INFO</a>, <span class="r248 r">foo</span>[<span class="r249 r">i_1</span>] + <span class="s">&quot; is not available.&quot;</span>);
				}
			}
			<b>return</b> <span class="r248 r">foo</span>;
		}

		<b>internal static bool</b> <a id="c1990fa4bb5ec806" href="../R/c1990fa4bb5ec806.html" target="n" data-glyph="74,1" class="i method">CheckKex</a>(<a href="#9447883c1d8c7b7f" class="t t">Session</a> <span id="r250 rd" class="r250 r">s</span>, <b>string</b> <span id="r251 rd" class="r251 r">kex</span>)
		{
			<b>try</b>
			{
				<a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a> <span id="r252 rd" class="r252 r">c</span> = <span class="i n">Sharpen</span>.<a href="/Sharpen/A.html#e8e79b34b4baa5b2" class="t t">Runtime</a>.<a href="/Sharpen/A.html#dfdac8f647416635" class="i method">GetType</a>(<span class="r251 r">kex</span>);
				<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a> <span id="r253 rd" class="r253 r">_c</span> = (<a href="KeyExchange.cs.html#9b5eadb1d40b2594" class="t t">KeyExchange</a>)(<span class="i n">System</span>.<a href="@0@mscorlib/A.html#955a7437554c8efc" class="t t">Activator</a>.<a href="@0@mscorlib/A.html#4c7b92371a93f246" class="i method">CreateInstance</a>(<span class="r252 r">c</span>));
				<span class="r253 r">_c</span>.<a href="KeyExchange.cs.html#6cc44c2b6ad0e299" class="i method">Init</a>(<span class="r250 r">s</span>, <b>null</b>, <b>null</b>, <b>null</b>, <b>null</b>);
				<b>return true</b>;
			}
			<b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a>)
			{
				<b>return false</b>;
			}
		}
	}
}
</pre></td></tr></table></div></body></html>
