<!DOCTYPE html>
<html><head><title>LabelBackend.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(245);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Xwt3.WPF/Xwt.WPFBackend/LabelBackend.cs" target="_top">Xwt.WPFBackend\LabelBackend.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xwt3.WPF" target="_top">xwt\Xwt.WPF\Xwt3.WPF.csproj</a> (Xwt3.WPF)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">// </span>
<span class="c">// LabelBackend.cs</span>
<span class="c">//  </span>
<span class="c">// Author:</span>
<span class="c">//       Carlos Alberto Cortez &lt;calberto.cortez@gmail.com&gt;</span>
<span class="c">// </span>
<span class="c">// Copyright (c) 2012 Carlos Alberto Cortez</span>
<span class="c">// </span>
<span class="c">// Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c">// of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c">// in the Software without restriction, including without limitation the rights</span>
<span class="c">// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c">// copies of the Software, and to permit persons to whom the Software is</span>
<span class="c">// furnished to do so, subject to the following conditions:</span>
<span class="c">// </span>
<span class="c">// The above copyright notice and this permission notice shall be included in</span>
<span class="c">// all copies or substantial portions of the Software.</span>
<span class="c">// </span>
<span class="c">// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c">// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c">// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c">// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c">// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c">// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="c">// THE SOFTWARE.</span>
 
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Linq</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Text</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i">SWC</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Controls</span>;
<b>using</b> <span class="i">SWM</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i">SWD</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Documents</span>;
 
<b>using</b> <span class="i n">Xwt</span>.<span class="i n">Backends</span>;
 
<b>namespace</b> <span class="i n">Xwt</span>.<span class="i n">WPFBackend</span>
{
	<b>public class</b> <a id="7b3580f9bbd6991d" href="../R/7b3580f9bbd6991d.html" target="n" data-glyph="0,0" class="t t">LabelBackend</a> : <a href="WidgetBackend.cs.html#551a9684f2eb2b53" class="t t">WidgetBackend</a>, <a href="/Xwt3/A.html#69e00b78df0376b0" class="t t">ILabelBackend</a>
	{
		<b>public</b> <a id="df66c413491c1084" href="../R/../../0000000000.html" target="n" data-glyph="72,1" class="i constructor">LabelBackend</a> ()
		{
			<a href="WidgetBackend.cs.html#bfe5b8d8f773f1ef" class="i property">Widget</a> = <b>new</b> <a href="#3dbc40c5bed2651b" class="t constructor">WpfLabel</a> ();
		}
 
		<a href="#e0db6e41ae01a82b" class="t t">WpfLabel</a> <a id="88b82c74ffb1431f" href="../R/88b82c74ffb1431f.html" target="n" data-glyph="106,1" class="i property">Label</a> {
			<b>get</b> { <b>return</b> (<a href="#e0db6e41ae01a82b" class="t t">WpfLabel</a>)<a href="WidgetBackend.cs.html#bfe5b8d8f773f1ef" class="i property">Widget</a>; }
		}
 
		<b>new</b> <a href="/Xwt3/A.html#75cdeba9ad3f8eee" class="t t">ILabelEventSink</a> <a id="c7f661c134ceb86a" href="../R/c7f661c134ceb86a.html" target="n" data-glyph="106,1" class="i property">EventSink</a>
		{
			<b>get</b> { <b>return</b> (<a href="/Xwt3/A.html#75cdeba9ad3f8eee" class="t t">ILabelEventSink</a>)<a href="WidgetBackend.cs.html#551a9684f2eb2b53" class="k">base</a>.<a href="WidgetBackend.cs.html#6eebdc0ff8c33e10" class="i property">EventSink</a>; }
		}
 
		<b>public override</b> <a href="/Xwt3/A.html#eac7fbe727da55f3" class="t t">Size</a> <a id="74bb0ee1b0a2b483" href="../R/74bb0ee1b0a2b483.html" target="n" data-glyph="72,1" class="i method">GetPreferredSize</a> (<a href="/Xwt3/A.html#2b0499fa5e00539f" class="t t">SizeConstraint</a> <span id="r0 rd" class="r0 r">widthConstraint</span>, <a href="/Xwt3/A.html#2b0499fa5e00539f" class="t t">SizeConstraint</a> <span id="r1 rd" class="r1 r">heightConstraint</span>)
		{
			<a href="/Xwt3/A.html#eac7fbe727da55f3" class="k">var</a> <span id="r2 rd" class="r2 r">s</span> = <a href="WidgetBackend.cs.html#551a9684f2eb2b53" class="k">base</a>.<a href="WidgetBackend.cs.html#455dc76e64a73823" class="i method">GetPreferredSize</a> (<span class="r0 r">widthConstraint</span>, <span class="r1 r">heightConstraint</span>);
 
			<span class="c">// If the label is ellipsized or can wrap then the width can&#39;t be dermined unless we have a constraint.</span>
			<span class="c">// If there is no constraint, just return the smallest size</span>
			<b>if</b> (!<span class="r0 r">widthConstraint</span>.<a href="/Xwt3/A.html#818759621defd99c" class="i property">IsConstrained</a> &amp;&amp; (<a href="#312aeb5d45bbfceb" class="i property">Wrap</a> != <a href="/Xwt3/A.html#002ffb320a30f339" class="t t">WrapMode</a>.<a href="/Xwt3/A.html#736241d8643eb31a" class="i field">None</a> || <a href="#d99f84c8da208de9" class="i property">Ellipsize</a> != <a href="/Xwt3/A.html#388f71337813aad9" class="t t">EllipsizeMode</a>.<a href="/Xwt3/A.html#fde49f7710912983" class="i field">None</a>))
				<span class="r2 r">s</span>.<a href="/Xwt3/A.html#cc006e4112f202b8" class="i property">Width</a> = 1;
			<b>return</b> <span class="r2 r">s</span>;
		}
 
		<b>public string</b> <a id="a9de38130ffdd3ea" href="../R/a9de38130ffdd3ea.html" target="n" data-glyph="102,1" class="i property">Text</a> {
			<b>get</b> { <b>return</b> <a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#e77c881b0d6f7e9e" class="i property">Text</a>; }
			<b>set</b> {
				<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#e77c881b0d6f7e9e" class="i property">Text</a> = <b>value</b>;
				<a href="WidgetBackend.cs.html#bfe5b8d8f773f1ef" class="i property">Widget</a>.<a href="@0@PresentationCore/A.html#45a2b3d7f602e83f" class="i method">InvalidateMeasure</a>();
			}
		}
 
		<b>public void</b> <a id="959ceaf00591002e" href="../R/959ceaf00591002e.html" target="n" data-glyph="72,1" class="i method">SetFormattedText</a> (<a href="/Xwt3/A.html#d3be5d9c017f5948" class="t t">FormattedText</a> <span id="r3 rd" class="r3 r">text</span>)
		{
			<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="k">var</a> <span id="r4 rd" class="r4 r">atts</span> = <b>new</b> <a href="@0@mscorlib/A.html#d2ac2c19c9cf1d44" class="t constructor">List</a>&lt;<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a>&gt; (<span class="r3 r">text</span>.<a href="/Xwt3/A.html#00987fd3a612d752" class="i property">Attributes</a>);
			<span class="r4 r">atts</span>.<a href="@0@mscorlib/A.html#a406b86aecf46aa1" class="i method">Sort</a> ((<span id="r5 rd" class="r5 r">a</span>, <span id="r6 rd" class="r6 r">b</span>) =&gt; {
				<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r7 rd" class="r7 r">c</span> = <span class="r5 r">a</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>.<a href="@0@mscorlib/A.html#cdfcead877b41ccc" class="i method">CompareTo</a> (<span class="r6 r">b</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>);
				<b>if</b> (<span class="r7 r">c</span> == 0)
					<span class="r7 r">c</span> = -(<span class="r5 r">a</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>.<a href="@0@mscorlib/A.html#cdfcead877b41ccc" class="i method">CompareTo</a> (<span class="r6 r">b</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>));
				<b>return</b> <span class="r7 r">c</span>;
			});
 
			<b>int</b> <span id="r8 rd" class="r8 r">i</span> = 0, <span id="r9 rd" class="r9 r">attrIndex</span> = 0;
			<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#1e1edcaf59a87425" class="i property">Inlines</a>.<a href="@0@PresentationFramework/A.html#3c8da4f43a4659e9" class="i method">Clear</a> ();
			<a href="#912584248a9d1925" class="i method">GenerateBlocks</a> (<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#1e1edcaf59a87425" class="i property">Inlines</a>, <span class="r3 r">text</span>.<a href="/Xwt3/A.html#25e22b6be1d43716" class="i property">Text</a>, <b>ref</b> <span class="r8 r">i</span>, <span class="r3 r">text</span>.<a href="/Xwt3/A.html#25e22b6be1d43716" class="i property">Text</a>.<a href="@0@mscorlib/A.html#e13f5829ef28aa07" class="i property">Length</a>, <span class="r4 r">atts</span>, <b>ref</b> <span class="r9 r">attrIndex</span>);
		}
 
		<b>void</b> <a id="912584248a9d1925" href="../R/912584248a9d1925.html" target="n" data-glyph="76,1" class="i method">GenerateBlocks</a> (<span class="i n">SWD</span>.<a href="@0@PresentationFramework/A.html#651007228228ce66" class="t t">InlineCollection</a> <span id="r10 rd" class="r10 r">col</span>, <b>string</b> <span id="r11 rd" class="r11 r">text</span>, <b>ref int</b> <span id="r12 rd" class="r12 r">i</span>, <b>int</b> <span id="r13 rd" class="r13 r">spanEnd</span>, <a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a>&gt; <span id="r14 rd" class="r14 r">attributes</span>, <b>ref int</b> <span id="r15 rd" class="r15 r">attrIndex</span>)
		{
			<b>while</b> (<span class="r15 r">attrIndex</span> &lt; <span class="r14 r">attributes</span>.<a href="@0@mscorlib/A.html#78a69d857716bc68" class="i property">Count</a>) {
				<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="k">var</a> <span id="r16 rd" class="r16 r">at</span> = <span class="r14 r">attributes</span><a href="@0@mscorlib/A.html#0c65bec4d3fac21e">[</a><span class="r15 r">attrIndex</span>];
				<b>if</b> (<span class="r16 r">at</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a> &gt; <span class="r13 r">spanEnd</span>) {
					<a href="#2308e5bc1e05121b" class="i method">FlushText</a> (<span class="r10 r">col</span>, <span class="r11 r">text</span>, <b>ref</b> <span class="r12 r">i</span>, <span class="r13 r">spanEnd</span>);
					<b>return</b>;
				}
 
				<a href="#2308e5bc1e05121b" class="i method">FlushText</a> (<span class="r10 r">col</span>, <span class="r11 r">text</span>, <b>ref</b> <span class="r12 r">i</span>, <span class="r16 r">at</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>);
 
				<a href="@0@PresentationFramework/A.html#be5c6e4c02b1655f" class="k">var</a> <span id="r17 rd" class="r17 r">s</span> = <b>new</b> <span class="i n">SWD</span>.<a href="@0@PresentationFramework/A.html#bf26912e0435bf3f" class="t constructor">Span</a> ();
 
				<b>if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#7f60927c00a2fd32" class="t t">BackgroundTextAttribute</a>) {
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#6d3a2970ab704541" class="i property">Background</a> = <b>new</b> <span class="i n">SWM</span>.<a href="@0@PresentationCore/A.html#28be7a261187a210" class="t constructor">SolidColorBrush</a> (((<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#7f60927c00a2fd32" class="t t">BackgroundTextAttribute</a>)<span class="r16 r">at</span>).<a href="/Xwt3/A.html#b34b25ddd82df7bc" class="i property">Color</a>.<a href="DataConverter.cs.html#fa6d926c9d2ffd8d" class="i method">ToWpfColor</a> ());
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#d05639d763175e99" class="t t">FontWeightTextAttribute</a>) {
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#5b63d7313053dbc5" class="i property">FontWeight</a> = ((<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#d05639d763175e99" class="t t">FontWeightTextAttribute</a>)<span class="r16 r">at</span>).<a href="/Xwt3/A.html#093b4e3aa730a875" class="i property">Weight</a>.<a href="DataConverter.cs.html#e6cf3acebf10da8e" class="i method">ToWpfFontWeight</a> ();
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#b5e090085414eb0e" class="t t">FontStyleTextAttribute</a>) {
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#c71a7a0ffc68e4b8" class="i property">FontStyle</a> = ((<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#b5e090085414eb0e" class="t t">FontStyleTextAttribute</a>)<span class="r16 r">at</span>).<a href="/Xwt3/A.html#54df54db9a9eef3b" class="i property">Style</a>.<a href="DataConverter.cs.html#2c18bfc19579fb4c" class="i method">ToWpfFontStyle</a> ();
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="t t">UnderlineTextAttribute</a>) {
					<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="k">var</a> <span id="r18 rd" class="r18 r">xa</span> = (<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="t t">UnderlineTextAttribute</a>)<span class="r16 r">at</span>;
					<a href="@0@PresentationCore/A.html#8d5115110ba6bf74" class="k">var</a> <span id="r19 rd" class="r19 r">dec</span> = <b>new</b> <a href="@0@PresentationCore/A.html#0d26d1e9fb65a657" class="t constructor">TextDecoration</a> (<a href="@0@PresentationCore/A.html#cf6362fe98bf924c" class="t t">TextDecorationLocation</a>.<a href="@0@PresentationCore/A.html#951885da76e07e5b" class="i field">Underline</a>, <b>null</b>, 0, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>);
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#57baac7953db39f1" class="i property">TextDecorations</a>.<a href="@0@PresentationCore/A.html#97ae40bf4ba0d9c2" class="i method">Add</a> (<span class="r19 r">dec</span>);
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#c8f7050c170d49f8" class="t t">StrikethroughTextAttribute</a>) {
					<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="k">var</a> <span id="r20 rd" class="r20 r">xa</span> = (<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="t t">UnderlineTextAttribute</a>)<span class="r16 r">at</span>;
					<a href="@0@PresentationCore/A.html#8d5115110ba6bf74" class="k">var</a> <span id="r21 rd" class="r21 r">dec</span> = <b>new</b> <a href="@0@PresentationCore/A.html#0d26d1e9fb65a657" class="t constructor">TextDecoration</a> (<a href="@0@PresentationCore/A.html#cf6362fe98bf924c" class="t t">TextDecorationLocation</a>.<a href="@0@PresentationCore/A.html#7216541c860b6e40" class="i field">Strikethrough</a>, <b>null</b>, 0, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>);
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#57baac7953db39f1" class="i property">TextDecorations</a>.<a href="@0@PresentationCore/A.html#97ae40bf4ba0d9c2" class="i method">Add</a> (<span class="r21 r">dec</span>);
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#bf5628fd567376d4" class="t t">FontTextAttribute</a>) {
					<a href="/Xwt3/A.html#bf5628fd567376d4" class="k">var</a> <span id="r22 rd" class="r22 r">xa</span> = (<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#bf5628fd567376d4" class="t t">FontTextAttribute</a>)<span class="r16 r">at</span>;
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#304be1d0ee522e88" class="i property">FontFamily</a> = <b>new</b> <span class="i n">SWM</span>.<a href="@0@PresentationCore/A.html#a689959282d4aced" class="t constructor">FontFamily</a> (<span class="r22 r">xa</span>.<a href="/Xwt3/A.html#18e5c5cf54cf8548" class="i property">Font</a>.<a href="/Xwt3/A.html#33887674b424a2d7" class="i property">Family</a>);
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#4d12086583efc308" class="i property">FontSize</a> = <a href="FontBackendHandler.cs.html#d709ba6a2add5e78" class="t t">WpfFontBackendHandler</a>.<a href="FontBackendHandler.cs.html#5f84b4de8e7c588c" class="i method">GetPointsFromDeviceUnits</a> (<span class="r22 r">xa</span>.<a href="/Xwt3/A.html#18e5c5cf54cf8548" class="i property">Font</a>.<a href="/Xwt3/A.html#be1c4ba3d273eeba" class="i property">Size</a>);
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#db2c13d23e8c62d9" class="i property">FontStretch</a> = <span class="r22 r">xa</span>.<a href="/Xwt3/A.html#18e5c5cf54cf8548" class="i property">Font</a>.<a href="/Xwt3/A.html#61b51a5c8ab844f1" class="i property">Stretch</a>.<a href="DataConverter.cs.html#c4b890be03f74c5c" class="i method">ToWpfFontStretch</a> ();
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#c71a7a0ffc68e4b8" class="i property">FontStyle</a> = <span class="r22 r">xa</span>.<a href="/Xwt3/A.html#18e5c5cf54cf8548" class="i property">Font</a>.<a href="/Xwt3/A.html#68d16e67c0f689a0" class="i property">Style</a>.<a href="DataConverter.cs.html#2c18bfc19579fb4c" class="i method">ToWpfFontStyle</a> ();
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#5b63d7313053dbc5" class="i property">FontWeight</a> = <span class="r22 r">xa</span>.<a href="/Xwt3/A.html#18e5c5cf54cf8548" class="i property">Font</a>.<a href="/Xwt3/A.html#54339273f126510b" class="i property">Weight</a>.<a href="DataConverter.cs.html#e6cf3acebf10da8e" class="i method">ToWpfFontWeight</a> ();
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#0af3f26d74571603" class="t t">ColorTextAttribute</a>) {
					<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#8904cbacad6f430c" class="i property">Foreground</a> = <b>new</b> <span class="i n">SWM</span>.<a href="@0@PresentationCore/A.html#28be7a261187a210" class="t constructor">SolidColorBrush</a> (((<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#0af3f26d74571603" class="t t">ColorTextAttribute</a>)<span class="r16 r">at</span>).<a href="/Xwt3/A.html#6de7d18bb065e476" class="i property">Color</a>.<a href="DataConverter.cs.html#fa6d926c9d2ffd8d" class="i method">ToWpfColor</a> ());
				}
				<b>else if</b> (<span class="r16 r">at</span> <b>is</b> <span class="i n">Drawing</span>.<a href="/Xwt3/A.html#9d6c217bfc294453" class="t t">LinkTextAttribute</a>) {
					<a href="@0@PresentationFramework/A.html#2c1c85ab1e41c25a" class="k">var</a> <span id="r23 rd" class="r23 r">link</span> = <b>new</b> <span class="i n">SWD</span>.<a href="@0@PresentationFramework/A.html#e7ce362d3c375c0f" class="t constructor">Hyperlink</a> () {
						<a href="@0@PresentationFramework/A.html#2d26969d721db995" class="i property">NavigateUri</a> = ((<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#9d6c217bfc294453" class="t t">LinkTextAttribute</a>)<span class="r16 r">at</span>).<a href="/Xwt3/A.html#660cb7d3fe594b62" class="i property">Target</a>
					};
					<span class="r23 r">link</span>.<a href="@0@PresentationFramework/A.html#8e521c037b76f594" class="i">RequestNavigate</a> += <b>new</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Navigation</span>.<span class="t">RequestNavigateEventHandler</span> (<a href="#f307c6153913efda" class="i method">link_RequestNavigate</a>);
					<span class="r17 r">s</span> = <span class="r23 r">link</span>;
				}
 
				<span class="r10 r">col</span>.<a href="@0@PresentationFramework/A.html#4137d7b316f7d0b0" class="i method">Add</a> (<span class="r17 r">s</span>);
 
				<a href="@0@mscorlib/A.html#225942ed7b7a3252" class="k">var</a> <span id="r24 rd" class="r24 r">max</span> = <span class="r12 r">i</span> + <span class="r16 r">at</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>;
				<b>if</b> (<span class="r24 r">max</span> &gt; <span class="r13 r">spanEnd</span>)
					<span class="r24 r">max</span> = <span class="r13 r">spanEnd</span>;
 
				<span class="r15 r">attrIndex</span>++;
				<a href="#912584248a9d1925" class="i method">GenerateBlocks</a> (<span class="r17 r">s</span>.<a href="@0@PresentationFramework/A.html#2ec80c36805cbaca" class="i property">Inlines</a>, <span class="r11 r">text</span>, <b>ref</b> <span class="r12 r">i</span>, <span class="r12 r">i</span> + <span class="r16 r">at</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>, <span class="r14 r">attributes</span>, <b>ref</b> <span class="r15 r">attrIndex</span>);
			}
			<a href="#2308e5bc1e05121b" class="i method">FlushText</a> (<span class="r10 r">col</span>, <span class="r11 r">text</span>, <b>ref</b> <span class="r12 r">i</span>, <span class="r13 r">spanEnd</span>);
		}
 
		<b>void</b> <a id="f307c6153913efda" href="../R/f307c6153913efda.html" target="n" data-glyph="76,1" class="i method">link_RequestNavigate</a> (<b>object</b> <span id="r25 rd" class="r25 r">sender</span>, <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Navigation</span>.<a href="@0@PresentationFramework/A.html#16335d2d5adb09a5" class="t t">RequestNavigateEventArgs</a> <span id="r26 rd" class="r26 r">e</span>)
		{
			<a href="Backend.cs.html#a1d66241a0d4621f" class="i property">Context</a>.<a href="/Xwt3/A.html#5db8b61c4608e0e0" class="i method">InvokeUserCode</a> (<b>delegate</b> {
				<a href="#c7f661c134ceb86a" class="i property">EventSink</a>.<a href="/Xwt3/A.html#f922796a66e62883" class="i method">OnLinkClicked</a> (<span class="r26 r">e</span>.<a href="@0@PresentationFramework/A.html#5bf1ab0fc13f4c93" class="i property">Uri</a>);
			});
		}
 
		<b>void</b> <a id="2308e5bc1e05121b" href="../R/2308e5bc1e05121b.html" target="n" data-glyph="76,1" class="i method">FlushText</a> (<span class="i n">SWD</span>.<a href="@0@PresentationFramework/A.html#651007228228ce66" class="t t">InlineCollection</a> <span id="r27 rd" class="r27 r">col</span>, <b>string</b> <span id="r28 rd" class="r28 r">text</span>, <b>ref int</b> <span id="r29 rd" class="r29 r">i</span>, <b>int</b> <span id="r30 rd" class="r30 r">pos</span>)
		{
			<b>if</b> (<span class="r30 r">pos</span> &gt; <span class="r29 r">i</span>) {
				<span class="r27 r">col</span>.<a href="@0@PresentationFramework/A.html#138056758f48d77a" class="i method">Add</a> (<span class="r28 r">text</span>.<a href="@0@mscorlib/A.html#8124961f027d9ac9" class="i method">Substring</a> (<span class="r29 r">i</span>, <span class="r30 r">pos</span> - <span class="r29 r">i</span>));
				<span class="r29 r">i</span> = <span class="r30 r">pos</span>;
			}
		}
 
		<b>public</b> <span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#773e78572598ea91" class="t t">Color</a> <a id="1f63950659dbe010" href="../R/1f63950659dbe010.html" target="n" data-glyph="102,1" class="i property">TextColor</a> {
			<b>get</b> {
				<span class="i n">SWM</span>.<a href="@0@PresentationCore/A.html#9c469acbf7b2cb81" class="t t">Color</a> <span id="r31 rd" class="r31 r">color</span> = <a href="@0@PresentationFramework/A.html#1483e0bd2b6f4573" class="t t">SystemColors</a>.<a href="@0@PresentationFramework/A.html#585a68b3e6226a7c" class="i property">ControlColor</a>;
 
				<b>if</b> (<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="@0@PresentationFramework/A.html#21b5be493ba2b86f" class="i property">Foreground</a> != <b>null</b>)
					<span class="r31 r">color</span> = ((<span class="i n">SWM</span>.<a href="@0@PresentationCore/A.html#2bdb4a721050df52" class="t t">SolidColorBrush</a>) <a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="@0@PresentationFramework/A.html#21b5be493ba2b86f" class="i property">Foreground</a>).<a href="@0@PresentationCore/A.html#eed7cf36d73cf29b" class="i property">Color</a>;
 
				<b>return</b> <a href="DataConverter.cs.html#2c4c5d9875573746" class="t t">DataConverter</a>.<a href="DataConverter.cs.html#bdc13e618e9c17be" class="i method">ToXwtColor</a> (<span class="r31 r">color</span>);
			}
			<b>set</b> {
				<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="@0@PresentationFramework/A.html#21b5be493ba2b86f" class="i property">Foreground</a> = <a href="ResPool.cs.html#ca19aa5fc4bdc296" class="t t">ResPool</a>.<a href="ResPool.cs.html#e4f9ffe475596450" class="i method">GetSolidBrush</a> (<b>value</b>);
			}
		}
 
		<b>public</b> <a href="/Xwt3/A.html#6346bcb1b4480f07" class="t t">Alignment</a> <a id="d39a4a9955a737da" href="../R/d39a4a9955a737da.html" target="n" data-glyph="102,1" class="i property">TextAlignment</a> {
			<b>get</b> { <b>return</b> <a href="DataConverter.cs.html#2c4c5d9875573746" class="t t">DataConverter</a>.<a href="DataConverter.cs.html#1230ac394a4038c4" class="i method">ToXwtAlignment</a> (<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="@0@PresentationFramework/A.html#947eb3f8b8b89319" class="i property">HorizontalContentAlignment</a>); }
			<b>set</b> { 
				<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="@0@PresentationFramework/A.html#947eb3f8b8b89319" class="i property">HorizontalContentAlignment</a> = <a href="DataConverter.cs.html#2c4c5d9875573746" class="t t">DataConverter</a>.<a href="DataConverter.cs.html#d0763cacdcf2b88c" class="i method">ToWpfAlignment</a> (<b>value</b>); 
				<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#4d150cf0aad860e0" class="i property">TextAlignment</a> = <a href="DataConverter.cs.html#2c4c5d9875573746" class="t t">DataConverter</a>.<a href="DataConverter.cs.html#a9b23a896fc16ffc" class="i method">ToTextAlignment</a> (<b>value</b>);
			}
		}
 
		<b>public</b> <a href="/Xwt3/A.html#388f71337813aad9" class="t t">EllipsizeMode</a> <a id="d99f84c8da208de9" href="../R/d99f84c8da208de9.html" target="n" data-glyph="102,1" class="i property">Ellipsize</a> {
			<b>get</b> {
				<b>if</b> (<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#639bb03fad4d8cb2" class="i property">TextTrimming</a> == <a href="@0@PresentationCore/A.html#98947646308d12be" class="t t">TextTrimming</a>.<a href="@0@PresentationCore/A.html#3fef0c84ff6c8cff" class="i field">None</a>)
					<b>return</b> <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#388f71337813aad9" class="t t">EllipsizeMode</a>.<a href="/Xwt3/A.html#fde49f7710912983" class="i field">None</a>;
				<b>else
					return</b> <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#388f71337813aad9" class="t t">EllipsizeMode</a>.<a href="/Xwt3/A.html#216099a8baf9b4f4" class="i field">End</a>;
			}
			<b>set</b> {
				<b>if</b> (<b>value</b> == <a href="/Xwt3/A.html#388f71337813aad9" class="t t">EllipsizeMode</a>.<a href="/Xwt3/A.html#fde49f7710912983" class="i field">None</a>)
					<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#639bb03fad4d8cb2" class="i property">TextTrimming</a> = <a href="@0@PresentationCore/A.html#98947646308d12be" class="t t">TextTrimming</a>.<a href="@0@PresentationCore/A.html#3fef0c84ff6c8cff" class="i field">None</a>;
				<b>else</b>
					<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#639bb03fad4d8cb2" class="i property">TextTrimming</a> = <a href="@0@PresentationCore/A.html#98947646308d12be" class="t t">TextTrimming</a>.<a href="@0@PresentationCore/A.html#4e8bfb82d55dfe91" class="i field">CharacterEllipsis</a>;
				<a href="WidgetBackend.cs.html#bfe5b8d8f773f1ef" class="i property">Widget</a>.<a href="@0@PresentationCore/A.html#45a2b3d7f602e83f" class="i method">InvalidateMeasure</a> ();
			}
		}
 
		<b>public</b> <a href="/Xwt3/A.html#002ffb320a30f339" class="t t">WrapMode</a> <a id="312aeb5d45bbfceb" href="../R/312aeb5d45bbfceb.html" target="n" data-glyph="102,1" class="i property">Wrap</a> {
			<b>get</b> {
				<b>if</b> (<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#3d67126992ff4b83" class="i property">TextWrapping</a> == <a href="@0@PresentationCore/A.html#06cbdc94c6ffe9f2" class="t t">TextWrapping</a>.<a href="@0@PresentationCore/A.html#bd3559ec52aa50e0" class="i field">NoWrap</a>)
					<b>return</b> <a href="/Xwt3/A.html#002ffb320a30f339" class="t t">WrapMode</a>.<a href="/Xwt3/A.html#736241d8643eb31a" class="i field">None</a>;
				<b>else
					return</b> <a href="/Xwt3/A.html#002ffb320a30f339" class="t t">WrapMode</a>.<a href="/Xwt3/A.html#7bd22c4bb779c82f" class="i field">Word</a>;
			} <b>set</b> {
				<b>if</b> (<b>value</b> == <a href="/Xwt3/A.html#002ffb320a30f339" class="t t">WrapMode</a>.<a href="/Xwt3/A.html#736241d8643eb31a" class="i field">None</a>)
					<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#3d67126992ff4b83" class="i property">TextWrapping</a> = <a href="@0@PresentationCore/A.html#06cbdc94c6ffe9f2" class="t t">TextWrapping</a>.<a href="@0@PresentationCore/A.html#bd3559ec52aa50e0" class="i field">NoWrap</a>;
				<b>else</b>
					<a href="#88b82c74ffb1431f" class="i property">Label</a>.<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>.<a href="@0@PresentationFramework/A.html#3d67126992ff4b83" class="i property">TextWrapping</a> = <a href="@0@PresentationCore/A.html#06cbdc94c6ffe9f2" class="t t">TextWrapping</a>.<a href="@0@PresentationCore/A.html#0f519f2db63336a5" class="i field">Wrap</a>;
			}
		}
	}
 
	<b>class</b> <a id="e0db6e41ae01a82b" href="../R/e0db6e41ae01a82b.html" target="n" data-glyph="2,0" class="t t">WpfLabel</a> : <span class="i n">SWC</span>.<a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="t t">Label</a>, <a href="WidgetBackend.cs.html#cc0e50a0d5748c2d" class="t t">IWpfWidget</a>
	{
		<b>public</b> <a id="3dbc40c5bed2651b" href="../R/3dbc40c5bed2651b.html" target="n" data-glyph="72,1" class="i constructor">WpfLabel</a> ()
		{
			<a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a> = <b>new</b> <span class="i n">SWC</span>.<a href="@0@PresentationFramework/A.html#450e4175035f484c" class="t constructor">TextBlock</a> ();
			<a href="@0@PresentationFramework/A.html#2811283b5ba60413" class="i property">Content</a> = <a href="#e6d03ffd2dc7b0cf" class="i property">TextBlock</a>;
			<a href="@0@PresentationFramework/A.html#8e668d558ec8d7ab" class="i property">Padding</a> = <b>new</b> <a href="@0@PresentationFramework/A.html#f24f92e6dee837d3" class="t constructor">Thickness</a> (0);
			<a href="@0@PresentationFramework/A.html#2654000a96521782" class="i property">VerticalContentAlignment</a> = <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#8b1564c617a0b2f5" class="t t">VerticalAlignment</a>.<a href="@0@PresentationFramework/A.html#370d572f36d471f7" class="i field">Center</a>;
		}
 
		<b>public</b> <a href="WidgetBackend.cs.html#551a9684f2eb2b53" class="t t">WidgetBackend</a> <a id="2794abfdc25a5132" href="../R/2794abfdc25a5132.html" target="n" data-glyph="102,1" class="i property">Backend</a> { <b>get</b>; <b>set</b>; }
 
		<b>protected override</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@WindowsBase/A.html#a844b9b525c2088c" class="t t">Size</a> <a id="08a169bc9d715a1e" href="../R/08a169bc9d715a1e.html" target="n" data-glyph="75,1" class="i method">MeasureOverride</a> (<span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@WindowsBase/A.html#a844b9b525c2088c" class="t t">Size</a> <span id="r32 rd" class="r32 r">constraint</span>)
		{
			<a href="@0@WindowsBase/A.html#a844b9b525c2088c" class="k">var</a> <span id="r33 rd" class="r33 r">s</span> = <a href="@0@PresentationFramework/A.html#561ac62b5ff618be" class="k">base</a>.<a href="@0@PresentationFramework/A.html#df065fbb00809e59" class="i method">MeasureOverride</a> (<span class="r32 r">constraint</span>);
			<b>return</b> <a href="#2794abfdc25a5132" class="i property">Backend</a>.<a href="WidgetBackend.cs.html#10b9740f443f1be6" class="i method">MeasureOverride</a> (<span class="r32 r">constraint</span>, <span class="r33 r">s</span>);
		}
 
		<b>public</b> <span class="i n">SWC</span>.<a href="@0@PresentationFramework/A.html#f469b4aeb3697bb8" class="t t">TextBlock</a> <a id="e6d03ffd2dc7b0cf" href="../R/e6d03ffd2dc7b0cf.html" target="n" data-glyph="102,1" class="i property">TextBlock</a> {
			<b>get</b>;
			<b>set</b>;
		}
	}
}
</pre></td></tr></table></div></body></html>
