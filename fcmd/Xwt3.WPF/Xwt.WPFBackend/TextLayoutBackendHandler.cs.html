<!DOCTYPE html>
<html><head><title>TextLayoutBackendHandler.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(298);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#Xwt3.WPF/Xwt.WPFBackend/TextLayoutBackendHandler.cs" target="_top">Xwt.WPFBackend\TextLayoutBackendHandler.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#Xwt3.WPF" target="_top">xwt\Xwt.WPF\Xwt3.WPF.csproj</a> (Xwt3.WPF)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">//</span>
<span class="c">// TextLayoutBackendHandler.cs</span>
<span class="c">//</span>
<span class="c">// Author:</span>
<span class="c">//       Eric Maupin &lt;ermau@xamarin.com&gt;</span>
<span class="c">//       Lytico (http://limada.sourceforge.net)</span>
<span class="c">//</span>
<span class="c">// Copyright (c) 2012 Xamarin, Inc.</span>
<span class="c">//</span>
<span class="c">// Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c">// of this software and associated documentation files (the &quot;Software&quot;), to deal</span>
<span class="c">// in the Software without restriction, including without limitation the rights</span>
<span class="c">// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span>
<span class="c">// copies of the Software, and to permit persons to whom the Software is</span>
<span class="c">// furnished to do so, subject to the following conditions:</span>
<span class="c">//</span>
<span class="c">// The above copyright notice and this permission notice shall be included in</span>
<span class="c">// all copies or substantial portions of the Software.</span>
<span class="c">//</span>
<span class="c">// THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c">// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c">// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c">// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c">// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span>
<span class="c">// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span>
<span class="c">// THE SOFTWARE.</span>

<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">Xwt</span>.<span class="i n">Backends</span>;
<b>using</b> <span class="i n">Xwt</span>.<span class="i n">Drawing</span>;

<b>using</b> <span class="t">Font</span> = <span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#66915aad26bd67c5" class="t t">Font</a>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Collections</span>.<span class="i n">Generic</span>;

<b>namespace</b> <span class="i n">Xwt</span>.<span class="i n">WPFBackend</span>
{
	<b>public class</b> <a id="47a0e88fc414f417" href="../R/47a0e88fc414f417.html" target="n" data-glyph="0,0" class="t t"><span id="b6497327267dde02">WpfTextLayoutBackendHandler</span></a>
		: <a href="/Xwt3/A.html#52c49e6a385b6ec5" class="t t">TextLayoutBackendHandler</a>
	{
		<b>public override object</b> <a id="7716cdd7b11eeee9" href="../R/7716cdd7b11eeee9.html" target="n" data-glyph="72,1" class="i method">Create</a> ()
		{
			<b>return</b> <b>new</b> <a href="#893d65fbb95e745f" class="t constructor">TextLayoutBackend</a> ();
		}

		<b>public override void</b> <a id="b62ecac18385dd3c" href="../R/b62ecac18385dd3c.html" target="n" data-glyph="72,1" class="i method">SetWidth</a> (<b>object</b> <span id="r0 rd" class="r0 r">backend</span>, <b>double</b> <span id="r1 rd" class="r1 r">value</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r2 rd" class="r2 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r0 r">backend</span>;
			<span class="r2 r">t</span>.<a href="#dfd928c1948ea9a8" class="i method">SetWidth</a>(<span class="r1 r">value</span>);
		}

		<b>public override void</b> <a id="4e5d9c9057e9a75b" href="../R/4e5d9c9057e9a75b.html" target="n" data-glyph="72,1" class="i method">SetHeight</a> (<b>object</b> <span id="r3 rd" class="r3 r">backend</span>, <b>double</b> <span id="r4 rd" class="r4 r">value</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r5 rd" class="r5 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r3 r">backend</span>;
			<span class="r5 r">t</span>.<a href="#8d71a2491d564ce5" class="i method">SetHeight</a>(<span class="r4 r">value</span>);
		}

		<b>public override void</b> <a id="8920b6edbb1344ee" href="../R/8920b6edbb1344ee.html" target="n" data-glyph="72,1" class="i method">SetText</a> (<b>object</b> <span id="r6 rd" class="r6 r">backend</span>, <b>string</b> <span id="r7 rd" class="r7 r">text</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r8 rd" class="r8 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r6 r">backend</span>;
			<span class="r8 r">t</span>.<a href="#8d43401e0a6791b8" class="i method">SetText</a>(<span class="r7 r">text</span>);
		}

		<b>public override void</b> <a id="c5e7e74a5367a4a8" href="../R/c5e7e74a5367a4a8.html" target="n" data-glyph="72,1" class="i method">SetFont</a> (<b>object</b> <span id="r9 rd" class="r9 r">backend</span>, <a href="/Xwt3/A.html#66915aad26bd67c5" class="t t">Font</a> <span id="r10 rd" class="r10 r">font</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r11 rd" class="r11 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r9 r">backend</span>;
			<span class="r11 r">t</span>.<a href="#33e64deaff44b2a2" class="i method">SetFont</a> (<span class="r10 r">font</span>);
		}

		<b>public override void</b> <a id="866e47a907ec35a5" href="../R/866e47a907ec35a5.html" target="n" data-glyph="72,1" class="i method">SetTrimming</a> (<b>object</b> <span id="r12 rd" class="r12 r">backend</span>, <span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#1de422b79a5c8b5c" class="t t">TextTrimming</a> <span id="r13 rd" class="r13 r">textTrimming</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r14 rd" class="r14 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r12 r">backend</span>;
			<span class="r14 r">t</span>.<a href="#dfe3c069ad028545" class="i method">SetTrimming</a>(<span class="r13 r">textTrimming</span>);
		}

		<b>public override</b> <a href="/Xwt3/A.html#eac7fbe727da55f3" class="t t">Size</a> <a id="7de641f6ba9e7e15" href="../R/7de641f6ba9e7e15.html" target="n" data-glyph="72,1" class="i method">GetSize</a> (<b>object</b> <span id="r15 rd" class="r15 r">backend</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r16 rd" class="r16 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r15 r">backend</span>;
			<b>return</b> <b>new</b> <a href="/Xwt3/A.html#a7fd0b1ede9d65f0" class="t constructor">Size</a> (<span class="r16 r">t</span>.<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#d1e82438c91ecdd3" class="i property">WidthIncludingTrailingWhitespace</a>, <span class="r16 r">t</span>.<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#36bb27badeb1c8bd" class="i property">Height</a>);
		}

		<b>public override</b> <a href="/Xwt3/A.html#0e54e87b6e891b4f" class="t t">Point</a> <a id="af7a44cab0291f80" href="../R/af7a44cab0291f80.html" target="n" data-glyph="72,1" class="i method">GetCoordinateFromIndex</a> (<b>object</b> <span id="r17 rd" class="r17 r">backend</span>, <b>int</b> <span id="r18 rd" class="r18 r">index</span>)
		{
			<b>return</b> <a href="/Xwt3/A.html#0e54e87b6e891b4f" class="t t">Point</a>.<a href="/Xwt3/A.html#5e610579b9b40b70" class="i field">Zero</a>;
		}

		<b>public override int</b> <a id="08db5cae035cfa2f" href="../R/08db5cae035cfa2f.html" target="n" data-glyph="72,1" class="i method">GetIndexFromCoordinates</a> (<b>object</b> <span id="r19 rd" class="r19 r">backend</span>, <b>double</b> <span id="r20 rd" class="r20 r">x</span>, <b>double</b> <span id="r21 rd" class="r21 r">y</span>)
		{
			<b>return</b> 0;
		}

		<b>public override double</b> <a id="a26242b25c08050a" href="../R/a26242b25c08050a.html" target="n" data-glyph="72,1" class="i method">GetBaseline</a> (<b>object</b> <span id="r22 rd" class="r22 r">backend</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r23 rd" class="r23 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r22 r">backend</span>;
			<b>return</b> <span class="r23 r">t</span>.<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#dc9afef14a212c59" class="i property">Baseline</a>;
		}

		<b>public override void</b> <a id="7c264c9c03b94548" href="../R/7c264c9c03b94548.html" target="n" data-glyph="72,1" class="i method">AddAttribute</a> (<b>object</b> <span id="r24 rd" class="r24 r">backend</span>, <a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a> <span id="r25 rd" class="r25 r">attribute</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r26 rd" class="r26 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r24 r">backend</span>;
			<span class="r26 r">t</span>.<a href="#4de82fa5560a9eba" class="i method">AddAttribute</a>(<span class="r25 r">attribute</span>);
		}

		<b>public override void</b> <a id="015cdea890aeac76" href="../R/015cdea890aeac76.html" target="n" data-glyph="72,1" class="i method">ClearAttributes</a> (<b>object</b> <span id="r27 rd" class="r27 r">backend</span>)
		{
			<a href="#893d65fbb95e745f" class="k">var</a> <span id="r28 rd" class="r28 r">t</span> = (<a href="#893d65fbb95e745f" class="t t">TextLayoutBackend</a>)<span class="r27 r">backend</span>;
			<span class="r28 r">t</span>.<a href="#dc67190529a2140b" class="i method">ClearAttributes</a>();
		}
	}

	<b>class</b> <a id="893d65fbb95e745f" href="../R/893d65fbb95e745f.html" target="n" data-glyph="2,0" class="t t"><span id="7b88772821bc78ba">TextLayoutBackend</span></a>
	{
		<b>static</b> <a href="@0@PresentationCore/A.html#5df94fa905069b7d" class="t t">Typeface</a> <a id="eede570804907170" href="../R/eede570804907170.html" target="n" data-glyph="46,1" class="i field">defaultFont</a> = <b>new</b> <a href="@0@PresentationCore/A.html#018234a8e8990e41" class="t constructor">Typeface</a>(<span class="s">&quot;Verdana&quot;</span>);

		<span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<a href="@0@PresentationCore/A.html#6e6924d547946932" class="t t">FormattedText</a> <a id="d327f192ba1dd79b" href="../R/d327f192ba1dd79b.html" target="n" data-glyph="46,1" class="i field">formattedText</a>;
		<a href="@0@mscorlib/A.html#cf7f4095e4de7646" class="t t">List</a>&lt;<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a>&gt; <a id="b719c8c685deb6cb" href="../R/b719c8c685deb6cb.html" target="n" data-glyph="46,1" class="i field">attributes</a>;
		<a href="@0@PresentationCore/A.html#2bdb4a721050df52" class="t t">SolidColorBrush</a> <a id="cd6578b815e114c7" href="../R/cd6578b815e114c7.html" target="n" data-glyph="46,1" class="i field">brush</a> = <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<a href="@0@PresentationCore/A.html#0110a86641bd833b" class="t t">Brushes</a>.<a href="@0@PresentationCore/A.html#4c63c441ae36a080" class="i property">Black</a>;
		<b>double</b> <a id="7c237a6f0f83abbc" href="../R/7c237a6f0f83abbc.html" target="n" data-glyph="46,1" class="i field">width</a>;
		<b>double</b> <a id="5218d6eb44ea099b" href="../R/5218d6eb44ea099b.html" target="n" data-glyph="46,1" class="i field">height</a>;
		<b>string</b> <a id="29058ab6f452f58a" href="../R/29058ab6f452f58a.html" target="n" data-glyph="46,1" class="i field">text</a> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
		<span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#1de422b79a5c8b5c" class="t t">TextTrimming</a>? <a id="1b56df4edaf25013" href="../R/1b56df4edaf25013.html" target="n" data-glyph="46,1" class="i field">textTrimming</a>;
		<b>bool</b> <a id="5787c509c5186881" href="../R/5787c509c5186881.html" target="n" data-glyph="46,1" class="i field">needsRebuild</a>;

		<b>public</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<a href="@0@PresentationCore/A.html#6e6924d547946932" class="t t">FormattedText</a> <a id="754c051e9091a460" href="../R/754c051e9091a460.html" target="n" data-glyph="102,1" class="i property">FormattedText</a>
		{
			<b>get</b>
			{
				<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> == <b>null</b> || <a href="#5787c509c5186881" class="i field">needsRebuild</a>)
					<a href="#e91aad4a03858b54" class="i method">Rebuild</a> ();
				<b>return</b> <a href="#d327f192ba1dd79b" class="i field">formattedText</a>;
			}
		}

		<b>public void</b> <a id="dfd928c1948ea9a8" href="../R/dfd928c1948ea9a8.html" target="n" data-glyph="72,1" class="i method">SetWidth</a>(<b>double</b> <span id="r29 rd" class="r29 r">value</span>)
		{
			<b>if</b> (<a href="#7c237a6f0f83abbc" class="i field">width</a> != <span class="r29 r">value</span>)
			{
				<a href="#7c237a6f0f83abbc" class="i field">width</a> = <span class="r29 r">value</span>;
				<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> != <b>null</b>)
				{
					<b>if</b> (<span class="r29 r">value</span> &gt;= 0)
						<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#6d93de2aaad75f34" class="i property">MaxTextWidth</a> = <span class="r29 r">value</span>;
					<b>else</b>
						<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>true</b>;
				}
			}
		}

		<b>public void</b> <a id="8d71a2491d564ce5" href="../R/8d71a2491d564ce5.html" target="n" data-glyph="72,1" class="i method">SetHeight</a>(<b>double</b> <span id="r30 rd" class="r30 r">value</span>)
		{
			<b>if</b> (<a href="#5218d6eb44ea099b" class="i field">height</a> != <span class="r30 r">value</span>)
			{
				<a href="#5218d6eb44ea099b" class="i field">height</a> = <span class="r30 r">value</span>;
				<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> != <b>null</b>)
				{
					<b>if</b> (<span class="r30 r">value</span> &gt;= 0)
						<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#77f5823c5909754c" class="i property">MaxTextHeight</a> = <span class="r30 r">value</span>;
					<b>else</b>
						<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>true</b>;
				}
			}
		}

		<b>public void</b> <a id="8d43401e0a6791b8" href="../R/8d43401e0a6791b8.html" target="n" data-glyph="72,1" class="i method">SetText</a>(<b>string</b> <span id="r31 rd" class="r31 r">text</span>)
		{
			<b>if</b> (<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#29058ab6f452f58a" class="i field">text</a> != <span class="r31 r">text</span>)
			{
				<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#29058ab6f452f58a" class="i field">text</a> = <span class="r31 r">text</span> ?? <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
				<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>true</b>;
			}
		}

		<b>public void</b> <a id="33e64deaff44b2a2" href="../R/33e64deaff44b2a2.html" target="n" data-glyph="72,1" class="i method">SetFont</a>(<a href="/Xwt3/A.html#66915aad26bd67c5" class="t t">Font</a> <span id="r32 rd" class="r32 r">font</span>)
		{
			<b>if</b> (!<span class="r32 r">font</span>.<a href="/Xwt3/A.html#e964bd50f0986561" class="i method">Equals</a>(<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#3cd3c1fb1f38cdf9" class="i property">Font</a>))
			{
				<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#3cd3c1fb1f38cdf9" class="i property">Font</a> = <span class="r32 r">font</span>;
				<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> != <b>null</b>)
					<a href="#a8be59b123c4a8fd" class="i method">ApplyFont</a>();
			}
		}

		<b>void</b> <a id="a8be59b123c4a8fd" href="../R/a8be59b123c4a8fd.html" target="n" data-glyph="76,1" class="i method">ApplyFont</a> ()
		{
			<a href="FontBackendHandler.cs.html#6682021f4e07ad66" class="k">var</a> <span id="r33 rd" class="r33 r">f</span> = (<a href="FontBackendHandler.cs.html#6682021f4e07ad66" class="t t">FontData</a>)<a href="/Xwt3/A.html#b9022100aba37d61" class="t t">Toolkit</a>.<a href="/Xwt3/A.html#adddb41b243f3371" class="i method">GetBackend</a>(<a href="#3cd3c1fb1f38cdf9" class="i property">Font</a>);
			<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#4000082028d22d9b" class="i method">SetFontFamily</a>(<span class="r33 r">f</span>.<a href="FontBackendHandler.cs.html#c2f2eb035e98634e" class="i property">Family</a>);
			<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#f2f23d42f7c87583" class="i method">SetFontSize</a>(<span class="r33 r">f</span>.<a href="FontBackendHandler.cs.html#2f517b3c757dda66" class="i method">GetDeviceIndependentPixelSize</a>());
			<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#41b04a3fab0e027c" class="i method">SetFontStretch</a>(<span class="r33 r">f</span>.<a href="FontBackendHandler.cs.html#aee6fef9618bafd0" class="i property">Stretch</a>);
			<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#4d06726c7ac0442f" class="i method">SetFontStyle</a>(<span class="r33 r">f</span>.<a href="FontBackendHandler.cs.html#934b37a9c258a5cf" class="i property">Style</a>);
			<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#ae47cca97d04fc23" class="i method">SetFontWeight</a>(<span class="r33 r">f</span>.<a href="FontBackendHandler.cs.html#9e53230563929696" class="i property">Weight</a>);
		}

		<b>public void</b> <a id="dfe3c069ad028545" href="../R/dfe3c069ad028545.html" target="n" data-glyph="72,1" class="i method">SetTrimming</a>(<span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#1de422b79a5c8b5c" class="t t">TextTrimming</a> <span id="r34 rd" class="r34 r">textTrimming</span>)
		{
			<b>if</b> (<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#1b56df4edaf25013" class="i field">textTrimming</a> != <span class="r34 r">textTrimming</span>)
			{
				<a href="#893d65fbb95e745f" class="k">this</a>.<a href="#1b56df4edaf25013" class="i field">textTrimming</a> = <span class="r34 r">textTrimming</span>;
				<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> != <b>null</b>)
					<a href="#52bd5931384df37b" class="i method">ApplyTrimming</a>();
			}
		}

		<b>void</b> <a id="52bd5931384df37b" href="../R/52bd5931384df37b.html" target="n" data-glyph="76,1" class="i method">ApplyTrimming</a> ()
		{
			<b>switch</b> (<a href="#1b56df4edaf25013" class="i field">textTrimming</a>)
			{
				<b>case</b> <span class="i n">Xwt</span>.<span class="i n">Drawing</span>.<a href="/Xwt3/A.html#1de422b79a5c8b5c" class="t t">TextTrimming</a>.<a href="/Xwt3/A.html#dcd070d77f87d7a7" class="i field">WordElipsis</a>:
					<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#2d20742972e69d73" class="i property">Trimming</a> = <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationCore/A.html#98947646308d12be" class="t t">TextTrimming</a>.<a href="@0@PresentationCore/A.html#79237aeaaed228cd" class="i field">WordEllipsis</a>;
					<b>break</b>;
				<b>default</b>:
					<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#2d20742972e69d73" class="i property">Trimming</a> = <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationCore/A.html#98947646308d12be" class="t t">TextTrimming</a>.<a href="@0@PresentationCore/A.html#3fef0c84ff6c8cff" class="i field">None</a>;
					<b>break</b>;
			}
		}

		<b>public void</b> <a id="42b674198aadd861" href="../R/42b674198aadd861.html" target="n" data-glyph="72,1" class="i method">SetDefaultForeground</a>(<a href="@0@PresentationCore/A.html#2bdb4a721050df52" class="t t">SolidColorBrush</a> <span id="r35 rd" class="r35 r">fg</span>)
		{
			<b>if</b> (<span class="r35 r">fg</span>.<a href="@0@PresentationCore/A.html#eed7cf36d73cf29b" class="i property">Color</a> != <a href="#cd6578b815e114c7" class="i field">brush</a>.<a href="@0@PresentationCore/A.html#eed7cf36d73cf29b" class="i property">Color</a>) {
				<a href="#cd6578b815e114c7" class="i field">brush</a> = <span class="r35 r">fg</span>;
				<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>true</b>;
			}
		}

		<b>public void</b> <a id="4de82fa5560a9eba" href="../R/4de82fa5560a9eba.html" target="n" data-glyph="72,1" class="i method">AddAttribute</a>(<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a> <span id="r36 rd" class="r36 r">attribute</span>)
		{
			<b>if</b> (<a href="#b719c8c685deb6cb" class="i field">attributes</a> == <b>null</b>)
				<a href="#b719c8c685deb6cb" class="i field">attributes</a> = <b>new</b> <a href="@0@mscorlib/A.html#9e5352b2b304ceba" class="t constructor">List</a>&lt;<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a>&gt;();
			<a href="#b719c8c685deb6cb" class="i field">attributes</a>.<a href="@0@mscorlib/A.html#9cc11588bffd57c1" class="i method">Add</a>(<span class="r36 r">attribute</span>);
			<b>if</b> (<a href="#d327f192ba1dd79b" class="i field">formattedText</a> != <b>null</b>)
				<a href="#84459a53c9cae53d" class="i method">ApplyAttribute</a>(<span class="r36 r">attribute</span>);
		}

		<b>public void</b> <a id="dc67190529a2140b" href="../R/dc67190529a2140b.html" target="n" data-glyph="72,1" class="i method">ClearAttributes</a> ()
		{
			<a href="#b719c8c685deb6cb" class="i field">attributes</a> = <b>null</b>;
			<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>true</b>;
		}

		<b>void</b> <a id="84459a53c9cae53d" href="../R/84459a53c9cae53d.html" target="n" data-glyph="76,1" class="i method">ApplyAttribute</a>(<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="t t">TextAttribute</a> <span id="r37 rd" class="r37 r">attribute</span>)
		{
			<b>if</b> (<span class="r37 r">attribute</span> <b>is</b> <a href="/Xwt3/A.html#b5e090085414eb0e" class="t t">FontStyleTextAttribute</a>)
			{
				<a href="/Xwt3/A.html#b5e090085414eb0e" class="k">var</a> <span id="r38 rd" class="r38 r">xa</span> = (<a href="/Xwt3/A.html#b5e090085414eb0e" class="t t">FontStyleTextAttribute</a>)<span class="r37 r">attribute</span>;
				<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#f1a7b4ab96905e72" class="i method">SetFontStyle</a>(<span class="r38 r">xa</span>.<a href="/Xwt3/A.html#54df54db9a9eef3b" class="i property">Style</a>.<a href="DataConverter.cs.html#2c18bfc19579fb4c" class="i method">ToWpfFontStyle</a>(), <span class="r38 r">xa</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>, <span class="r38 r">xa</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>);
			}
			<b>else if</b> (<span class="r37 r">attribute</span> <b>is</b> <a href="/Xwt3/A.html#d05639d763175e99" class="t t">FontWeightTextAttribute</a>)
			{
				<a href="/Xwt3/A.html#d05639d763175e99" class="k">var</a> <span id="r39 rd" class="r39 r">xa</span> = (<a href="/Xwt3/A.html#d05639d763175e99" class="t t">FontWeightTextAttribute</a>)<span class="r37 r">attribute</span>;
				<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#49139e10a0bb7b4b" class="i method">SetFontWeight</a>(<span class="r39 r">xa</span>.<a href="/Xwt3/A.html#093b4e3aa730a875" class="i property">Weight</a>.<a href="DataConverter.cs.html#e6cf3acebf10da8e" class="i method">ToWpfFontWeight</a>(), <span class="r39 r">xa</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>, <span class="r39 r">xa</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>);
			}
			<b>else if</b> (<span class="r37 r">attribute</span> <b>is</b> <a href="/Xwt3/A.html#0af3f26d74571603" class="t t">ColorTextAttribute</a>)
			{
				<a href="/Xwt3/A.html#0af3f26d74571603" class="k">var</a> <span id="r40 rd" class="r40 r">xa</span> = (<a href="/Xwt3/A.html#0af3f26d74571603" class="t t">ColorTextAttribute</a>)<span class="r37 r">attribute</span>;
				<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#1739d828319e9618" class="i method">SetForegroundBrush</a>(<b>new</b> <a href="@0@PresentationCore/A.html#28be7a261187a210" class="t constructor">SolidColorBrush</a>(<span class="r40 r">xa</span>.<a href="/Xwt3/A.html#6de7d18bb065e476" class="i property">Color</a>.<a href="DataConverter.cs.html#fa6d926c9d2ffd8d" class="i method">ToWpfColor</a>()), <span class="r40 r">xa</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>, <span class="r40 r">xa</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>);
			}
			<b>else if</b> (<span class="r37 r">attribute</span> <b>is</b> <a href="/Xwt3/A.html#c8f7050c170d49f8" class="t t">StrikethroughTextAttribute</a>)
			{
				<a href="/Xwt3/A.html#c8f7050c170d49f8" class="k">var</a> <span id="r41 rd" class="r41 r">xa</span> = (<a href="/Xwt3/A.html#c8f7050c170d49f8" class="t t">StrikethroughTextAttribute</a>)<span class="r37 r">attribute</span>;
				<a href="@0@PresentationCore/A.html#8d5115110ba6bf74" class="k">var</a> <span id="r42 rd" class="r42 r">dec</span> = <b>new</b> <a href="@0@PresentationCore/A.html#0d26d1e9fb65a657" class="t constructor">TextDecoration</a>(<a href="@0@PresentationCore/A.html#cf6362fe98bf924c" class="t t">TextDecorationLocation</a>.<a href="@0@PresentationCore/A.html#7216541c860b6e40" class="i field">Strikethrough</a>, <b>null</b>, 0, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>);
				<a href="@0@PresentationCore/A.html#184051c7b5ab19a7" class="t t">TextDecorationCollection</a> <span id="r43 rd" class="r43 r">col</span> = <b>new</b> <a href="@0@PresentationCore/A.html#fdcd362e00790e8b" class="t constructor">TextDecorationCollection</a>();
				<span class="r43 r">col</span>.<a href="@0@PresentationCore/A.html#97ae40bf4ba0d9c2" class="i method">Add</a>(<span class="r42 r">dec</span>);
				<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#0e7719f6f99d9ebd" class="i method">SetTextDecorations</a>(<span class="r43 r">col</span>, <span class="r41 r">xa</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>, <span class="r41 r">xa</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>);
			}
			<b>else if</b> (<span class="r37 r">attribute</span> <b>is</b> <a href="/Xwt3/A.html#f1fa92f7ead1f667" class="t t">UnderlineTextAttribute</a>)
			{
				<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="k">var</a> <span id="r44 rd" class="r44 r">xa</span> = (<a href="/Xwt3/A.html#f1fa92f7ead1f667" class="t t">UnderlineTextAttribute</a>)<span class="r37 r">attribute</span>;
				<a href="@0@PresentationCore/A.html#8d5115110ba6bf74" class="k">var</a> <span id="r45 rd" class="r45 r">dec</span> = <b>new</b> <a href="@0@PresentationCore/A.html#0d26d1e9fb65a657" class="t constructor">TextDecoration</a>(<a href="@0@PresentationCore/A.html#cf6362fe98bf924c" class="t t">TextDecorationLocation</a>.<a href="@0@PresentationCore/A.html#951885da76e07e5b" class="i field">Underline</a>, <b>null</b>, 0, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>, <a href="@0@PresentationCore/A.html#2f687e45f685c419" class="t t">TextDecorationUnit</a>.<a href="@0@PresentationCore/A.html#27384f57d1ab253a" class="i field">FontRecommended</a>);
				<a href="@0@PresentationCore/A.html#184051c7b5ab19a7" class="t t">TextDecorationCollection</a> <span id="r46 rd" class="r46 r">col</span> = <b>new</b> <a href="@0@PresentationCore/A.html#fdcd362e00790e8b" class="t constructor">TextDecorationCollection</a>();
				<span class="r46 r">col</span>.<a href="@0@PresentationCore/A.html#97ae40bf4ba0d9c2" class="i method">Add</a>(<span class="r45 r">dec</span>);
				<a href="#754c051e9091a460" class="i property">FormattedText</a>.<a href="@0@PresentationCore/A.html#0e7719f6f99d9ebd" class="i method">SetTextDecorations</a>(<span class="r46 r">col</span>, <span class="r44 r">xa</span>.<a href="/Xwt3/A.html#a8437c555fb1365b" class="i property">StartIndex</a>, <span class="r44 r">xa</span>.<a href="/Xwt3/A.html#7250dc41cc4a5a42" class="i property">Count</a>);
			}
		}

		<b>public void</b> <a id="e91aad4a03858b54" href="../R/e91aad4a03858b54.html" target="n" data-glyph="72,1" class="i method">Rebuild</a> ()
		{
			<a href="#5787c509c5186881" class="i field">needsRebuild</a> = <b>false</b>;
			<a href="@0@PresentationCore/A.html#3f1d3dfbcfcc8977" class="k">var</a> <span id="r47 rd" class="r47 r">dir</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationCore/A.html#3f1d3dfbcfcc8977" class="t t">FlowDirection</a>.<a href="@0@PresentationCore/A.html#47c46056d47e6cd5" class="i field">LeftToRight</a>;
			<a href="#d327f192ba1dd79b" class="i field">formattedText</a> = <b>new</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Media</span>.<a href="@0@PresentationCore/A.html#48aeb46bad901d4c" class="t constructor">FormattedText</a>(<a href="#29058ab6f452f58a" class="i field">text</a>, <span class="i n">System</span>.<span class="i n">Globalization</span>.<a href="@0@mscorlib/A.html#e319c6636909012f" class="t t">CultureInfo</a>.<a href="@0@mscorlib/A.html#1f5907384ac6bb55" class="i property">CurrentCulture</a>, <span class="r47 r">dir</span>, <a href="#eede570804907170" class="i field">defaultFont</a>, 36, <a href="#cd6578b815e114c7" class="i field">brush</a>);
			<b>if</b> (<a href="#7c237a6f0f83abbc" class="i field">width</a> &gt; 0)
				<a href="#d327f192ba1dd79b" class="i field">formattedText</a>.<a href="@0@PresentationCore/A.html#6d93de2aaad75f34" class="i property">MaxTextWidth</a> = <a href="#7c237a6f0f83abbc" class="i field">width</a>;
			<b>if</b> (<a href="#5218d6eb44ea099b" class="i field">height</a> &gt; 0)
				<a href="#d327f192ba1dd79b" class="i field">formattedText</a>.<a href="@0@PresentationCore/A.html#77f5823c5909754c" class="i property">MaxTextHeight</a> = <a href="#5218d6eb44ea099b" class="i field">height</a>;
			<b>if</b> (<a href="#3cd3c1fb1f38cdf9" class="i property">Font</a> != <b>null</b>)
				<a href="#a8be59b123c4a8fd" class="i method">ApplyFont</a>();
			<b>if</b> (<a href="#1b56df4edaf25013" class="i field">textTrimming</a> != <b>null</b>)
				<a href="#52bd5931384df37b" class="i method">ApplyTrimming</a>();

			<b>if</b> (<a href="#b719c8c685deb6cb" class="i field">attributes</a> != <b>null</b>)
				<b>foreach</b> (<a href="/Xwt3/A.html#c4e78f7f7fb46dc6" class="k">var</a> <span id="r48 rd" class="r48 r">at</span> <b>in</b> <a href="#b719c8c685deb6cb" class="i field">attributes</a>)
					<a href="#84459a53c9cae53d" class="i method">ApplyAttribute</a>(<span class="r48 r">at</span>);
		}

		<span class="c">// public DrawingContext Context;</span>
		<b>public</b> <a href="/Xwt3/A.html#66915aad26bd67c5" class="t t">Font</a> <a id="3cd3c1fb1f38cdf9" href="../R/3cd3c1fb1f38cdf9.html" target="n" data-glyph="102,1" class="i property">Font</a> { <b>get</b>; <b>private set</b>; }
	}
}
</pre></td></tr></table></div></body></html>
