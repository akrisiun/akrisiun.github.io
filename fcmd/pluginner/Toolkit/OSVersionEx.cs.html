<!DOCTYPE html>
<html><head><title>OSVersionEx.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(166);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#pluginner/Toolkit/OSVersionEx.cs" target="_top">Toolkit\OSVersionEx.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#pluginner" target="_top">fcmd\pluginner\pluginner.csproj</a> (pluginner)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<span class="c">/* The File Commander
 * OSVersionEx, decorator for Environment.OSVersion
 * (C) The File Commander Team - https://github.com/atauenis/fcmd
 * (C) 2014, Evgeny Akhtimirov (wilbit@me.com)
 * Contributors should place own signs here.
 */</span>
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">ComponentModel</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Diagnostics</span>;
<b>using</b> <span class="i n">Xwt</span>;

<b>namespace</b> <span class="i n">pluginner</span>.<span class="i n">Toolkit</span>
{
 
    <b>public enum</b> <a id="349739bdacf9aac8" href="../R/../../0000000000.html" target="n" data-glyph="18,0" class="t t"><span id="e980e6b250d5e793">OS</span></a>
    {
        <a id="69c52ea3f714eb67" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Windows</a>,
        <a id="33c9e44d26037012" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Linux</a>,
        <a id="c816263d10d17580" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Mac</a>,
        <a id="a63ad5ae6ccae528" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">Android</a>,
        <a id="07e720e82694616e" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">IOS</a>,
    }
 
    <b>public enum</b> <a id="c95cd31dcff56a05" href="../R/../../0000000000.html" target="n" data-glyph="18,0" class="t t"><span id="2801fe607284a0db">Architecture</span></a>
    {
        <a id="11fdaf3ec01e2eeb" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">x64</a>,
        <a id="4cc5d301ff4206bd" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">x86</a>,
        <a id="86965f30ece8554d" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">arm</a>,
        <a id="e68cb5643dd0f610" href="../R/../../0000000000.html" target="n" data-glyph="24,1" class="i field">mips</a>,
    }
 
    <span class="c">// ReSharper disable once InconsistentNaming</span>
    <b>public static class</b> <a id="9fe6b539828fce94" href="../R/9fe6b539828fce94.html" target="n" data-glyph="0,0" class="t t">OSVersionEx</a>
    {
        <b>public static</b> <a href="/Xwt3/A.html#152e9a705b3e61d0" class="t t">ToolkitType</a> <a id="9a069536880247eb" href="../R/9a069536880247eb.html" target="n" data-glyph="72,1" class="i method">GetToolkitType</a>()
        {
            <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="k">var</a> <span id="r0 rd" class="r0 r">platform</span> = <a href="#ec6f3b2584ceac8c" class="i property">Platform</a>;
            <b>switch</b> (<span class="r0 r">platform</span>)
            {
                <b>case</b> <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#953dcb25cf190546" class="i field">Win32NT</a>:
                    <b>return</b> <a href="/Xwt3/A.html#152e9a705b3e61d0" class="t t">ToolkitType</a>.<a href="/Xwt3/A.html#dd7b2976aa7b82e8" class="i field">Wpf</a>;
                <b>case</b> <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#6d482632710a81f5" class="i field">Unix</a>:
                    <b>return</b> <a href="/Xwt3/A.html#152e9a705b3e61d0" class="t t">ToolkitType</a>.<a href="/Xwt3/A.html#1f546c7862449520" class="i field">Gtk3</a>;
                <b>case</b> <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#e8b92790a2a353a3" class="i field">MacOSX</a>:
                    <b>return</b> <a href="/Xwt3/A.html#152e9a705b3e61d0" class="t t">ToolkitType</a>.<a href="/Xwt3/A.html#98486b3fe74a9151" class="i field">Cocoa</a>;
                <b>default</b>:
                    <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#3d3c2c03118be4f8" class="t constructor">NotSupportedException</a>(
                        <b>string</b>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<span class="s">&quot;Not supported value {0} for {1} type&quot;</span>, <span class="r0 r">platform</span>.<a href="@0@mscorlib/A.html#1365cfeffd45409d" class="i method">ToString</a>(), <b>typeof</b>(<a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>)));
            }
        }
 
        <b>public static bool</b> <a id="763843fc2bbfd024" href="../R/763843fc2bbfd024.html" target="n" data-glyph="102,1" class="i property">IsWindows</a>
        {
            <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#f23195260b6f56fc" class="i property">Platform</a> != <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#6d482632710a81f5" class="i field">Unix</a> &amp;&amp; <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#f23195260b6f56fc" class="i property">Platform</a> != <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#e8b92790a2a353a3" class="i field">MacOSX</a>; }
        }
 
        <b>public static bool</b> <a id="e83d32b683bee8d6" href="../R/e83d32b683bee8d6.html" target="n" data-glyph="102,1" class="i property">IsPosix</a> { <b>get</b> { <b>return</b> !<a href="#763843fc2bbfd024" class="i property">IsWindows</a>; } }
        <span class="c">// public static OS OS;</span>
 
        <span class="c">//public static void HideConsole()</span>
        <span class="c">//{</span>
        <span class="c">//    IntPtr hwnd = InternalWindows.GetConsoleWindow();</span>
        <span class="c">//    InternalWindows.ShowWindow(hwnd, SW_HIDE);</span>
        <span class="c">//}</span>
 
        <span class="c">//[DllImport(&quot;libc&quot;)]</span>
        <span class="c">//static extern int uname(IntPtr buf);</span>
 
        <b>public static bool</b> <a id="fa27dacd84250c06" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">IsMono</a> { <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#3d00eeab9feb80f3" class="t t">Type</a>.<a href="@0@mscorlib/A.html#ba8d29b0ddf9aaa0" class="i method">GetType</a>(<span class="s">&quot;Mono.Runtime&quot;</span>) != <b>null</b>; } }
 
        <b>public static bool</b> <a id="8cd3cae68a6470d8" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Is64Bit</a> { <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#f9f129f1a481b033" class="i property">Is64BitProcess</a>; } }
        <b>public static bool</b> <a id="48757ec4880c5a7b" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Is32Bit</a> { <b>get</b> { <b>return</b> !<a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#f9f129f1a481b033" class="i property">Is64BitProcess</a>; } }
 
 
        <b>public static bool</b> <a id="d38e64e9df4ef585" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PlatformX86</a> { <b>get</b> { <b>return</b> <a href="#9c8b515b7f1b7e4e" class="i property">Architecture</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;AMD&quot;</span>) || <a href="#9c8b515b7f1b7e4e" class="i property">Architecture</a>.<a href="@0@mscorlib/A.html#428c5c9954dea844" class="i method">Contains</a>(<span class="s">&quot;X86&quot;</span>); } }
        <b>public static bool</b> <a id="f23acc902a833cbb" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">PlatformARM</a> { <b>get</b> { <b>return false</b>; } }    <span class="c">// TODO</span>
        <b>public static string</b> <a id="9c8b515b7f1b7e4e" href="../R/9c8b515b7f1b7e4e.html" target="n" data-glyph="102,1" class="i property">Architecture</a>
        {
            <b>get</b>
            {
                <b>string</b> <span id="r1 rd" class="r1 r">_Architecture</span> = <b>string</b>.<a href="@0@mscorlib/A.html#c9f70a27facb27cf" class="i field">Empty</a>;
                <b>if</b> (!<a href="#e83d32b683bee8d6" class="i property">IsPosix</a>)
                    <span class="r1 r">_Architecture</span> = <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#3956c71d4fc09576" class="i method">GetEnvironmentVariable</a>(<span class="s">&quot;PROCESSOR_ARCHITECTURE&quot;</span>);
 
                <span class="c">// else</span>
                <span class="c">// {</span>
                <span class="c">//		try</span>
                <span class="c">//		{</span>
                <span class="c">//			var Result = ProcessUtils.ExecuteCommand(&quot;uname&quot;, &quot;-m&quot;);</span>
                <span class="c">//                _Architecture = Result.OutputString;</span>
                <b>return</b> <span class="r1 r">_Architecture</span>;
            }
        }
 
        <b>public static bool</b> <a id="6b5c7c57a6d1f188" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Is64BitProcess</a>
        {
            <b>get</b>
            {
                <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#f9f129f1a481b033" class="i property">Is64BitProcess</a>;
            }
        }
 
        <b>public static</b> <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a> <a id="ec6f3b2584ceac8c" href="../R/ec6f3b2584ceac8c.html" target="n" data-glyph="102,1" class="i property">Platform</a>
        {
            <b>get</b>
            {
                <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="k">var</a> <span id="r2 rd" class="r2 r">platformId</span> = <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#f23195260b6f56fc" class="i property">Platform</a>;
                <b>if</b> (<span class="r2 r">platformId</span> != <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#6d482632710a81f5" class="i field">Unix</a>)
                {
                    <b>return</b> <span class="r2 r">platformId</span>;
                }
 
                <a href="@0@mscorlib/A.html#f1b135ff6c380b37" class="k">var</a> <span id="r3 rd" class="r3 r">platformHasDarwinKernel</span> = <a href="#7544a441c42eef3a" class="i method">GetPlatformHasDarwinKernel</a>();
                <b>return</b> <span class="r3 r">platformHasDarwinKernel</span>
                    ? <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#e8b92790a2a353a3" class="i field">MacOSX</a>
                    : <a href="@0@mscorlib/A.html#065a6a7be5e74336" class="t t">PlatformID</a>.<a href="@0@mscorlib/A.html#6d482632710a81f5" class="i field">Unix</a>;
            }
        }
 
        <b>public static string</b> <a id="6f75f4f4d50e0b1d" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">ServicePack</a>
        {
            <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#485bad6a756afb61" class="i property">ServicePack</a>; }
        }
 
        <b>public static</b> <a href="@0@mscorlib/A.html#0c15515dfe051d35" class="t t">Version</a> <a id="7322ee2471e40629" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">Version</a>
        {
            <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#7ed000628190bd24" class="i property">Version</a>; }
        }
 
        <b>public static string</b> <a id="33d5e3a5d766f2fd" href="../R/../../0000000000.html" target="n" data-glyph="102,1" class="i property">VersionString</a>
        {
            <b>get</b> { <b>return</b> <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#67900ccbbcff63a2" class="i property">OSVersion</a>.<a href="@0@mscorlib/A.html#ad3e88bdec1d69f0" class="i property">VersionString</a>; }
        }
 
        <b>private static bool</b> <a id="7544a441c42eef3a" href="../R/7544a441c42eef3a.html" target="n" data-glyph="76,1" class="i method">GetPlatformHasDarwinKernel</a>()
        {
            <b>if</b> (<a href="#21c7409034fe787a" class="i field">_platformHasDarwinKernel</a> != <b>null</b>)
            {
                <b>return</b> <a href="#21c7409034fe787a" class="i field">_platformHasDarwinKernel</a>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>;
            }
 
            <a href="@0@System/A.html#f8b2e604d6f1fe04" class="k">var</a> <span id="r4 rd" class="r4 r">process</span> = <b>new</b> <a href="@0@System/A.html#47660cba985bdf77" class="t constructor">Process</a> { <a href="@0@System/A.html#b0417e5300dc5565" class="i property">StartInfo</a> = { <a href="@0@System/A.html#b5b64f6ecc2f77fd" class="i property">FileName</a> = <span class="s">&quot;uname&quot;</span>, <a href="@0@System/A.html#0e85c2ea7cbdedbe" class="i property">UseShellExecute</a> = <b>false</b>, <a href="@0@System/A.html#7d08cff61e290062" class="i property">RedirectStandardOutput</a> = <b>true</b> } };
            <b>try</b>
            {
                <span class="r4 r">process</span>.<a href="@0@System/A.html#e9edeff01b1851af" class="i method">Start</a>();
                <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r5 rd" class="r5 r">processOutput</span> = <span class="r4 r">process</span>.<a href="@0@System/A.html#7b00fe2b27d4b60c" class="i property">StandardOutput</a>.<a href="@0@mscorlib/A.html#dc5c2420e739a03e" class="i method">ReadToEnd</a>();
                <a href="#21c7409034fe787a" class="i field">_platformHasDarwinKernel</a> = <span class="r5 r">processOutput</span>.<a href="@0@mscorlib/A.html#1c787ba07a7b11ab" class="i method">StartsWith</a>(<span class="s">&quot;Darwin&quot;</span>, <a href="@0@mscorlib/A.html#702797def97ecb7c" class="t t">StringComparison</a>.<a href="@0@mscorlib/A.html#eabf4db5f5c52b6a" class="i field">InvariantCultureIgnoreCase</a>);
                <span class="r4 r">process</span>.<a href="@0@System/A.html#52f69fa993002b54" class="i method">WaitForExit</a>();
            }
            <b>catch</b> (<a href="@0@System/A.html#824f982cf95a6267" class="t t">Win32Exception</a>)
            {
                <span class="c">//when &quot;uname&quot; not found</span>
                <a href="#21c7409034fe787a" class="i field">_platformHasDarwinKernel</a> = <b>false</b>;
            }
            <b>finally</b>
            {
                <span class="r4 r">process</span>.<a href="@0@System/A.html#ec402748f4bd1220" class="i method">Dispose</a>();
            }
 
            <b>return</b> <a href="#21c7409034fe787a" class="i field">_platformHasDarwinKernel</a>.<a href="@0@mscorlib/A.html#7b38d1fa76071c95" class="i property">Value</a>;
        }
 
        <b>private static bool</b>? <a id="21c7409034fe787a" href="../R/21c7409034fe787a.html" target="n" data-glyph="46,1" class="i field">_platformHasDarwinKernel</a>;
    }
}
</pre></td></tr></table></div></body></html>
