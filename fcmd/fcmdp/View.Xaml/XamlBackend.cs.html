<!DOCTYPE html>
<html><head><title>XamlBackend.cs</title><link rel="stylesheet" href="../../styles.css"><script src="../../scripts.js"></script></head>
<body class="cB" onload="i(463);"><div class="dH">
<table style="width: 100%">
<tr><td>File: <a id="filePath" class="blueLink" href="/#fcmdp/View.Xaml/XamlBackend.cs" target="_top">View.Xaml\XamlBackend.cs</a><br/></td><td></td></tr>
<tr><td>Project: <a id="projectPath" class="blueLink" href="/#fcmdp" target="_top">fcmd\fcmdp.csproj</a> (fcmdp)</td><td></td></tr>
</table>
</div>
<div class="cz"><table class="tb" cellpadding="0" cellspacing="0"><tr><td valign="top" align="right"><pre id="ln"></pre></td><td valign="top" align="left"><pre id="code">
<b>using</b> <span class="i n">fcmd</span>.<span class="i n">FileList</span>;
<b>using</b> <span class="i n">fcmd</span>.<span class="i n">Model</span>;
<b>using</b> <span class="i n">pluginner</span>.<span class="i n">Widgets</span>;
<b>using</b> <span class="i n">System</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Threading</span>.<span class="i n">Tasks</span>;
<b>using</b> <span class="i n">fcmd</span>.<span class="i n">View</span>.<span class="i n">Xaml</span>;
<b>using</b> <span class="i n">System</span>.<span class="i n">Windows</span>;
<b>using</b> <span class="i n">fcmd</span>.<span class="i n">View</span>.<span class="i n">ctrl</span>;
 
<b>namespace</b> <span class="i n">fcmd</span>.<span class="i n">View</span>
{
    <span class="c">// Window extension for XAML Presentation framework</span>
 
    <b>public class</b> <a id="6d16b52b1141d28d" href="../R/6d16b52b1141d28d.html" target="n" data-glyph="0,0" class="t t"><span id="68826fce4904908b">WpfBackend</span></a> : <a href="../Model/IBackend.cs.html#c9eab0464cbf5cac" class="t t">IBackend</a>
    {
        <b>public void</b> <a id="7a8f2330e1afed50" href="../R/7a8f2330e1afed50.html" target="n" data-glyph="72,1" class="i method">Init</a>(<a href="../Platform/ICommanderWindow.cs.html#90bb3422feac91b0" class="t t">ICommanderWindow</a> <span id="r0 rd" class="r0 r">window</span>)
        {
            <a href="#17010ba261d3950e" class="i field">args</a> = <a href="@0@mscorlib/A.html#7d2f1469d916fc63" class="t t">Environment</a>.<a href="@0@mscorlib/A.html#84c2c7cb5c89246f" class="i method">GetCommandLineArgs</a>();
 
            <a href="#c66623554cab66dc" class="i field">main</a> = <span class="r0 r">window</span> <b>as</b> <a href="../P/6628552ccd0b005b.html#6628552ccd0b005b" class="t t">MainWindow</a>;
            <a href="#494710a96fefd08e" class="i method">InitMenu</a>();
        }
 
        <a href="../P/6628552ccd0b005b.html#6628552ccd0b005b" class="t t">MainWindow</a> <a href="../Model/IBackend.cs.html#c9eab0464cbf5cac" class="t t">IBackend</a>.<a href="../Model/IBackend.cs.html#12b89945a4df5361" class="i property">Window</a> { <b>get</b> { <b>return</b> <a href="#c66623554cab66dc" class="i field">main</a>; } }
 
        <b>public void</b> <a id="c918d92e4897c5c4" href="../R/c918d92e4897c5c4.html" target="n" data-glyph="72,1" class="i method">ShowMessage</a>(<b>string</b> <span id="r1 rd" class="r1 r">message</span>, <b>params object</b>[] <span id="r2 rd" class="r2 r">args</span>)
        {
            <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="k">var</a> <span id="r3 rd" class="r3 r">msgText</span> = <a href="@0@mscorlib/A.html#8281103e6f23cb5c" class="t t">String</a>.<a href="@0@mscorlib/A.html#ad9f5b0b214ae8f3" class="i method">Format</a>(<span class="r1 r">message</span>, <span class="r2 r">args</span>);
            <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#3b60c03449450d09" class="i method">Show</a>(<span class="r4 r">owner</span>: <a href="#c66623554cab66dc" class="i field">main</a>, <span class="r5 r">messageBoxText</span>: <span class="r3 r">msgText</span>, <span class="r6 r">caption</span>: (<a href="#c66623554cab66dc" class="i field">main</a> == <b>null</b> ? <b>null</b> : <a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@PresentationFramework/A.html#5002b3a8c196a7d1" class="i property">Title</a>));
        }
        <b>public void</b> <a id="e8e8f0ad9651e558" href="../R/e8e8f0ad9651e558.html" target="n" data-glyph="72,1" class="i method">ShowError</a>(<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r7 rd" class="r7 r">error</span>, <b>string</b> <span id="r8 rd" class="r8 r">message</span> = <b>null</b>, <b>params object</b>[] <span id="r9 rd" class="r9 r">args</span>)
        {
            <b>string</b> <span id="r10 rd" class="r10 r">errorMessage</span> = <span class="r8 r">message</span>;
            <span class="r10 r">errorMessage</span> += <span class="r7 r">error</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>;
 
            <a href="../App.xaml.cs.html#76450589a57e2db8" class="t t">App</a>.<a href="../App.xaml.cs.html#d16324194bcf5e9e" class="i method">ConsoleWriteLine</a>(<span class="r10 r">errorMessage</span>);
 
            <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#4c2afec357f8c450" class="i method">Show</a>(<span class="r11 r">owner</span>: <a href="#c66623554cab66dc" class="i field">main</a>, <span class="r12 r">messageBoxText</span>: <span class="r10 r">errorMessage</span>, <span class="r13 r">caption</span>: <a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@PresentationFramework/A.html#5002b3a8c196a7d1" class="i property">Title</a>, <span class="r14 r">button</span>: <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#57cf33522d50233a" class="t t">MessageBoxButton</a>.<a href="@0@PresentationFramework/A.html#6f4d7963ffc6793b" class="i field">OK</a>);
        }
 
        <b>public bool</b>? <a id="ff8ce5d15eea1d42" href="../R/ff8ce5d15eea1d42.html" target="n" data-glyph="72,1" class="i method">ShowConfirm</a>(<b>string</b> <span id="r15 rd" class="r15 r">message</span>, <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#dc12d357587b6244" class="t t">ConfirmationMessage</a> <span id="r16 rd" class="r16 r">details</span> = <b>null</b>)
        {
            <span class="c">// MessageBoxResult Show(Window owner, string messageBoxText, string caption, MessageBoxButton button, MessageBoxImage icon, MessageBoxResult defaultResult)</span>
            <a href="@0@PresentationFramework/A.html#5227558bcf50a556" class="t t">MessageBoxResult</a> <span id="r17 rd" class="r17 r">result</span> = <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#5f466a86dcc227ac" class="t t">MessageBox</a>.<a href="@0@PresentationFramework/A.html#b6e5ca5788924006" class="i method">Show</a>(<span class="r18 r">owner</span>: <a href="#c66623554cab66dc" class="i field">main</a>, <span class="r19 r">messageBoxText</span>: <span class="r15 r">message</span>, 
                <span class="r20 r">button</span>: <a href="@0@PresentationFramework/A.html#57cf33522d50233a" class="t t">MessageBoxButton</a>.<a href="@0@PresentationFramework/A.html#16e750a307be596c" class="i field">YesNo</a>, <span class="r21 r">defaultResult</span>: <a href="@0@PresentationFramework/A.html#5227558bcf50a556" class="t t">MessageBoxResult</a>.<a href="@0@PresentationFramework/A.html#031af1bf56a26a80" class="i field">Yes</a>, 
                <span class="r22 r">icon</span>: <a href="@0@PresentationFramework/A.html#26947fb9108271b2" class="t t">MessageBoxImage</a>.<a href="@0@PresentationFramework/A.html#1eda614fad39afa1" class="i field">Asterisk</a>, <span class="r23 r">caption</span>: <b>null</b>);
 
            <b>return</b> <span class="r17 r">result</span> == <a href="@0@PresentationFramework/A.html#5227558bcf50a556" class="t t">MessageBoxResult</a>.<a href="@0@PresentationFramework/A.html#264d5885b8168e79" class="i field">None</a> ? <b>null</b> : (<b>bool</b>?)(<span class="r17 r">result</span> == <a href="@0@PresentationFramework/A.html#5227558bcf50a556" class="t t">MessageBoxResult</a>.<a href="@0@PresentationFramework/A.html#031af1bf56a26a80" class="i field">Yes</a>);
        }
 
        <b>protected</b> <a href="../P/6628552ccd0b005b.html#6628552ccd0b005b" class="t t">MainWindow</a> <a id="c66623554cab66dc" href="../R/c66623554cab66dc.html" target="n" data-glyph="45,1" class="i field">main</a>;
        <b>protected</b> <a href="WindowData.cs.html#3d79153f00b768f8" class="t t">WindowDataWpf</a> <a id="a2fc0fa83de6762d" href="../R/a2fc0fa83de6762d.html" target="n" data-glyph="45,1" class="i field">data</a>;
        <b>public string</b>[] <a id="17010ba261d3950e" href="../R/17010ba261d3950e.html" target="n" data-glyph="42,1" class="i field">args</a>;
 
        <b>public void</b> <a id="f70cb65a1e37d16f" href="../R/f70cb65a1e37d16f.html" target="n" data-glyph="72,1" class="i method">Shown</a>() { }
 
        <b>public void</b> <a id="d2f4cc55a36e8416" href="../R/d2f4cc55a36e8416.html" target="n" data-glyph="72,1" class="i method">Clear</a>()
        {
            <b>var</b> <span id="r24 rd" class="r24 r">panel1</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<span class="i">LeftPanel</span>;
            <b>var</b> <span id="r25 rd" class="r25 r">panel2</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<span class="i">RightPanel</span>;
 
            <b>if</b> (<span class="r24 r">panel1</span>.<span class="i">data</span> == <b>null</b>)
                <b>return</b>;
            <span class="r24 r">panel1</span>.<span class="i">data</span>.<span class="i">Columns</span>.<span class="i">Clear</span>();
            <b>if</b> (<span class="r25 r">panel2</span>.<span class="i">data</span> != <b>null</b>)
                <span class="r25 r">panel2</span>.<span class="i">data</span>.<span class="i">Columns</span>.<span class="i">Clear</span>();
        }
 
        <b>public</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="2bbe2a6ef58b6c43" href="../R/2bbe2a6ef58b6c43.html" target="n" data-glyph="102,1" class="i property">LoaderTask</a> { <b>get</b>; <b>set</b>; }
 
        <b>public</b> <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a> <a id="d63815281174909e" href="../R/d63815281174909e.html" target="n" data-glyph="72,1" class="i method">LoadTask</a>(<a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r26 rd" class="r26 r">panel1</span>, <a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r27 rd" class="r27 r">panel2</span>)
        {
            <a href="#a2fc0fa83de6762d" class="i field">data</a> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#2e0a0787ae7ddcfb" class="i property">WindowDataWpf</a> <b>as</b> <a href="WindowData.cs.html#3d79153f00b768f8" class="t t">WindowDataWpf</a>;
            <a href="#d2f4cc55a36e8416" class="i method">Clear</a>();
 
            <a href="@0@mscorlib/A.html#b76a4a6f77962f28" class="t t">TaskScheduler</a> <span id="r28 rd" class="r28 r">scheduler</span> = <a href="@0@mscorlib/A.html#b76a4a6f77962f28" class="t t">TaskScheduler</a>.<a href="@0@mscorlib/A.html#a8790c1e6086ae5d" class="i method">FromCurrentSynchronizationContext</a>();
            <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="k">var</a> <span id="r29 rd" class="r29 r">task</span> = <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="t t">Task</a>.<a href="@0@mscorlib/A.html#bd44cb0241ef993a" class="i property">Factory</a>.<a href="@0@mscorlib/A.html#fb6e45941d931629" class="i method">StartNew</a>(
                () =&gt; <a href="#33666b82a3293341" class="i method">LoadDirAsync</a>(<span class="r28 r">scheduler</span>)
                );
 
            <a href="#2bbe2a6ef58b6c43" class="i property">LoaderTask</a> = <span class="r29 r">task</span>;
            <b>return</b> <span class="r29 r">task</span>;
        }
 
        <b>public void</b> <a id="d9095f1dcde67423" href="../R/d9095f1dcde67423.html" target="n" data-glyph="72,1" class="i method">Shown</a>(<a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r30 rd" class="r30 r">panel1</span>, <a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r31 rd" class="r31 r">panel2</span>)
        {
            <a href="@0@mscorlib/A.html#045a746eb48cbaa9" class="k">var</a> <span id="r32 rd" class="r32 r">task</span> = <a href="#2bbe2a6ef58b6c43" class="i property">LoaderTask</a>;
            <b>if</b> (<span class="r32 r">task</span> != <b>null</b> &amp;&amp; <span class="r32 r">task</span>.<a href="@0@mscorlib/A.html#771e3c39534a4177" class="i property">Status</a> == <a href="@0@mscorlib/A.html#79588e534a82b826" class="t t">TaskStatus</a>.<a href="@0@mscorlib/A.html#ea8f36ec6033be13" class="i field">Running</a>)
                <span class="r32 r">task</span>.<a href="@0@mscorlib/A.html#e71924f994d1bb54" class="i method">ContinueWith</a>(
                    (<span id="r33 rd" class="r33 r">t</span>) =&gt; <a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@WindowsBase/A.html#bd03df1631104fbc" class="i property">Dispatcher</a>.<a href="@0@WindowsBase/A.html#73e16fb1fb6d2b98" class="i method">Invoke</a>(
                        () =&gt; <a href="#be98e22d5d21972c" class="i method">AfterLoadDir</a>(<span class="r30 r">panel1</span>, <span class="r31 r">panel2</span>))
                    );
            <b>else if</b> (!<a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@WindowsBase/A.html#757fc2dc09790852" class="i method">CheckAccess</a>())
                <a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@WindowsBase/A.html#bd03df1631104fbc" class="i property">Dispatcher</a>.<a href="@0@WindowsBase/A.html#73e16fb1fb6d2b98" class="i method">Invoke</a>(
                    () =&gt; <a href="#be98e22d5d21972c" class="i method">AfterLoadDir</a>(<span class="r30 r">panel1</span>, <span class="r31 r">panel2</span>));
            <b>else</b>
                <a href="#be98e22d5d21972c" class="i method">AfterLoadDir</a>(<span class="r30 r">panel1</span>, <span class="r31 r">panel2</span>);
        }
 
        <b>public void</b> <a id="33666b82a3293341" href="../R/33666b82a3293341.html" target="n" data-glyph="72,1" class="i method">LoadDirAsync</a>(<a href="@0@mscorlib/A.html#b76a4a6f77962f28" class="t t">TaskScheduler</a> <span id="r34 rd" class="r34 r">scheduler</span>)
        {
            <a href="../App.xaml.cs.html#76450589a57e2db8" class="t t">App</a>.<a href="../App.xaml.cs.html#d16324194bcf5e9e" class="i method">ConsoleWriteLine</a>(<span class="s">&quot;DEBUG LoadDirAsync&quot;</span>);
 
            <a href="WindowData.cs.html#3d79153f00b768f8" class="k">var</a> <span id="r35 rd" class="r35 r">data</span> = <a href="#6d16b52b1141d28d" class="k">this</a>.<a href="#a2fc0fa83de6762d" class="i field">data</a>;
            <span class="r35 r">data</span>.<a href="WindowData.cs.html#17c9771a7c47fb67" class="i method">LoadDirAsync</a>(<a href="#17010ba261d3950e" class="i field">args</a>, <span class="r34 r">scheduler</span>);
        }
 
        <b>public void</b> <a id="0d0544a17f024be5" href="../R/0d0544a17f024be5.html" target="n" data-glyph="72,1" class="i method">LoadDirSynchonous</a>()
        {
            <a href="#a2fc0fa83de6762d" class="i field">data</a> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#481d8c73f6b6f1a7" class="i property">WindowData</a> <b>as</b> <a href="WindowData.cs.html#3d79153f00b768f8" class="t t">WindowDataWpf</a>;
            <a href="@0@mscorlib/A.html#b76a4a6f77962f28" class="k">var</a> <span id="r36 rd" class="r36 r">scheduler</span> = <a href="@0@mscorlib/A.html#b76a4a6f77962f28" class="t t">TaskScheduler</a>.<a href="@0@mscorlib/A.html#3b1deebcaa6a0990" class="i property">Current</a>; <span class="c">//  .FromCurrentSynchronizationContext();</span>
            <a href="#a2fc0fa83de6762d" class="i field">data</a>.<a href="WindowData.cs.html#17c9771a7c47fb67" class="i method">LoadDirAsync</a>(<a href="#17010ba261d3950e" class="i field">args</a>, <span class="r36 r">scheduler</span>);
 
            <b>var</b> <span id="r37 rd" class="r37 r">panel1</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<span class="i">LeftPanel</span>; <b>var</b> <span id="r38 rd" class="r38 r">panel2</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<span class="i">RightPanel</span>;
            <span class="i">AfterLoadDir</span>(<span class="r37 r">panel1</span>, <span class="r38 r">panel2</span>);
        }
 
        <b>void</b> <a id="be98e22d5d21972c" href="../R/be98e22d5d21972c.html" target="n" data-glyph="76,1" class="i method">AfterLoadDir</a>(<a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r39 rd" class="r39 r">panel1</span>, <a href="ListPanel/PanelWpf.xaml.cs.html#d33749159c63c8eb" class="t t">PanelWpf</a> <span id="r40 rd" class="r40 r">panel2</span>)
        {
            <a href="../App.xaml.cs.html#76450589a57e2db8" class="t t">App</a>.<a href="../App.xaml.cs.html#d16324194bcf5e9e" class="i method">ConsoleWriteLine</a>(<span class="s">&quot;DEBUG AfterLoadDir&quot;</span>);
            <a href="#6d16b52b1141d28d" class="k">this</a>.<a href="#2bbe2a6ef58b6c43" class="i property">LoaderTask</a> = <b>null</b>;
 
            <b>if</b> (!<span class="r39 r">panel1</span>.<a href="@0@WindowsBase/A.html#757fc2dc09790852" class="i method">CheckAccess</a>())
                <b>throw</b> <b>new</b> <a href="@0@mscorlib/A.html#4ab2c850ecc189d3" class="t constructor">InvalidProgramException</a>(<span class="s">&quot;LoadDir after error&quot;</span>);
 
            <a href="ListPanel/ListFiltered2Xaml.cs.html#60e2e4ae8a69c247" class="k">var</a> <span id="r41 rd" class="r41 r">view1</span> = <span class="r39 r">panel1</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#42632b73707ed1ac" class="i property">ListingView</a> <b>as</b> <a href="ListPanel/ListFiltered2Xaml.cs.html#60e2e4ae8a69c247" class="t t">ListFiltered2Xaml</a>;
 
            <b>if</b> (!<span class="r41 r">view1</span>.<a href="ListPanel/ListFiltered2Xaml.cs.html#ce7866369ef270ea" class="i property">ColumnsSet</a>)
                <span class="r41 r">view1</span>.<a href="ListPanel/ListFiltered2Xaml.cs.html#aa7137c174b38f42" class="i method">SetupColumns</a>();
            <span class="r41 r">view1</span>.<a href="/pluginner/A.html#90ee58dcee8dbff5" class="i property">SelectedRow</a> = 0;
 
            <a href="/pluginner/A.html#54cdf62f3ae1a20e" class="k">var</a> <span id="r42 rd" class="r42 r">view2</span> = <span class="r40 r">panel2</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#42632b73707ed1ac" class="i property">ListingView</a>;
            <b>if</b> (!<span class="r42 r">view2</span>.<a href="/pluginner/A.html#19c5b93bce92ccd0" class="i property">ColumnsSet</a>)
                <span class="r42 r">view2</span>.<a href="/pluginner/A.html#6a0d89b44881529e" class="i method">SetupColumns</a>();
 
            <span class="r39 r">panel1</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#d3916fafb294e2f1" class="i property">UrlBox</a>.<a href="/pluginner/A.html#8ac253d69b2ae28b" class="i property">Text</a> = <span class="r39 r">panel1</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="../FileList/Panel/FileListPanel.cs.html#6fa526281a55b072" class="i property">FS</a>.<a href="/pluginner/A.html#53050e9ff0b5dd2d" class="i property">CurrentDirectory</a>;
            <span class="r40 r">panel2</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#d3916fafb294e2f1" class="i property">UrlBox</a>.<a href="/pluginner/A.html#8ac253d69b2ae28b" class="i property">Text</a> = <span class="r40 r">panel2</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="../FileList/Panel/FileListPanel.cs.html#6fa526281a55b072" class="i property">FS</a>.<a href="/pluginner/A.html#53050e9ff0b5dd2d" class="i property">CurrentDirectory</a>;
 
            <span class="r40 r">panel2</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#27eec562a538daca" class="i property">WindowData</a> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#481d8c73f6b6f1a7" class="i property">WindowData</a> <b>as</b> <a href="WindowData.cs.html#3d79153f00b768f8" class="t t">WindowDataWpf</a>;
            <span class="r40 r">panel2</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#3fb20815f52cf085" class="i method">Shown</a>();
 
            <span class="r39 r">panel1</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#f31a3e3bfd7fa28e" class="i property">PanelDataWpf</a>.<a href="ListPanel/FileListPanelWpf.cs.html#27eec562a538daca" class="i property">WindowData</a> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#481d8c73f6b6f1a7" class="i property">WindowData</a> <b>as</b> <a href="WindowData.cs.html#3d79153f00b768f8" class="t t">WindowDataWpf</a>;
            <span class="r39 r">panel1</span>.<a href="ListPanel/PanelWpf.xaml.cs.html#3fb20815f52cf085" class="i method">Shown</a>();
            <span class="r41 r">view1</span>.<a href="ListPanel/ListFiltered2Xaml.cs.html#fbedd9a16b18149d" class="i method">SetFocus</a>();
 
            <span class="c">// KeyEventHandler  object sender, KeyEventArgs e);</span>
            <a href="#c66623554cab66dc" class="i field">main</a>.<a href="@0@PresentationCore/A.html#58bfd79a7ef6a62d" class="i">PreviewKeyDown</a>
                += (<span id="r43 rd" class="r43 r">s</span>, <span id="r44 rd" class="r44 r">e</span>) =&gt; <a href="#6d16b52b1141d28d" class="k">this</a>.<a href="#e60c390522693f1d" class="i method">KeyEvent</a>(<span class="r43 r">s</span>, <span class="r44 r">e</span>);
 
            <a href="../P/6628552ccd0b005b.html#6628552ccd0b005b" class="t t">MainWindow</a>.<a href="../MainWindow.xaml.cs.html#288fd9faada6a7a1" class="i property">AppLoading</a> = <b>false</b>;
        }
 
        <b>public void</b> <a id="494710a96fefd08e" href="../R/494710a96fefd08e.html" target="n" data-glyph="72,1" class="i method">InitMenu</a>()
        {
            <span class="c">//    main.KeyBoardHelp.Visible = false;</span>
 
            <span class="c">//    //build user interface</span>
            <span class="c">//    main.MainMenu.Items.Add(main.mnuFile);</span>
            <span class="c">//    main.MainMenu.Items.Add(main.mnuView);</span>
            <span class="c">//    main.MainMenu.Items.Add(main.mnuNavigate);</span>
            <span class="c">//    main.MainMenu.Items.Add(main.mnuTools);</span>
            <span class="c">//    main.MainMenu.Items.Add(main.mnuHelp);</span>
 
            <span class="c">//    var mnuFile = main.mnuFile;</span>
            <span class="c">//    mnuFile.SubMenu = new Xwt.Menu();</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileUserMenu);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileView);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileEdit);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileCompare);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileCopy);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileMove);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileNewDir);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileRemove);</span>
 
            <span class="c">//    mnuFile.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileAtributes);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileQuickSelect);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileQuickUnselect);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileSelectAll);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileUnselect);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileInvertSelection);</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuFile.SubMenu.Items.Add(main.mnuFileExit);</span>
 
            <span class="c">//    var mnuView = main.mnuView;</span>
            <span class="c">//    mnuView.SubMenu = new Xwt.Menu();</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewShort);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewDetails);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewIcons);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewThumbs);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewQuickView);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewTree);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewPCPCconnect);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewPCNETPCconnect);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewByName);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewByType);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewByDate);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewBySize);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewNoFilter);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewWithFilter);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewKeybrdHelp); //these checkboxes don&#39;t work, because no code was written</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewInfobar);</span>
            <span class="c">//    mnuView.SubMenu.Items.Add(main.mnuViewDiskButtons);</span>
 
            <span class="c">//    var mnuNavigate = main.mnuNavigate;</span>
            <span class="c">//    mnuNavigate.SubMenu = new Xwt.Menu();</span>
            <span class="c">//    mnuNavigate.SubMenu.Items.Add(main.mnuNavigateTree);</span>
            <span class="c">//    mnuNavigate.SubMenu.Items.Add(main.mnuNavigateHistory);</span>
            <span class="c">//    mnuNavigate.SubMenu.Items.Add(main.mnuNavigateFind);</span>
            <span class="c">//    mnuNavigate.SubMenu.Items.Add(main.mnuNavigateReload);</span>
 
            <span class="c">//    var mnuTools = main.mnuTools;</span>
            <span class="c">//    mnuTools.SubMenu = new Xwt.Menu();</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsOptions);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsPluginManager);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsEditUserMenu);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsKeychains);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsConfigEdit);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(new Xwt.SeparatorMenuItem());</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsDiskLabel);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsFormat);</span>
            <span class="c">//    mnuTools.SubMenu.Items.Add(main.mnuToolsSysInfo);</span>
 
            <span class="c">//    var mnuHelp = main.mnuHelp;</span>
            <span class="c">//    mnuHelp.SubMenu = new Xwt.Menu();</span>
            <span class="c">//    mnuHelp.SubMenu.Items.Add(main.mnuHelpHelpMe);</span>
            <span class="c">//    mnuHelp.SubMenu.Items.Add(main.mnuHelpDebug);</span>
            <span class="c">//    mnuHelp.SubMenu.Items.Add(main.mnuHelpAbout);</span>
 
        }
 
        <b>public void</b> <a id="fd1a0ea086e89b20" href="../R/fd1a0ea086e89b20.html" target="n" data-glyph="72,1" class="i method">Localize</a>()
        {
            <span class="c">//main.WindowData.TranslateMenu();</span>
            <span class="c">//     // main.WindowData.M  .DataContext as CommanderData).TranslateMenu(main.MainMenu);</span>
 
            <span class="c">//    for (int i = 1; i &lt; 11; i++)</span>
            <span class="c">//    {</span>
            <span class="c">//        main.KeybHelpButtons[i].FKey = &quot;F&quot; + i;</span>
            <span class="c">//        main.KeybHelpButtons[i].Text = Localizator.GetString(&quot;FCF&quot; + i);</span>
            <span class="c">//    }</span>
 
            <span class="c">//    var LVCols = main.LVCols;</span>
            <span class="c">//    LVCols.Clear();</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = &quot;&quot;, Tag = &quot;Icon&quot;, Width = 16, Visible = true });</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = &quot;URL&quot;, Tag = &quot;Path&quot;, Width = 0, Visible = false });</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = Localizator.GetString(&quot;FName&quot;), Tag = &quot;FName&quot;, Width = 200, Visible = true });</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = Localizator.GetString(&quot;FSize&quot;), Tag = &quot;FSize&quot;, Width = 50, Visible = true });</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = Localizator.GetString(&quot;FDate&quot;), Tag = &quot;FDate&quot;, Width = 170, // 50,</span>
            <span class="c">//        Visible = true });</span>
            <span class="c">//    LVCols.Add(new ListView2.ColumnInfo</span>
            <span class="c">//    { Title = &quot;Directory item info&quot;, Tag = &quot;DirItem&quot;, Width = 0, Visible = false });</span>
 
            <span class="c">//    main.p1.ListingView.SetColumns(LVCols);</span>
            <span class="c">//    main.p2.ListingView.SetColumns(LVCols);</span>
        }
 
        <b>public void</b> <a id="e60c390522693f1d" href="../R/e60c390522693f1d.html" target="n" data-glyph="72,1" class="i method">KeyEvent</a>(<b>object</b> <span id="r45 rd" class="r45 r">sender</span>, <span class="i n">System</span>.<span class="i n">Windows</span>.<span class="i n">Input</span>.<a href="@0@PresentationCore/A.html#0d2ce926f5cfc74b" class="t t">KeyEventArgs</a> <span id="r46 rd" class="r46 r">e</span>)
        {
            <a href="ListPanel/FileListPanelWpf.cs.html#f0412df50e284318" class="k">var</a> <span id="r47 rd" class="r47 r">ActivePanel</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#da3944c7790f3d4d" class="i property">ActivePanelWpf</a>;
            <a href="ListPanel/FileListPanelWpf.cs.html#f0412df50e284318" class="k">var</a> <span id="r48 rd" class="r48 r">PassivePanel</span> = <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../Model/MainDataContext.cs.html#5bc6595eeee2c998" class="i property">PassivePanelWpf</a>;
 
            <b>string</b> <span id="r49 rd" class="r49 r">URL1</span>;
            <b>if</b> (<span class="r47 r">ActivePanel</span>.<a href="ListPanel/FileListPanelWpf.cs.html#42632b73707ed1ac" class="i property">ListingView</a>.<a href="/pluginner/A.html#8395c5d045455d06" class="i property">SelectedRow</a> &gt; -1)
            {
                <span class="r49 r">URL1</span> = <span class="r47 r">ActivePanel</span>.<a href="ListPanel/FileListPanelWpf.cs.html#849ce3b03f514530" class="i method">GetValue</a>(<span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#16a3306713401cdc" class="i property">df</a>.<a href="/pluginner/A.html#66d073a4f05ed86b" class="i field">URL</a>);
            }
            <b>else</b>
            {
                <span class="r49 r">URL1</span> = <b>null</b>;
            }
            <span class="i n">pluginner</span>.<a href="/pluginner/A.html#a05a46d8951816c2" class="t t">IFSPlugin</a> <span id="r50 rd" class="r50 r">FS1</span> = <span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#6fa526281a55b072" class="i property">FS</a>;
 
            <span class="c">/* string URL2;
            if (PassivePanel.ListingView.SelectedRow &gt; -1)
            { URL2 = PassivePanel.GetValue(PassivePanel.df.URL); }
            else
            { URL2 = null; }
            pluginner.IFSPlugin FS2 = PassivePanel.FS;
			*/</span>
 
            <b>switch</b> (<span class="r46 r">e</span>.<a href="@0@PresentationCore/A.html#102560189e85fa41" class="i property">Key</a>)
            {
                <span class="c">// case Xwt.Key.NumPadAdd: //[+] gray - add selection</span>
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#b5bd353eeb370bb9" class="i field">OemPlus</a>:
                    <b>string</b> <span id="r51 rd" class="r51 r">Filter</span> = <span class="s">@&quot;*.*&quot;</span>;
 
                    <a href="../FileList/InputBox.cs.html#c200c0ad381ede4e" class="t t">InputBox</a> <span id="r52 rd" class="r52 r">ibx_qs</span> = <b>new</b> <a href="../FileList/InputBox.cs.html#4a6d9cec35f2990b" class="t constructor">InputBox</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;QuickSelect&quot;</span>), <span class="r51 r">Filter</span>);
                    <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#3cd7f4cb73630056" class="t t">CheckBox</a> <span id="r53 rd" class="r53 r">chkRegExp</span> = <b>new</b> <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#8efe0751c046d84e" class="t constructor">CheckBox</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NameFilterUseRegExp&quot;</span>));
                    <span class="c">//ibx_qs.OtherWidgets.Add(chkRegExp, 0, 0);</span>
                    <b>if</b> (!<span class="r52 r">ibx_qs</span>.<a href="../FileList/InputBox.cs.html#7641cf72e8aa3e00" class="i method">ShowDialog</a>())
                    {
                        <span class="r46 r">e</span>.<a href="@0@PresentationCore/A.html#f2bcc08494fea0e6" class="i property">Handled</a> = <b>false</b>;
                        <b>return</b>;
                    }
 
                    <span class="r51 r">Filter</span> = <span class="r52 r">ibx_qs</span>.<a href="../FileList/InputBox.cs.html#8ff9c06778e84a30" class="i property">Result</a>;
                    <b>if</b> (<span class="r53 r">chkRegExp</span>.<a href="/Xwt3/A.html#53b4856707620ac0" class="i property">State</a> == <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#f92ab27011f68f98" class="t t">CheckBoxState</a>.<a href="/Xwt3/A.html#abc4992f2431bfd2" class="i field">Off</a>)
                    {
                        <span class="r51 r">Filter</span> = <span class="r51 r">Filter</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;.&quot;</span>, <span class="s">@&quot;\.&quot;</span>);
                        <span class="r51 r">Filter</span> = <span class="r51 r">Filter</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;*&quot;</span>, <span class="s">&quot;.*&quot;</span>);
                        <span class="r51 r">Filter</span> = <span class="r51 r">Filter</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;?&quot;</span>, <span class="s">&quot;.&quot;</span>);
                    }
                    <b>try</b>
                    {
                        <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">RegularExpressions</span>.<a href="@0@System/A.html#bbe3b2eb80ae5526" class="t t">Regex</a> <span id="r54 rd" class="r54 r">re</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">RegularExpressions</span>.<a href="@0@System/A.html#71b5945bb883860b" class="t constructor">Regex</a>(<span class="r51 r">Filter</span>);
 
                        <b>int</b> <span id="r55 rd" class="r55 r">Count</span> = 0;
                        <span class="c">//foreach (ListView2Item lvi in ActivePanel.ListingView.Items)</span>
                        <span class="c">//{</span>
                        <span class="c">//    if (re.IsMatch(lvi.Data[1].ToString()))</span>
                        <span class="c">//    {</span>
                        <span class="c">//        ActivePanel.ListingView.Select(lvi);</span>
                        <span class="c">//        Count++;</span>
                        <span class="c">//    }</span>
                        <span class="c">//}</span>
 
                        <span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#b134897791ab8ed7" class="i property">StatusBar</a>.<a href="/pluginner/A.html#02202d16965a7253" class="i property">Text</a> = <b>string</b>.<a href="@0@mscorlib/A.html#7432dab173fae5fc" class="i method">Format</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NameFilterFound&quot;</span>), <span class="r51 r">Filter</span>, <span class="r55 r">Count</span>);
                    }
                    <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r56 rd" class="r56 r">ex</span>)
                    {
                        <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#1e0854feacd0db6d" class="t t">MessageDialog</a>.<a href="/Xwt3/A.html#fb07c548b94f2629" class="i method">ShowError</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NameFilterError&quot;</span>), <span class="r56 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                    }
 
                    <span class="r46 r">e</span>.<a href="@0@PresentationCore/A.html#f2bcc08494fea0e6" class="i property">Handled</a> = <b>true</b>;
                    <b>return</b>;
 
                <span class="c">// case Xwt.Key.NumPadSubtract: //[-] gray - add selection</span>
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#f049a36a025f97d4" class="i field">OemMinus</a>:
                    <b>string</b> <span id="r57 rd" class="r57 r">Filter_qus</span> = <span class="s">@&quot;*.*&quot;</span>;
 
                    <a href="../FileList/InputBox.cs.html#c200c0ad381ede4e" class="t t">InputBox</a> <span id="r58 rd" class="r58 r">ibx_qus</span> = <b>new</b> <a href="../FileList/InputBox.cs.html#4a6d9cec35f2990b" class="t constructor">InputBox</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;QuickUnselect&quot;</span>), <span class="r57 r">Filter_qus</span>);
                    <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#3cd7f4cb73630056" class="t t">CheckBox</a> <span id="r59 rd" class="r59 r">chkRegExp_qus</span> = <b>new</b> <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#8efe0751c046d84e" class="t constructor">CheckBox</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NameFilterUseRegExp&quot;</span>));
                    <span class="c">//ibx_qus.OtherWidgets.Add(chkRegExp_qus, 0, 0);</span>
                    <b>if</b> (!<span class="r58 r">ibx_qus</span>.<a href="../FileList/InputBox.cs.html#7641cf72e8aa3e00" class="i method">ShowDialog</a>()) <b>return</b>;
                    <span class="r57 r">Filter_qus</span> = <span class="r58 r">ibx_qus</span>.<a href="../FileList/InputBox.cs.html#8ff9c06778e84a30" class="i property">Result</a>;
                    <b>if</b> (<span class="r59 r">chkRegExp_qus</span>.<a href="/Xwt3/A.html#53b4856707620ac0" class="i property">State</a> == <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#f92ab27011f68f98" class="t t">CheckBoxState</a>.<a href="/Xwt3/A.html#abc4992f2431bfd2" class="i field">Off</a>)
                    {
                        <span class="r57 r">Filter_qus</span> = <span class="r57 r">Filter_qus</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;.&quot;</span>, <span class="s">@&quot;\.&quot;</span>);
                        <span class="r57 r">Filter_qus</span> = <span class="r57 r">Filter_qus</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;*&quot;</span>, <span class="s">&quot;.*&quot;</span>);
                        <span class="r57 r">Filter_qus</span> = <span class="r57 r">Filter_qus</span>.<a href="@0@mscorlib/A.html#69fc1d0aa6df8a90" class="i method">Replace</a>(<span class="s">&quot;?&quot;</span>, <span class="s">&quot;.&quot;</span>);
                    }
                    <b>try</b>
                    {
                        <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">RegularExpressions</span>.<a href="@0@System/A.html#bbe3b2eb80ae5526" class="t t">Regex</a> <span id="r60 rd" class="r60 r">re</span> = <b>new</b> <span class="i n">System</span>.<span class="i n">Text</span>.<span class="i n">RegularExpressions</span>.<a href="@0@System/A.html#71b5945bb883860b" class="t constructor">Regex</a>(<span class="r57 r">Filter_qus</span>);
 
                        <span class="c">//int Count_qus = 0;</span>
                        <span class="c">//foreach (ListView2Item lvi in ActivePanel.ListingView.Items)</span>
                        <span class="c">//{</span>
                        <span class="c">//    if (re.IsMatch(lvi.Data[1].ToString()))</span>
                        <span class="c">//    {</span>
                        <span class="c">//        ActivePanel.ListingView.Unselect(lvi);</span>
                        <span class="c">//        Count_qus++;</span>
                        <span class="c">//    }</span>
                        <span class="c">//}</span>
                    }
                    <b>catch</b> (<a href="@0@mscorlib/A.html#f092fb2b893a0162" class="t t">Exception</a> <span id="r61 rd" class="r61 r">ex</span>)
                    {
                        <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#1e0854feacd0db6d" class="t t">MessageDialog</a>.<a href="/Xwt3/A.html#fb07c548b94f2629" class="i method">ShowError</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NameFilterError&quot;</span>), <span class="r61 r">ex</span>.<a href="@0@mscorlib/A.html#5fba0e16215b42a3" class="i property">Message</a>);
                    }
                    <b>return</b>;
 
                <span class="c">//F KEYS</span>
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#96a8cd37f3c42a09" class="i field">F3</a>: <span class="c">//F3: View. Shift+F3: View as text.</span>
                    <b>if</b> (<span class="r49 r">URL1</span> == <b>null</b>)
                        <b>return</b>;
 
                    <b>if</b> (!<span class="r50 r">FS1</span>.<a href="/pluginner/A.html#49855afefc0d3fe4" class="i method">FileExists</a>(<span class="r49 r">URL1</span>))
                    {
                        <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#1e0854feacd0db6d" class="t t">MessageDialog</a>.<a href="/Xwt3/A.html#f9765707d4c04b4a" class="i method">ShowWarning</a>(<b>string</b>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;FileNotFound&quot;</span>), <span class="r47 r">ActivePanel</span>.<a href="ListPanel/FileListPanelWpf.cs.html#849ce3b03f514530" class="i method">GetValue</a>(<span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#16a3306713401cdc" class="i property">df</a>.<a href="/pluginner/A.html#f43d0c53b3230ed3" class="i field">DisplayName</a>)));
                        <b>return</b>;
                    }
 
                    <a href="../FileList/VEd.cs.html#c6e9e9066499e793" class="t t">VEd</a> <span id="r62 rd" class="r62 r">V</span> = <b>new</b> <a href="../FileList/VEd.cs.html#40ba556c8098f8ae" class="t constructor">VEd</a>();
                    <span class="c">//if (e.Modifiers == Xwt.ModifierKeys.None)</span>
                    <span class="c">//{</span>
                    <span class="c">//    V.LoadFile(URL1, FS1, false);</span>
                    <span class="c">//    V.Show();</span>
                    <span class="c">//}</span>
                    <span class="c">//else if (e.Modifiers == Xwt.ModifierKeys.Shift)</span>
                    <span class="c">//{</span>
                    <span class="c">//    V.LoadFile(URL1, FS1, new base_plugins.ve.PlainText(), false);</span>
                    <span class="c">//    V.Show();</span>
                    <span class="c">//}</span>
 
                    <span class="c">//   TODO: handle Ctrl+F3 (Sort by name).</span>
                    <b>return</b>;
 
                <span class="c">// case Xwt.Key.F4: //F4: Edit. Shift+F4: Edit as txt.</span>
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#69f00d74f1dd9239" class="i field">F4</a>:
 
                    <b>if</b> (<span class="r49 r">URL1</span> == <b>null</b>)
                        <b>return</b>;
 
                    <b>if</b> (!<span class="r50 r">FS1</span>.<a href="/pluginner/A.html#49855afefc0d3fe4" class="i method">FileExists</a>(<span class="r49 r">URL1</span>))
                    {
                        <span class="i n">Xwt</span>.<a href="/Xwt3/A.html#1e0854feacd0db6d" class="t t">MessageDialog</a>.<a href="/Xwt3/A.html#f9765707d4c04b4a" class="i method">ShowWarning</a>(<b>string</b>.<a href="@0@mscorlib/A.html#9d5604d4425b216f" class="i method">Format</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;FileNotFound&quot;</span>), <span class="r47 r">ActivePanel</span>.<a href="ListPanel/FileListPanelWpf.cs.html#849ce3b03f514530" class="i method">GetValue</a>(<span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#16a3306713401cdc" class="i property">df</a>.<a href="/pluginner/A.html#f43d0c53b3230ed3" class="i field">DisplayName</a>)));
                        <b>return</b>;
                    }
 
                    <a href="../FileList/VEd.cs.html#c6e9e9066499e793" class="t t">VEd</a> <span id="r63 rd" class="r63 r">E</span> = <b>new</b> <a href="../FileList/VEd.cs.html#40ba556c8098f8ae" class="t constructor">VEd</a>();
                    <span class="c">//if (e.Modifiers == Xwt.ModifierKeys.None)</span>
                    <span class="c">//{ E.LoadFile(URL1, FS1, true); E.Show(); }</span>
                    <span class="c">//else if (e.Modifiers == Xwt.ModifierKeys.Shift)</span>
                    <span class="c">//{ E.LoadFile(URL1, FS1, new base_plugins.ve.PlainText(), true); E.Show(); }</span>
                    <span class="c">//todo: handle Ctrl+F4 (Sort by extension).</span>
 
                    <span class="r46 r">e</span>.<a href="@0@PresentationCore/A.html#f2bcc08494fea0e6" class="i property">Handled</a> = <b>true</b>;
                    <b>return</b>;
 
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#9459670f1ea00920" class="i field">F5</a>: <span class="c">//F5: Copy.</span>
                    <b>if</b> (<span class="r49 r">URL1</span> == <b>null</b>)
                        <b>return</b>;
                    <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../FileList/Actions/MainWindow-Actions.cs.html#9d60d1f65f98ce91" class="i method">Cp</a>();
 
                    <span class="c">//todo: handle Ctrl+F5 (Sort by timestamp).</span>
                    <b>return</b>;
 
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#89e3df23149474bd" class="i field">F6</a>: <span class="c">//F6: Move/Rename.</span>
                    <b>if</b> (<span class="r49 r">URL1</span> == <b>null</b>)
                        <b>return</b>;
                    <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../FileList/Actions/MainWindow-Actions.cs.html#f34902de589ca99e" class="i method">Mv</a>();
                    <span class="c">//todo: handle Ctrl+F6 (Sort by size).</span>
                    <b>return</b>;
 
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#eaf0a8d6d0ebbdac" class="i field">F7</a>: <span class="c">//F7: New directory.</span>
 
                    <a href="../FileList/InputBox.cs.html#c200c0ad381ede4e" class="t t">InputBox</a> <span id="r64 rd" class="r64 r">ibx</span> = <b>new</b> <a href="../FileList/InputBox.cs.html#4a6d9cec35f2990b" class="t constructor">InputBox</a>(<a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NewDirURL&quot;</span>), <span class="r47 r">ActivePanel</span>.<a href="../FileList/Panel/FileListPanel.cs.html#6fa526281a55b072" class="i property">FS</a>.<a href="/pluginner/A.html#53050e9ff0b5dd2d" class="i property">CurrentDirectory</a> + <a href="../FileList/Localizator.cs.html#0b0c6268a53237f4" class="t t">Localizator</a>.<a href="../FileList/Localizator.cs.html#546af5a79d2e88a9" class="i method">GetString</a>(<span class="s">&quot;NewDirTemplate&quot;</span>));
                    <b>if</b> (<span class="r64 r">ibx</span>.<a href="../FileList/InputBox.cs.html#7641cf72e8aa3e00" class="i method">ShowDialog</a>())
                        <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../FileList/Actions/MainWindow-Actions.cs.html#69beeb575a2171c9" class="i method">MkDir</a>(<span class="r64 r">ibx</span>.<a href="../FileList/InputBox.cs.html#8ff9c06778e84a30" class="i property">Result</a>);
                    <b>return</b>;
 
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#7899866f84ee9300" class="i field">F8</a>: <span class="c">//F8: delete</span>
                    <b>if</b> (<span class="r49 r">URL1</span> == <b>null</b>)
                        <b>return</b>;
                    <a href="#c66623554cab66dc" class="i field">main</a>.<a href="../FileList/Actions/MainWindow-Actions.cs.html#eb989c95d5bf7ca0" class="i method">Rm</a>();
                    <span class="c">//todo: move to trash can/recycle bin &amp; handle Shit+F8 (remove completely)</span>
                    <b>return</b>;
 
                <b>case</b> <a href="@0@WindowsBase/A.html#8e0d9266dee78287" class="t t">Key</a>.<a href="@0@WindowsBase/A.html#1056daf8bdb6b1ea" class="i field">F10</a>: <span class="c">//F10: Exit</span>
                              <span class="c">//todo: ask user, are it really want to close FC?</span>
                              <span class="c">// Xwt.Application.Exit();</span>
                    <span class="i n">System</span>.<span class="i n">Windows</span>.<a href="@0@PresentationFramework/A.html#cf9c51e402f97b05" class="t t">Application</a>.<a href="@0@PresentationFramework/A.html#e6ee08846cb73154" class="i property">Current</a>.<a href="@0@PresentationFramework/A.html#323f71efbcb142b9" class="i method">Shutdown</a>();
                    <span class="c">//todo: handle Alt+F10 (directory tree)</span>
                    <b>return</b>;
            }
        }
 
    }
}
</pre></td></tr></table></div></body></html>
